import{u as ke,_ as Ae,N as dt,s as it,A as ut,k as rt,B as pt}from"./index.fbcd5073.js";/* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              */import{d as $e,e as f,B as a,C as _,aH as e,aG as t,u as C,aD as c,aM as d,aL as b,bA as mt,bB as ct,bC as _t,bD as Ue,bE as bt,r as ye,c as te,w as he,aZ as le,aJ as Y,aI as ee,aE as ge,bH as Ne,bI as xe,b2 as Pe,bG as Be,b1 as qe,bK as Te,b5 as Re,bL as Ee,ab as Fe,aU as He,bi as je,bP as vt,bQ as ft,bU as gt,b7 as yt,bN as Oe,bT as Ge,D as R,E as ht,n as kt,a_ as De,aK as $t,aF as wt,bj as Ct,bk as Vt,bl as It,b4 as St,bM as Lt,aT as zt,aV as Mt}from"./arco.3f46b4ae.js";import{u as we}from"./loading.37fd256d.js";import{a as Dt,t as At,b as Ut,s as Nt,c as xt}from"./model_agent.c4c6d033.js";import{c as ae,S as Pt}from"./sortable.esm.078712c4.js";import{q as Je}from"./provider.cd8b0c17.js";import{b as Bt,q as qt}from"./model.11ce009b.js";import{M as Tt}from"./models.23c99444.js";/* empty css                *//* empty css                *//* empty css              */import{f as Rt,u as Et}from"./vue.dbcf9bc3.js";import"./chart.2cea905d.js";const Ft={style:{margin:"10px 0 30px 10px"}},Ht={key:1},jt={key:1},Ot={key:1},Gt={key:1},Jt={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},Kt={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},Qt={key:1},Zt={key:1},Wt={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},Xt={key:1},Yt={key:1},el={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},tl={key:1},ll={key:1},al={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},ol={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},nl={key:1},sl={key:1},dl={name:"ModelAgentDetail"},il=$e({...dl,props:{id:{type:String,default:""}},setup(oe){const P=oe;ke();const{loading:y,setLoading:r}=we(!0),u=f({});return(async(v={id:P.id})=>{r(!0);try{const{data:k}=await Dt(v);u.value=k}catch{}finally{r(!1)}})(),(v,k)=>{const p=mt,m=ct,h=_t,L=Ue,A=bt;return a(),_("div",Ft,[e(A,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:t(()=>[e(h,{label:v.$t("common.provider")},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Ht,d(u.value.provider_name),1))]),_:1},8,["label"]),e(h,{label:v.$t("model.agent.label.name")},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",jt,d(u.value.name),1))]),_:1},8,["label"]),e(h,{label:v.$t("model.agent.label.base_url"),span:2},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Ot,d(u.value.base_url),1))]),_:1},8,["label"]),e(h,{label:v.$t("model.agent.label.path"),span:2},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Gt,d(u.value.path||"-"),1))]),_:1},8,["label"]),e(h,{label:v.$t("common.bind_group"),span:2},{default:t(()=>{var $,I;return[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Jt,d(((I=($=u.value)==null?void 0:$.group_names)==null?void 0:I.join(`
`))||"-"),1))]}),_:1},8,["label"]),e(h,{label:v.$t("common.bind_models"),span:2},{default:t(()=>{var $,I;return[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Kt,d(((I=($=u.value)==null?void 0:$.model_names)==null?void 0:I.join(`
`))||"-"),1))]}),_:1},8,["label"]),e(h,{label:v.$t("common.billing_methods"),span:2},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Qt,d(v.$t(`dict.billing_methods.${u.value.billing_methods||1}`)),1))]),_:1},8,["label"]),e(h,{label:v.$t("common.weight")},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Zt,d(u.value.weight||0),1))]),_:1},8,["label"]),e(h,{label:v.$t("model.agent.detail.fallback_models")},{default:t(()=>{var $,I;return[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Wt,d(((I=($=u.value)==null?void 0:$.fallback_model_names)==null?void 0:I.join(`
`))||"-"),1))]}),_:1},8,["label"]),e(h,{label:v.$t("model.agent.label.is_never_disable")},{default:t(()=>{var $;return[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Xt,d(v.$t(`dict.${(($=u.value)==null?void 0:$.is_never_disable)||!1}`)),1))]}),_:1},8,["label"]),e(h,{label:v.$t("model.agent.label.lb_strategy")},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",Yt,d(v.$t(`dict.lb_strategy.${u.value.lb_strategy||1}`)),1))]),_:1},8,["label"]),e(h,{label:v.$t("common.key"),span:2},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",el,d(u.value.key||"-"),1))]),_:1},8,["label"]),e(h,{label:v.$t("key.detail.is_auto_disabled")},{default:t(()=>{var $;return[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",tl,d(v.$t(`dict.${(($=u.value)==null?void 0:$.is_auto_disabled)||!1}`)),1))]}),_:1},8,["label"]),e(h,{label:v.$t("common.status")},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",ll,[u.value.status===1?(a(),c(L,{key:0,color:"green"},{default:t(()=>[b(d(v.$t(`dict.status.${u.value.status}`)),1)]),_:1})):(a(),c(L,{key:1,color:"red"},{default:t(()=>[b(d(v.$t(`dict.status.${u.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),e(h,{label:v.$t("key.detail.auto_disabled_reason"),span:2},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",al,d(u.value.auto_disabled_reason||"-"),1))]),_:1},8,["label"]),e(h,{label:v.$t("common.remark"),span:2},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",ol,d(u.value.remark||"-"),1))]),_:1},8,["label"]),e(h,{label:v.$t("common.created_at")},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",nl,d(u.value.created_at),1))]),_:1},8,["label"]),e(h,{label:v.$t("common.updated_at")},{default:t(()=>[C(y)?(a(),c(m,{key:0,animation:!0},{default:t(()=>[e(p,{rows:1})]),_:1})):(a(),_("span",sl,d(u.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}}),ul={class:"container"},rl=["title","onClick"],pl={key:0},ml={key:1},cl={key:2},_l={key:3},bl={name:"Tests"},vl=$e({...bl,props:{id:{type:String,default:""},action:{type:String,default:""}},setup(oe){const P=oe,{loading:y,setLoading:r}=we(!0),{t:u}=ke(),J=Rt(),v=ye({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),k=()=>({provider_id:"",name:"",model:"",type:f(),status:f()}),p=f([]),m=f(k()),h=f([]),L=f([]),A=f("medium"),$=f([]),I=f(!0),B=f(!0),ne=f(),se=f(),V=f({model_agent_id:P.id,test_method:1}),j=te(()=>[{title:u("common.provider"),dataIndex:"provider_name",slotName:"provider_name",align:"center"},{title:u("common.model_name"),dataIndex:"name",slotName:"name",align:"center",ellipsis:!0,tooltip:!0},{title:u("common.model"),dataIndex:"model",slotName:"model",align:"center",ellipsis:!0,tooltip:!0},{title:u("common.model_type"),dataIndex:"type",slotName:"type",align:"center",ellipsis:!0,tooltip:!0},{title:u("model.agent.columns.result_total_time"),dataIndex:"result_total_time",slotName:"result_total_time",align:"center"},{title:u("common.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:120}]),E=te(()=>[{label:u("dict.model_type.1"),value:1},{label:u("dict.model_type.2"),value:2},{label:u("dict.model_type.3"),value:3},{label:u("dict.model_type.4"),value:4},{label:u("dict.model_type.5"),value:5},{label:u("dict.model_type.6"),value:6},{label:u("dict.model_type.7"),value:7},{label:u("dict.model_type.8"),value:8},{label:u("dict.model_type.100"),value:100},{label:u("dict.model_type.101"),value:101},{label:u("dict.model_type.102"),value:102},{label:u("dict.model_type.103"),value:103},{label:u("dict.model_type.10000"),value:1e4}]),de=async(o={id:P.id,action:P.action})=>{r(!0);try{const{data:g}=await Bt(o);p.value=g.items,g.items.length>0?B.value=!1:B.value=!0}catch{}finally{r(!1),ne.value.selectAll(!1)}};de();const me=()=>{de({id:P.id,action:P.action,...m.value})};he(()=>j.value,o=>{h.value=ae(o),h.value.forEach((g,x)=>{g.checked=!0}),L.value=ae(h.value)},{deep:!0,immediate:!0});const ie=f([]);(async()=>{r(!0);try{const{data:o}=await Je();ie.value=o.items}catch{}finally{r(!1)}})();const K=async o=>{var x;if(!await((x=se.value)==null?void 0:x.validate())){o.testing=!0,o.trace_id="",V.value.model_id=o.id;const q=Date.now();try{const{data:w}=await At(V.value);o.trace_id=w.trace_id,o.result=w.result,o.total_time=w.total_time,o.error=w.error,w.error&&le.error({content:w.error,duration:5*1e3})}catch(w){o.result=!1,o.total_time=Date.now()-q,o.error=w}finally{o.testing=!1}}},ue=o=>{const g=new Map([[2,"LogImageList"],[5,"LogAudioList"],[6,"LogAudioList"],[8,"LogVideoList"],[1e4,"LogGeneralList"]]);return J.resolve({name:g.get(o.type)||"LogTextList",query:{trace_id:o.trace_id}}).href},ce=o=>{$.value=o,I.value=!o.length},re=()=>{if($.value.length>0)for(let o=0;o<$.value.length;o+=1)for(let g=0;g<p.value.length;g+=1)$.value[o]===p.value[g].id&&K(p.value[g]);else for(let o=0;o<p.value.length;o+=1)K(p.value[o])},{copy:Ve,copied:Q}=Et(),Ie=async o=>{o&&Ve(o)};return he(Q,()=>{Q.value&&le.success(u("success.copy"))}),(o,g)=>{const x=Ne,q=xe,w=Pe,z=Be,O=qe,F=Te,G=Re,H=Ee,_e=Fe,Z=He,l=je,i=vt,M=ft,U=gt,S=Ue,pe=yt,W=Oe,T=Ge;return a(),_("div",ul,[e(T,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"0px"}},{default:t(()=>[e(F,null,{default:t(()=>[e(z,{flex:1},{default:t(()=>[e(G,{model:m.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:t(()=>[e(F,{gutter:16},{default:t(()=>[e(z,{span:6},{default:t(()=>[e(w,{field:"provider_id",label:o.$t("common.provider"),"label-col-props":{span:6}},{default:t(()=>[e(q,{modelValue:m.value.provider_id,"onUpdate:modelValue":g[0]||(g[0]=s=>m.value.provider_id=s),placeholder:o.$t("common.all"),scrollbar:!1,"allow-search":"","allow-clear":""},{default:t(()=>[(a(!0),_(Y,null,ee(ie.value,s=>(a(),c(x,{key:s.id,value:s.id,label:s.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(z,{span:6},{default:t(()=>[e(w,{field:"name",label:o.$t("model.agent.label.model_name"),"label-col-props":{span:4},"wrapper-col-props":{span:20}},{default:t(()=>[e(O,{modelValue:m.value.name,"onUpdate:modelValue":g[1]||(g[1]=s=>m.value.name=s),placeholder:o.$t("model.form.placeholder.name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(z,{span:6},{default:t(()=>[e(w,{field:"model",label:o.$t("common.model"),"label-col-props":{span:4},"wrapper-col-props":{span:20}},{default:t(()=>[e(O,{modelValue:m.value.model,"onUpdate:modelValue":g[2]||(g[2]=s=>m.value.model=s),placeholder:o.$t("model.form.placeholder.model"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(z,{span:6},{default:t(()=>[e(w,{field:"type",label:o.$t("common.type"),"label-col-props":{span:4},"wrapper-col-props":{span:20}},{default:t(()=>[e(q,{modelValue:m.value.type,"onUpdate:modelValue":g[3]||(g[3]=s=>m.value.type=s),placeholder:o.$t("common.all"),options:C(E),scrollbar:!1,"allow-search":"","allow-clear":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(H,{style:{height:"32px"},direction:"vertical"}),e(z,{flex:"86px",style:{"text-align":"right"}},{default:t(()=>[e(l,{direction:"vertical",size:18},{default:t(()=>[e(Z,{type:"primary",onClick:me},{icon:t(()=>[e(_e)]),default:t(()=>[b(" "+d(o.$t("button.search")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(H,{style:{"margin-top":"0"}}),e(G,{ref_key:"testModelFormRef",ref:se,model:V.value,"label-col-props":{span:4},"wrapper-col-props":{span:18},"label-align":"left"},{default:t(()=>[e(F,{gutter:16},{default:t(()=>[e(z,{span:8},{default:t(()=>[e(w,{field:"test_method",label:o.$t("model.agent.label.test_models.test_method"),"label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[e(M,{modelValue:V.value.test_method,"onUpdate:modelValue":g[4]||(g[4]=s=>V.value.test_method=s)},{default:t(()=>[e(i,{value:1},{default:t(()=>[b(d(o.$t("model.agent.dict.test_method.1")),1)]),_:1}),e(i,{value:2},{default:t(()=>[b(d(o.$t("model.agent.dict.test_method.2")),1)]),_:1}),e(i,{value:3},{default:t(()=>[b(d(o.$t("model.agent.dict.test_method.3")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),V.value.test_method===3?(a(),c(z,{key:0,span:7},{default:t(()=>[e(w,{field:"base_url",label:o.$t("model.agent.label.test_models.base_url"),rules:[{required:!0,message:o.$t("model.agent.error.required.test_models.base_url")}],"label-col-props":{span:8},"wrapper-col-props":{span:16}},{default:t(()=>[e(O,{modelValue:V.value.base_url,"onUpdate:modelValue":g[5]||(g[5]=s=>V.value.base_url=s),placeholder:o.$t("model.agent.placeholder.test_models.base_url")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])]),_:1})):ge("",!0),V.value.test_method!==2?(a(),c(z,{key:1,span:V.value.test_method===1?14:7},{default:t(()=>[e(w,{field:"key",label:o.$t("model.agent.label.test_models.key"),rules:[{required:!0,message:o.$t("model.agent.placeholder.test_models.key")}],"label-col-props":{span:V.value.test_method!==3?3:7},"wrapper-col-props":{span:V.value.test_method!==3?21:17}},{default:t(()=>[e(O,{modelValue:V.value.key,"onUpdate:modelValue":g[6]||(g[6]=s=>V.value.key=s),placeholder:o.$t("model.agent.placeholder.test_models.key")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules","label-col-props","wrapper-col-props"])]),_:1},8,["span"])):ge("",!0),e(z,{span:V.value.test_method!==2?2:16,style:{"text-align":"right"}},{default:t(()=>[e(Z,{type:"primary",disabled:B.value,onClick:re},{default:t(()=>[b(d(o.$t("button.batch.test")),1)]),_:1},8,["disabled"])]),_:1},8,["span"])]),_:1})]),_:1},8,["model"]),e(W,{ref_key:"tableRef",ref:ne,"row-key":"id",loading:C(y),pagination:!1,columns:h.value,data:p.value,bordered:!1,size:A.value,scroll:{y:"480px"},scrollbar:!1,"row-selection":v,onSelectionChange:ce},{type:t(({record:s})=>[b(d(o.$t(`dict.model_type.${s.type}`)),1)]),result_total_time:t(({record:s})=>[s.testing?(a(),c(U,{key:0})):(a(),_("span",{key:1,title:s.error,onClick:X=>Ie(s.error)},[s.result!=null?(a(),_("span",pl,[s.result?(a(),c(S,{key:0,color:"green"},{default:t(()=>[b(d(o.$t(`dict.success.${s.result}`)),1)]),_:2},1024)):(a(),c(S,{key:1,color:"red"},{default:t(()=>[b(d(o.$t(`dict.success.${s.result}`)),1)]),_:2},1024))])):(a(),_("span",ml," - ")),b(" / "),s.total_time?(a(),_("span",cl,[s.total_time>12e4?(a(),c(S,{key:0,color:"red"},{default:t(()=>[b(d(s.total_time),1)]),_:2},1024)):s.total_time>9e4?(a(),c(S,{key:1,color:"orange"},{default:t(()=>[b(d(s.total_time),1)]),_:2},1024)):s.total_time>6e4?(a(),c(S,{key:2,color:"gold"},{default:t(()=>[b(d(s.total_time),1)]),_:2},1024)):(a(),c(S,{key:3,color:"green"},{default:t(()=>[b(d(s.total_time||"-"),1)]),_:2},1024))])):(a(),_("span",_l," - "))],8,rl))]),operations:t(({record:s})=>[e(Z,{type:"text",size:"small",disabled:s.testing,onClick:X=>K(s)},{default:t(()=>[b(d(o.$t("button.test")),1)]),_:2},1032,["disabled","onClick"]),V.value.test_method!==2?(a(),c(pe,{key:0,href:ue(s),disabled:!s.trace_id||s.trace_id==="",target:"_blank"},{default:t(()=>[b(d(o.$t("button.detail")),1)]),_:2},1032,["href","disabled"])):ge("",!0)]),_:1},8,["loading","columns","data","size","row-selection"])]),_:1})])}}});const fl=Ae(vl,[["__scopeId","data-v-f58e3e43"]]),gl={class:"container"},yl={class:"action-icon"},hl={class:"action-icon"},kl={id:"tableSetting"},$l={style:{"margin-right":"4px",cursor:"move"}},wl={class:"title"},Cl={key:0},Vl={key:1},Il={name:"ModelAgentList"},Sl=$e({...Il,setup(oe){const{loading:P,setLoading:y}=we(!0),{t:r}=ke(),u=ye({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),J=()=>({provider_id:"",name:"",base_url:"",models:[],status:f(),remark:""}),v=f([]),k=f(J()),p=f([]),m=f([]),h=f("medium"),L=f([]),A=f(!0),$=f(),I={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},B=ye({...I}),ne=te(()=>[{name:r("size.mini"),value:"mini"},{name:r("size.small"),value:"small"},{name:r("size.medium"),value:"medium"},{name:r("size.large"),value:"large"}]),se=te(()=>[{title:r("common.provider"),dataIndex:"provider_name",slotName:"provider_name",align:"center",width:120},{title:r("model.agent.label.name"),dataIndex:"name",slotName:"name",align:"center",ellipsis:!0,tooltip:!0},{title:r("common.bind_group"),dataIndex:"group_names",slotName:"group_names",align:"center",ellipsis:!0,tooltip:!0},{title:r("common.bind_models"),dataIndex:"model_names",slotName:"model_names",align:"center",ellipsis:!0,tooltip:!0},{title:r("common.weight"),dataIndex:"weight",slotName:"weight",align:"center"},{title:r("common.lb_strategy"),dataIndex:"lb_strategy",slotName:"lb_strategy",align:"center"},{title:r("common.remark"),dataIndex:"remark",slotName:"remark",align:"center",ellipsis:!0,tooltip:!0},{title:r("common.status"),dataIndex:"status",slotName:"status",align:"center",width:65},{title:r("common.updated_at"),dataIndex:"updated_at",slotName:"updated_at",align:"center",width:132},{title:r("common.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:200}]),V=te(()=>[{label:r("dict.status.1"),value:1},{label:r("dict.status.2"),value:2}]),j=async(l={...I})=>{y(!0);try{const{data:i}=await Ut(l);v.value=i.items,B.current=l.current,B.pageSize=l.pageSize,B.total=i.paging.total}catch{}finally{y(!1),$.value.selectAll(!1)}};j();const E=()=>{j({...I,...k.value})},de=l=>{j({...I,...k.value,current:l})},me=l=>{I.pageSize=l,j({...I,...k.value})},ie=()=>{k.value=J(),E()},Ce=(l,i)=>{h.value=l},K=(l,i,M)=>{l?p.value.splice(M,0,i):p.value=m.value.filter(U=>U.dataIndex!==i.dataIndex)},ue=(l,i,M,U=!1)=>{const S=U?ae(l):l;return i>-1&&M>-1&&S.splice(i,1,S.splice(M,1,S[i]).pop()),S},ce=l=>{l&&kt(()=>{const i=document.getElementById("tableSetting");new Pt(i,{onEnd(M){const{oldIndex:U,newIndex:S}=M;ue(p.value,U,S),ue(m.value,U,S)}})})};he(()=>se.value,l=>{p.value=ae(l),p.value.forEach((i,M)=>{i.checked=!0}),m.value=ae(p.value)},{deep:!0,immediate:!0});const re=f([]);(async()=>{try{const{data:l}=await Je();re.value=l.items}catch{}})();const Q=f([]);(async()=>{try{const{data:l}=await qt();Q.value=l.items}catch{}})();const o=async l=>{y(!0);try{await Nt(l),le.success(r("success.operate")),E()}catch{}finally{y(!1)}},g=l=>{L.value=l,A.value=!l.length},x=l=>{if(L.value.length===0)le.info(r("placeholder.operation.data"));else{let i=r("placeholder.batch.operation",{count:L.value.length});switch(l.action){case"status":l.value===1?i=r("placeholder.batch.operation.enable",{count:L.value.length}):i=r("placeholder.batch.operation.disable",{count:L.value.length});break;case"delete":i=r("placeholder.batch.operation.delete",{count:L.value.length});break}De.warning({title:r("modal.warning.title"),titleAlign:"center",content:i,okText:r("button.ok"),cancelText:r("button.cancel"),hideCancel:!1,onOk:()=>{y(!0),l.ids=L.value,xt(l).then(M=>{y(!1),le.success(r("success.operate")),E(),$.value.selectAll(!1)})}})}},q=f(!1),w=f(),z=l=>{q.value=!0,w.value=l},O=()=>{q.value=!1},F=f(!1),G=f(!1),H=f(),_e=l=>{F.value=!0,w.value=l,H.value="agent"},Z=l=>{G.value=!0,w.value=l,H.value="agent"};return(l,i)=>{const M=dt,U=$t,S=wt,pe=Ne,W=xe,T=Pe,s=Be,X=qe,be=Te,Ke=Re,Se=Ee,Qe=Fe,N=He,Le=it,ze=je,ve=Ct,Ze=ut,We=Vt,Xe=It,Ye=rt,et=pt,tt=St,lt=Lt,at=zt,ot=Oe,nt=Mt,Me=De,st=Ge;return a(),_("div",gl,[e(S,{class:"container-breadcrumb"},{default:t(()=>[e(U,null,{default:t(()=>[e(M)]),_:1}),e(U,null,{default:t(()=>[b(d(l.$t("model.agent.menu")),1)]),_:1})]),_:1}),e(st,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:t(()=>[e(be,null,{default:t(()=>[e(s,{flex:1},{default:t(()=>[e(Ke,{model:k.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:t(()=>[e(be,{gutter:16},{default:t(()=>[e(s,{span:8},{default:t(()=>[e(T,{field:"provider_id",label:l.$t("common.provider")},{default:t(()=>[e(W,{modelValue:k.value.provider_id,"onUpdate:modelValue":i[0]||(i[0]=n=>k.value.provider_id=n),placeholder:l.$t("common.all"),scrollbar:!1,"allow-search":"","allow-clear":""},{default:t(()=>[(a(!0),_(Y,null,ee(re.value,n=>(a(),c(pe,{key:n.id,value:n.id,label:n.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(s,{span:8},{default:t(()=>[e(T,{field:"name",label:l.$t("model.agent.label.name")},{default:t(()=>[e(X,{modelValue:k.value.name,"onUpdate:modelValue":i[1]||(i[1]=n=>k.value.name=n),placeholder:l.$t("model.agent.placeholder.name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(s,{span:8},{default:t(()=>[e(T,{field:"base_url",label:l.$t("model.agent.label.base_url")},{default:t(()=>[e(X,{modelValue:k.value.base_url,"onUpdate:modelValue":i[2]||(i[2]=n=>k.value.base_url=n),placeholder:l.$t("model.agent.error.required.base_url"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(s,{span:8},{default:t(()=>[e(T,{field:"models",label:l.$t("common.bind_models")},{default:t(()=>[e(W,{modelValue:k.value.models,"onUpdate:modelValue":i[3]||(i[3]=n=>k.value.models=n),placeholder:l.$t("common.all"),"max-tag-count":2,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:t(()=>[(a(!0),_(Y,null,ee(Q.value,n=>(a(),c(pe,{key:n.id,value:n.id,label:n.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(s,{span:8},{default:t(()=>[e(T,{field:"status",label:l.$t("common.status")},{default:t(()=>[e(W,{modelValue:k.value.status,"onUpdate:modelValue":i[4]||(i[4]=n=>k.value.status=n),placeholder:l.$t("common.all"),options:C(V),scrollbar:!1,"allow-clear":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"])]),_:1}),e(s,{span:8},{default:t(()=>[e(T,{field:"remark",label:l.$t("common.remark")},{default:t(()=>[e(X,{modelValue:k.value.remark,"onUpdate:modelValue":i[5]||(i[5]=n=>k.value.remark=n),placeholder:l.$t("placeholder.remark"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Se,{style:{height:"84px"},direction:"vertical"}),e(s,{flex:"86px",style:{"text-align":"right"}},{default:t(()=>[e(ze,{direction:"vertical",size:18},{default:t(()=>[e(N,{type:"primary",onClick:E},{icon:t(()=>[e(Qe)]),default:t(()=>[b(" "+d(l.$t("button.search")),1)]),_:1}),e(N,{onClick:ie},{icon:t(()=>[e(Le)]),default:t(()=>[b(" "+d(l.$t("button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(Se,{style:{"margin-top":"0","margin-bottom":"16px"}}),e(be,{style:{"margin-bottom":"16px"}},{default:t(()=>[e(s,{span:12},{default:t(()=>[e(ze,null,{default:t(()=>[e(N,{type:"primary",onClick:i[6]||(i[6]=n=>l.$router.push({name:"ModelAgentCreate"}))},{default:t(()=>[b(d(l.$t("button.create")),1)]),_:1}),e(N,{type:"primary",status:"success",disabled:A.value,title:A.value?l.$t("placeholder.operation.data"):"",onClick:i[7]||(i[7]=n=>x({action:"status",value:1}))},{default:t(()=>[b(d(l.$t("button.enable")),1)]),_:1},8,["disabled","title"]),e(N,{type:"primary",status:"danger",disabled:A.value,title:A.value?l.$t("placeholder.operation.data"):"",onClick:i[8]||(i[8]=n=>x({action:"status",value:2}))},{default:t(()=>[b(d(l.$t("button.disable")),1)]),_:1},8,["disabled","title"]),e(N,{type:"primary",status:"danger",disabled:A.value,title:A.value?l.$t("placeholder.operation.data"):"",onClick:i[9]||(i[9]=n=>x({action:"delete"}))},{default:t(()=>[b(d(l.$t("button.delete")),1)]),_:1},8,["disabled","title"])]),_:1})]),_:1}),e(s,{span:12,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:t(()=>[e(ve,{content:l.$t("action.refresh")},{default:t(()=>[R("div",{class:"action-icon",onClick:E},[e(Le,{size:"18"})])]),_:1},8,["content"]),e(Xe,{onSelect:Ce},{content:t(()=>[(a(!0),_(Y,null,ee(C(ne),n=>(a(),c(We,{key:n.value,value:n.value,class:ht({active:n.value===h.value})},{default:t(()=>[R("span",null,d(n.name),1)]),_:2},1032,["value","class"]))),128))]),default:t(()=>[e(ve,{content:l.$t("action.density")},{default:t(()=>[R("div",yl,[e(Ze,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(ve,{content:l.$t("action.column_setting")},{default:t(()=>[e(lt,{trigger:"click",position:"bl",onPopupVisibleChange:ce},{content:t(()=>[R("div",kl,[(a(!0),_(Y,null,ee(m.value,(n,D)=>(a(),_("div",{key:n.dataIndex,class:"setting"},[R("div",$l,[e(et)]),R("div",null,[e(tt,{modelValue:n.checked,"onUpdate:modelValue":fe=>n.checked=fe,onChange:fe=>K(fe,n,D)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),R("div",wl,d(n.title),1)]))),128))])]),default:t(()=>[R("div",hl,[e(Ye,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(ot,{ref_key:"tableRef",ref:$,"row-key":"id",loading:C(P),pagination:B,columns:p.value,data:v.value,bordered:!1,size:h.value,"row-selection":u,onPageChange:de,onPageSizeChange:me,onSelectionChange:g},{group_names:t(({record:n})=>{var D;return[b(d(((D=n==null?void 0:n.group_names)==null?void 0:D.join(","))||"-"),1)]}),model_names:t(({record:n})=>[n.model_names?(a(),_("span",Cl,[e(N,{type:"text",size:"small",onClick:D=>_e(n.id)},{default:t(()=>[b(d(l.$t("button.view")),1)]),_:2},1032,["onClick"])])):(a(),_("span",Vl,d("-")))]),weight:t(({record:n})=>[b(d(n.weight||0),1)]),lb_strategy:t(({record:n})=>[b(d(l.$t(`dict.lb_strategy.${n.lb_strategy||1}`)),1)]),remark:t(({record:n})=>[b(d(n.remark||"-"),1)]),status:t(({record:n})=>[e(at,{modelValue:n.status,"onUpdate:modelValue":D=>n.status=D,"checked-value":1,"unchecked-value":2,onChange:D=>o({id:n.id,status:n.status})},null,8,["modelValue","onUpdate:modelValue","onChange"])]),operations:t(({record:n})=>[e(N,{type:"text",size:"small",onClick:D=>z(n.id)},{default:t(()=>[b(d(l.$t("button.detail")),1)]),_:2},1032,["onClick"]),e(N,{type:"text",size:"small",onClick:D=>l.$router.push({name:"ModelAgentUpdate",query:{id:n.id}})},{default:t(()=>[b(d(l.$t("button.update")),1)]),_:2},1032,["onClick"]),e(N,{type:"text",size:"small",onClick:D=>l.$router.push({name:"ModelKeyList",query:{agent_id:n.id}})},{default:t(()=>[b(d(l.$t("button.key")),1)]),_:2},1032,["onClick"]),e(N,{type:"text",size:"small",onClick:D=>Z(n.id)},{default:t(()=>[b(d(l.$t("button.test")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),e(nt,{title:l.$t("model.agent.menu.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:q.value,onCancel:O},{default:t(()=>[e(il,{id:w.value},null,8,["id"])]),_:1},8,["title","visible"]),e(Me,{visible:F.value,"onUpdate:visible":i[10]||(i[10]=n=>F.value=n),title:l.$t("common.bind_models"),"modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"1080px","ok-text":l.$t("button.close")},{default:t(()=>[e(Tt,{id:w.value,action:H.value},null,8,["id","action"])]),_:1},8,["visible","title","ok-text"]),e(Me,{visible:G.value,"onUpdate:visible":i[11]||(i[11]=n=>G.value=n),title:l.$t("model.agent.title.test_models"),"modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"1288px","ok-text":l.$t("button.close"),footer:!1,"hide-title":""},{default:t(()=>[e(fl,{id:w.value,action:H.value},null,8,["id","action"])]),_:1},8,["visible","title","ok-text"])]),_:1})])}}});const Yl=Ae(Sl,[["__scopeId","data-v-b5dbc52d"]]);export{Yl as default};
