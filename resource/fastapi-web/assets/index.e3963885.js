import{N as J,_ as K}from"./index.15d033c0.js";/* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import{d as Q,e as m,B as i,C as g,aH as o,aG as r,aL as u,aM as s,u as R,D as T,aJ as k,aI as w,aD as f,aE as V,aK as j,aF as A,bF as P,bG as W,b2 as X,b1 as Y,bQ as Z,bi as x,bO as ee,aU as le,b5 as ae,bN as te,bR as oe,g as re}from"./arco.cbac690a.js";import{f as ue,h as se}from"./vue.4014b72a.js";import{u as ne}from"./loading.b56ef223.js";import{q as ie,c as de,d as ce}from"./notice.2d7e2fdf.js";import{q as pe}from"./notice_template.43576ff2.js";import{q as me}from"./admin_user.85a5d002.js";import{q as fe}from"./admin_reseller.4edfb3a4.js";import{V as ve}from"./vditor.e5c4ec65.js";import"./chart.e521dee8.js";/* empty css                */const ye={class:"container"},be={class:"wrapper"},_e={class:"submit-btn"},ge={name:"NoticeUpdate"},Ve=Q({...ge,setup($e){const{proxy:N}=re(),{loading:I,setLoading:d}=ne(!1),U=ue(),$=se(),C=m(),l=m({id:"",title:"",content:"",category:"",scope:m(),users:[],resellers:[],channels:[],is_popup:!1,priority:m(),expires_at:"",scheduled_time:"",remark:"",status:1}),y=m([]),F=new Map;(async()=>{d(!0);try{const{data:e}=await pe({scenes:["notice"]});y.value=e.items;for(let a=0;a<y.value.length;a+=1)F.set(y.value[a].id,y.value[a])}catch{}finally{d(!1)}})();const S=()=>{const e=F.get(l.value.template);e&&(l.value.title=e.title,l.value.content=e.content,l.value.channels=e.channels)},L=m([]);(async()=>{d(!0);try{const{data:e}=await me();L.value=e.items}catch{}finally{d(!1)}})();const D=m([]);(async()=>{d(!0);try{const{data:e}=await fe();D.value=e.items}catch{}finally{d(!1)}})(),(async(e={id:$.query.id})=>{d(!0);try{const{data:a}=await ie(e);l.value.id=a.id,l.value.title=a.title,l.value.content=a.content,l.value.category=a.category,l.value.scope=String(a.scope),l.value.users=a.users,l.value.resellers=a.resellers,l.value.channels=a.channels,l.value.is_popup=a.is_popup,l.value.priority=a.priority,l.value.expires_at=a.expires_at,l.value.scheduled_time=a.scheduled_time,l.value.remark=a.remark,l.value.status=a.status}catch{}finally{d(!1)}})();const q=async e=>{var b;if(!await((b=C.value)==null?void 0:b.validate())){d(!0);try{l.value.status=e,$.query.action?await de(l.value).then(()=>{let n="\u64CD\u4F5C\u6210\u529F";e===1?n="\u53D1\u5E03\u6210\u529F":e===2&&(n="\u4FDD\u5B58\u6210\u529F"),N.$message.success(n),U.push({name:"NoticeList"})}):await ce(l.value).then(()=>{let n="\u66F4\u65B0\u6210\u529F";e===1?n="\u53D1\u5E03\u6210\u529F":e===2&&(n="\u4FDD\u5B58\u6210\u529F"),N.$message.success(n),U.push({name:"NoticeList"})})}catch{}finally{d(!1)}}};return(e,a)=>{const b=J,n=j,E=A,c=P,_=W,p=X,M=Y,v=Z,B=x,G=ee,h=le,O=ae,z=te,H=oe;return i(),g("div",ye,[o(E,{class:"container-breadcrumb"},{default:r(()=>[o(n,null,{default:r(()=>[o(b)]),_:1}),o(n,null,{default:r(()=>[u(s(e.$t("menu.notice")),1)]),_:1}),o(n,null,{default:r(()=>[u(s(e.$t(R($).query.action?"menu.notice.create":"menu.notice.update")),1)]),_:1})]),_:1}),o(H,{loading:R(I),style:{width:"100%"}},{default:r(()=>[o(z,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:r(()=>[T("div",be,[o(O,{ref_key:"formRef",ref:C,model:l.value,class:"form","label-col-props":{span:3},"wrapper-col-props":{span:18}},{default:r(()=>[o(p,{label:e.$t("notice.label.template")},{default:r(()=>[o(_,{modelValue:l.value.template,"onUpdate:modelValue":a[0]||(a[0]=t=>l.value.template=t),placeholder:e.$t("notice.placeholder.template"),scrollbar:!1,"allow-search":"",onChange:S},{default:r(()=>[(i(!0),g(k,null,w(y.value,t=>(i(),f(c,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(p,{field:"title",label:e.$t("notice.label.title"),rules:[{required:!0,message:e.$t("notice.error.title.required")}]},{default:r(()=>[o(M,{modelValue:l.value.title,"onUpdate:modelValue":a[1]||(a[1]=t=>l.value.title=t),placeholder:e.$t("notice.placeholder.title"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(p,{field:"category",label:e.$t("notice.label.category"),rules:[{required:!0,message:e.$t("notice.error.category.required")}]},{default:r(()=>[o(_,{modelValue:l.value.category,"onUpdate:modelValue":a[2]||(a[2]=t=>l.value.category=t),placeholder:e.$t("notice.placeholder.category"),scrollbar:!1,"allow-search":""},{default:r(()=>[o(c,{value:"service"},{default:r(()=>[u(s(e.$t("notice.dict.category.service")),1)]),_:1}),o(c,{value:"activity"},{default:r(()=>[u(s(e.$t("notice.dict.category.activity")),1)]),_:1}),o(c,{value:"safety"},{default:r(()=>[u(s(e.$t("notice.dict.category.safety")),1)]),_:1}),o(c,{value:"maint"},{default:r(()=>[u(s(e.$t("notice.dict.category.maint")),1)]),_:1}),o(c,{value:"product"},{default:r(()=>[u(s(e.$t("notice.dict.category.product")),1)]),_:1}),o(c,{value:"fault"},{default:r(()=>[u(s(e.$t("notice.dict.category.fault")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(p,{field:"scope",label:e.$t("notice.label.scope"),rules:[{required:!0,message:e.$t("notice.error.scope.required")}]},{default:r(()=>[o(B,{size:"large"},{default:r(()=>[o(v,{modelValue:l.value.scope,"onUpdate:modelValue":a[3]||(a[3]=t=>l.value.scope=t),value:"1"},{default:r(()=>[u(s(e.$t("notice.dict.scope.1")),1)]),_:1},8,["modelValue"]),o(v,{modelValue:l.value.scope,"onUpdate:modelValue":a[4]||(a[4]=t=>l.value.scope=t),value:"2"},{default:r(()=>[u(s(e.$t("notice.dict.scope.2")),1)]),_:1},8,["modelValue"]),o(v,{modelValue:l.value.scope,"onUpdate:modelValue":a[5]||(a[5]=t=>l.value.scope=t),value:"3"},{default:r(()=>[u(s(e.$t("notice.dict.scope.3")),1)]),_:1},8,["modelValue"]),o(v,{modelValue:l.value.scope,"onUpdate:modelValue":a[6]||(a[6]=t=>l.value.scope=t),value:"4"},{default:r(()=>[u(s(e.$t("notice.dict.scope.4")),1)]),_:1},8,["modelValue"]),o(v,{modelValue:l.value.scope,"onUpdate:modelValue":a[7]||(a[7]=t=>l.value.scope=t),value:"5"},{default:r(()=>[u(s(e.$t("notice.dict.scope.5")),1)]),_:1},8,["modelValue"]),o(v,{modelValue:l.value.scope,"onUpdate:modelValue":a[8]||(a[8]=t=>l.value.scope=t),value:"6"},{default:r(()=>[u(s(e.$t("notice.dict.scope.6")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"]),l.value.scope==="4"||l.value.scope==="6"?(i(),f(p,{key:0,field:"users",label:e.$t("notice.label.users"),rules:[{required:!0,message:e.$t("notice.error.users.required")}]},{default:r(()=>[o(_,{modelValue:l.value.users,"onUpdate:modelValue":a[9]||(a[9]=t=>l.value.users=t),placeholder:e.$t("notice.placeholder.users"),scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:r(()=>[(i(!0),g(k,null,w(L.value,t=>(i(),f(c,{key:t.user_id,value:t.user_id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):V("",!0),l.value.scope==="5"||l.value.scope==="6"?(i(),f(p,{key:1,field:"resellers",label:e.$t("notice.label.resellers"),rules:[{required:!0,message:e.$t("notice.error.resellers.required")}]},{default:r(()=>[o(_,{modelValue:l.value.resellers,"onUpdate:modelValue":a[10]||(a[10]=t=>l.value.resellers=t),placeholder:e.$t("notice.placeholder.resellers"),scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:r(()=>[(i(!0),g(k,null,w(D.value,t=>(i(),f(c,{key:t.user_id,value:t.user_id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):V("",!0),o(p,{field:"content",label:e.$t("notice.label.content"),rules:[{required:!0,message:e.$t("notice.error.content.required")}]},{default:r(()=>[o(ve,{modelValue:l.value.content,"onUpdate:modelValue":a[11]||(a[11]=t=>l.value.content=t),style:{flex:"1"}},null,8,["modelValue"])]),_:1},8,["label","rules"]),o(p,{field:"remark",label:e.$t("notice.label.remark")},{default:r(()=>[o(G,{modelValue:l.value.remark,"onUpdate:modelValue":a[12]||(a[12]=t=>l.value.remark=t),placeholder:e.$t("notice.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(B,null,{default:r(()=>[T("div",_e,[o(h,{type:"secondary",onClick:a[13]||(a[13]=t=>q(2))},{default:r(()=>[u(s(e.$t("button.draft")),1)]),_:1}),l.value.scheduled_time?V("",!0):(i(),f(h,{key:0,type:"primary",onClick:a[14]||(a[14]=t=>q(1))},{default:r(()=>[u(s(e.$t("button.publish")),1)]),_:1})),l.value.scheduled_time?(i(),f(h,{key:1,type:"primary",onClick:a[15]||(a[15]=t=>q(3))},{default:r(()=>[u(s(e.$t("button.scheduled")),1)]),_:1})):V("",!0)])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const je=K(Ve,[["__scopeId","data-v-95335f00"]]);export{je as default};
