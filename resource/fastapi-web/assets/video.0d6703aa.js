import{c as De,u as xe,q as Fe,z as Ne,j as Le,A as Ue,_ as Be}from"./index.e4c753f9.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css              */import{d as Ae,r as Y,e as c,c as U,w as Z,bF as Pe,B as i,C as w,aH as e,aG as a,aL as p,aM as d,bu as B,aD as v,aJ as A,aI as P,u as E,D as _,E as Ee,g as Re,n as Te,as as qe,aK as Me,aF as Oe,bH as je,bI as He,b2 as Ge,bG as Je,aS as Ke,b1 as Qe,bJ as We,bK as Xe,b5 as Ye,bL as Ze,ab as et,aU as tt,bi as at,bj as lt,bl as ot,bm as st,b4 as nt,bM as it,bD as dt,bO as ut,bU as rt}from"./arco.088e2a49.js";import{u as ct}from"./loading.6f488126.js";import{f as pt}from"./app.798b498f.js";import{c as R,S as _t}from"./sortable.esm.70bb3f9a.js";import{u as mt}from"./vue.bd25b247.js";import"./chart.0bfa65d3.js";function ft(T){return De.post("/api/v1/task/video/page",T)}const vt={class:"container"},gt={class:"action-icon"},ht={class:"action-icon"},bt={id:"tableSetting"},kt={style:{"margin-right":"4px",cursor:"move"}},yt={class:"title"},wt=["onClick"],$t=["onClick"],Vt={name:"TaskVideoList"},Ct=Ae({...Vt,setup(T){const{proxy:ee}=Re(),g=localStorage.getItem("userRole"),te=Y({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),q=()=>({user_id:c(),app_id:c(),trace_id:"",video_id:"",video_url:"",status:c(),created_at:[]}),{loading:ae,setLoading:M}=ct(!0),{t:n}=xe(),O=c([]),s=c(q()),h=c([]),$=c([]),I=c("medium"),le=c(),j=c([]);g==="user"&&(async()=>{try{const{data:t}=await pt();j.value=t.items}catch{}})();const k={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},V=Y({...k}),oe=U(()=>[{name:n("size.mini"),value:"mini"},{name:n("size.small"),value:"small"},{name:n("size.medium"),value:"medium"},{name:n("size.large"),value:"large"}]),se=U(()=>[{title:n(g==="reseller"||g==="admin"?"task.columns.user_id":"task.columns.app_id"),dataIndex:g==="reseller"||g==="admin"?"user_id":"app_id",slotName:g==="reseller"||g==="admin"?"user_id":"app_id",align:"center",width:75},{title:n("task.columns.model"),dataIndex:"model",slotName:"model",align:"center"},{title:n("task.columns.video_id"),dataIndex:"video_id",slotName:"video_id",align:"center",ellipsis:!0,tooltip:!0},{title:n("task.columns.width_height"),dataIndex:"width_height",slotName:"width_height",align:"center"},{title:n("task.columns.seconds"),dataIndex:"seconds",slotName:"seconds",align:"center"},{title:n("task.columns.video_url"),dataIndex:"video_url",slotName:"video_url",align:"center",ellipsis:!0,tooltip:!0},{title:n("task.columns.status"),dataIndex:"status",slotName:"status",align:"center"},{title:n("task.columns.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132}]),ne=U(()=>[{label:n("task.dict.status.queued"),value:"queued"},{label:n("task.dict.status.in_progress"),value:"in_progress"},{label:n("task.dict.status.completed"),value:"completed"},{label:n("task.dict.status.failed"),value:"failed"},{label:n("task.dict.status.expired"),value:"expired"}]),C=async(t={...k})=>{M(!0);try{const{data:o}=await ft(t);O.value=o.items,V.current=t.current,V.pageSize=t.pageSize,V.total=o.paging.total}catch{}finally{M(!1)}},S=()=>{C({...k,...s.value})},ie=t=>{C({...k,...s.value,current:t})},de=t=>{k.pageSize=t,C({...k,...s.value})};C();const ue=()=>{s.value=q(),S()},re=(t,o)=>{I.value=t},ce=(t,o,m)=>{t?h.value.splice(m,0,o):h.value=$.value.filter(u=>u.dataIndex!==o.dataIndex)},H=(t,o,m,u=!1)=>{const f=u?R(t):t;return o>-1&&m>-1&&f.splice(o,1,f.splice(m,1,f[o]).pop()),f},pe=t=>{t&&Te(()=>{const o=document.getElementById("tableSetting");new _t(o,{onEnd(m){const{oldIndex:u,newIndex:f}=m;H(h.value,u,f),H($.value,u,f)}})})};Z(()=>se.value,t=>{h.value=R(t),h.value.forEach((o,m)=>{o.checked=!0}),$.value=R(h.value)},{deep:!0,immediate:!0});const{copy:_e,copied:G}=mt(),J=async t=>{_e(t)};return Z(G,()=>{G.value&&ee.$message.success("\u590D\u5236\u6210\u529F")}),(t,o)=>{const m=qe,u=Me,f=Oe,me=je,K=He,b=Ge,r=Je,fe=Ke,z=Qe,ve=We,D=Xe,ge=Ye,Q=Ze,he=et,W=tt,X=Fe,be=at,x=lt,ke=Ne,ye=ot,we=st,$e=Le,Ve=Ue,Ce=nt,Ie=it,y=dt,Se=ut,ze=rt,F=Pe("permission");return i(),w("div",vt,[e(f,{class:"container-breadcrumb"},{default:a(()=>[e(u,null,{default:a(()=>[e(m)]),_:1}),e(u,null,{default:a(()=>[p(d(t.$t("menu.task")),1)]),_:1}),e(u,null,{default:a(()=>[p(d(t.$t("menu.task.video.list")),1)]),_:1})]),_:1}),e(ze,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:a(()=>[e(D,null,{default:a(()=>[e(r,{flex:1},{default:a(()=>[e(ge,{model:s.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(D,{gutter:16},{default:a(()=>[B((i(),v(r,{span:8},{default:a(()=>[e(b,{field:"app_id",label:t.$t("task.form.app_id")},{default:a(()=>[e(K,{modelValue:s.value.app_id,"onUpdate:modelValue":o[0]||(o[0]=l=>s.value.app_id=l),placeholder:t.$t("task.form.selectDefault"),"allow-search":"","allow-clear":""},{default:a(()=>[(i(!0),w(A,null,P(j.value,l=>(i(),v(me,{key:l.app_id,value:l.app_id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[F,["user"]]]),B((i(),v(r,{span:8},{default:a(()=>[e(b,{field:"user_id",label:t.$t("task.form.user_id")},{default:a(()=>[e(fe,{modelValue:s.value.user_id,"onUpdate:modelValue":o[1]||(o[1]=l=>s.value.user_id=l),placeholder:t.$t("task.form.user_id.placeholder"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[F,["reseller","admin"]]]),e(r,{span:8},{default:a(()=>[e(b,{field:"trace_id",label:t.$t("task.form.trace_id")},{default:a(()=>[e(z,{modelValue:s.value.trace_id,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value.trace_id=l),placeholder:t.$t("task.form.trace_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(r,{span:8},{default:a(()=>[e(b,{field:"video_id",label:t.$t("task.form.video_id")},{default:a(()=>[e(z,{modelValue:s.value.video_id,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value.video_id=l),placeholder:t.$t("task.form.video_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(r,{span:8},{default:a(()=>[e(b,{field:"video_url",label:t.$t("task.form.video_url")},{default:a(()=>[e(z,{modelValue:s.value.video_url,"onUpdate:modelValue":o[4]||(o[4]=l=>s.value.video_url=l),placeholder:t.$t("task.form.video_url.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(r,{span:8},{default:a(()=>[e(b,{field:"status",label:t.$t("task.form.status")},{default:a(()=>[e(K,{modelValue:s.value.status,"onUpdate:modelValue":o[5]||(o[5]=l=>s.value.status=l),options:E(ne),placeholder:t.$t("task.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),e(r,{span:8},{default:a(()=>[e(b,{field:"created_at",label:t.$t("task.form.created_at")},{default:a(()=>[e(ve,{modelValue:s.value.created_at,"onUpdate:modelValue":o[6]||(o[6]=l=>s.value.created_at=l),placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Q,{style:{height:"84px"},direction:"vertical"}),e(r,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(be,{direction:"vertical",size:18},{default:a(()=>[e(W,{type:"primary",onClick:S},{icon:a(()=>[e(he)]),default:a(()=>[p(" "+d(t.$t("task.form.search")),1)]),_:1}),e(W,{onClick:ue},{icon:a(()=>[e(X)]),default:a(()=>[p(" "+d(t.$t("task.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),B(e(Q,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[F,["reseller","admin"]]]),e(D,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(r,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:a(()=>[e(x,{content:t.$t("actions.refresh")},{default:a(()=>[_("div",{class:"action-icon",onClick:S},[e(X,{size:"18"})])]),_:1},8,["content"]),e(we,{onSelect:re},{content:a(()=>[(i(!0),w(A,null,P(E(oe),l=>(i(),v(ye,{key:l.value,value:l.value,class:Ee({active:l.value===I.value})},{default:a(()=>[_("span",null,d(l.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(x,{content:t.$t("actions.density")},{default:a(()=>[_("div",gt,[e(ke,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(x,{content:t.$t("actions.column_setting")},{default:a(()=>[e(Ie,{trigger:"click",position:"bl",onPopupVisibleChange:pe},{content:a(()=>[_("div",bt,[(i(!0),w(A,null,P($.value,(l,N)=>(i(),w("div",{key:l.dataIndex,class:"setting"},[_("div",kt,[e(Ve)]),_("div",null,[e(Ce,{modelValue:l.checked,"onUpdate:modelValue":L=>l.checked=L,onChange:L=>ce(L,l,N)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_("div",yt,d(l.title==="#"?"\u5E8F\u5217\u53F7":l.title),1)]))),128))])]),default:a(()=>[_("div",ht,[e($e,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(Se,{ref_key:"tableRef",ref:le,"row-key":"id",loading:E(ae),pagination:V,columns:h.value,data:O.value,bordered:!1,size:I.value,"row-selection":te,onPageChange:ie,onPageSizeChange:de},{video_id:a(({record:l})=>[_("span",{class:"copy-btn",onClick:N=>J(l.video_id)},d(l.video_id||"-"),9,wt)]),width_height:a(({record:l})=>[p(d(`${l.width} \xD7 ${l.height}`),1)]),video_url:a(({record:l})=>[_("span",{class:"copy-btn",onClick:N=>J(l.video_url)},d(l.video_url||"-"),9,$t)]),status:a(({record:l})=>[l.status==="completed"?(i(),v(y,{key:0,color:"green"},{default:a(()=>[p(d(t.$t(`task.dict.status.${l.status}`)),1)]),_:2},1024)):l.status==="queued"?(i(),v(y,{key:1,color:"arcoblue"},{default:a(()=>[p(d(t.$t(`task.dict.status.${l.status}`)),1)]),_:2},1024)):l.status==="in_progress"?(i(),v(y,{key:2,color:"orange"},{default:a(()=>[p(d(t.$t(`task.dict.status.${l.status}`)),1)]),_:2},1024)):l.status==="failed"?(i(),v(y,{key:3,color:"red"},{default:a(()=>[p(d(t.$t(`task.dict.status.${l.status}`)),1)]),_:2},1024)):(i(),v(y,{key:4,color:"gray"},{default:a(()=>[p(d(t.$t(`task.dict.status.${l.status}`)),1)]),_:2},1024))]),_:1},8,["loading","pagination","columns","data","size","row-selection"])]),_:1})])}}});const Qt=Be(Ct,[["__scopeId","data-v-11187e5c"]]);export{Qt as default};
