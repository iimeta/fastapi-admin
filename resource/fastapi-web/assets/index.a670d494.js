import{b as J,y as K,_ as O}from"./index.0a66d3a0.js";/* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               */import{d as W,e as c,B as n,C as D,aH as e,aG as t,aL as b,aM as v,D as U,aD as f,u as i,aE as q,aJ as X,aI as Y,aK as Z,aF as ee,b1 as ae,b2 as le,bP as te,aT as oe,aS as ue,bQ as re,bR as se,bS as pe,bH as de,bI as ie,bT as ne,aU as me,bi as _e,b5 as ce,bU as be,bV as ve,g as fe}from"./arco.088e2a49.js";import{u as ge}from"./loading.6f488126.js";import{h as qe,f as ye}from"./vue.bd25b247.js";import{p as he,d as we,a as m}from"./common.051a2527.js";import{e as Ve,q as ke}from"./app.e9d45b3f.js";import{a as $e}from"./model.cd3fb8c6.js";import{q as De}from"./group.c4eff814.js";import{Q as p}from"./quota.da4d358d.js";import"./chart.0bfa65d3.js";const Ue={class:"container"},Ce={class:"wrapper"},Re={class:"submit-btn"},Se={name:"AppUpdate"},Le=W({...Se,setup(Ae){const{loading:C,setLoading:g}=ge(!1),{proxy:R}=fe(),S=qe(),L=ye(),A=J(),h=c([]);(async()=>{try{const{data:l}=await $e();h.value=l.items}catch{}})();const w=c([]);(async()=>{try{const{data:l}=await De();w.value=l.items}catch{}})();const V=c(),a=c({id:"",name:"",remark:"",status:1,models:[],is_limit_quota:!1,quota:c(),quota_expires_at:"",is_bind_group:!1,group:"",ip_whitelist:"",ip_blacklist:""}),B=async()=>{var o;if(!await((o=V.value)==null?void 0:o.validate())){g(!0);try{await Ve(a.value).then(()=>{R.$message.success("\u66F4\u65B0\u6210\u529F"),L.push({name:"AppList"})})}catch{}finally{g(!1)}}};(async(l={id:S.query.id})=>{var o,_;g(!0);try{const{data:r}=await ke(l);a.value.id=r.id,a.value.name=r.name,a.value.remark=r.remark,a.value.status=r.status,a.value.models=r.models,a.value.is_limit_quota=r.is_limit_quota,a.value.quota=r.quota,a.value.quota_expires_at=r.quota_expires_at,a.value.is_bind_group=r.is_bind_group,a.value.group=r.group,a.value.ip_whitelist=((o=r==null?void 0:r.ip_whitelist)==null?void 0:o.join(`
`))||"",a.value.ip_blacklist=((_=r==null?void 0:r.ip_blacklist)==null?void 0:_.join(`
`))||""}catch{}finally{g(!1)}})();const H=l=>{a.value.quota=l};return(l,o)=>{const _=K,r=Z,I=ee,x=ae,d=le,T=te,k=oe,F=ue,s=re,Q=se,G=pe,N=de,M=ie,y=ne,$=me,j=_e,P=ce,z=be,E=ve;return n(),D("div",Ue,[e(I,{class:"container-breadcrumb"},{default:t(()=>[e(r,null,{default:t(()=>[e(_)]),_:1}),e(r,null,{default:t(()=>[b(v(l.$t("menu.app")),1)]),_:1}),e(r,null,{default:t(()=>[b(v(l.$t("menu.app.update")),1)]),_:1})]),_:1}),e(E,{loading:i(C),style:{width:"100%"}},{default:t(()=>[e(z,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:t(()=>[U("div",Ce,[e(P,{ref_key:"formRef",ref:V,model:a.value,class:"form","label-col-props":{span:4},"wrapper-col-props":{span:18}},{default:t(()=>[e(d,{field:"name",label:l.$t("app.label.name"),rules:[{required:!0,message:l.$t("app.error.name.required")},{match:/^.{1,100}$/,message:l.$t("app.error.name.pattern")}]},{default:t(()=>[e(x,{modelValue:a.value.name,"onUpdate:modelValue":o[0]||(o[0]=u=>a.value.name=u),placeholder:l.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(d,{field:"models",label:l.$t("app.label.models")},{default:t(()=>[e(T,{modelValue:a.value.models,"onUpdate:modelValue":o[1]||(o[1]=u=>a.value.models=u),placeholder:l.$t("app.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:h.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"])]),_:1},8,["label"]),e(d,{field:"is_limit_quota",label:l.$t("app.label.isLimitQuota")},{default:t(()=>[e(k,{modelValue:a.value.is_limit_quota,"onUpdate:modelValue":o[2]||(o[2]=u=>a.value.is_limit_quota=u)},null,8,["modelValue"])]),_:1},8,["label"]),a.value.is_limit_quota?(n(),f(d,{key:0,field:"quota",label:l.$t("app.label.quota"),rules:[{required:!0,message:l.$t("app.error.quota.required")}]},{default:t(()=>[e(F,{modelValue:a.value.quota,"onUpdate:modelValue":o[3]||(o[3]=u=>a.value.quota=u),placeholder:l.$t("app.placeholder.quota"),min:1e-6,max:9999999999999,parser:i(he),"allow-clear":""},{prefix:t(()=>[b(v(i(A).getCurrencySymbol),1)]),_:1},8,["modelValue","placeholder","min","parser"])]),_:1},8,["label","rules"])):q("",!0),a.value.is_limit_quota?(n(),f(d,{key:1},{default:t(()=>[e(Q,{type:"button",onChange:H},{default:t(()=>[e(s,{value:5},{default:t(()=>[e(p,{"model-value":5})]),_:1}),e(s,{value:10},{default:t(()=>[e(p,{"model-value":10})]),_:1}),e(s,{value:20},{default:t(()=>[e(p,{"model-value":20})]),_:1}),e(s,{value:50},{default:t(()=>[e(p,{"model-value":50})]),_:1}),e(s,{value:100},{default:t(()=>[e(p,{"model-value":100})]),_:1}),e(s,{value:200},{default:t(()=>[e(p,{"model-value":200})]),_:1}),e(s,{value:300},{default:t(()=>[e(p,{"model-value":300})]),_:1}),e(s,{value:500},{default:t(()=>[e(p,{"model-value":500})]),_:1}),e(s,{value:1e3},{default:t(()=>[e(p,{"model-value":1e3})]),_:1}),e(s,{value:2e3},{default:t(()=>[e(p,{"model-value":2e3})]),_:1}),e(s,{value:5e3},{default:t(()=>[e(p,{"model-value":5e3})]),_:1}),e(s,{value:1e4,style:{padding:"0 2px"}},{default:t(()=>[e(p,{"model-value":1e4})]),_:1})]),_:1})]),_:1})):q("",!0),a.value.is_limit_quota?(n(),f(d,{key:2,field:"quota_expires_at",label:l.$t("app.label.quota_expires_at")},{default:t(()=>[e(G,{modelValue:a.value.quota_expires_at,"onUpdate:modelValue":o[4]||(o[4]=u=>a.value.quota_expires_at=u),placeholder:l.$t("app.placeholder.quota_expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":i(we),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>i(m)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>i(m)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>i(m)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>i(m)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>i(m)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>i(m)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>i(m)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"])):q("",!0),e(d,{field:"is_bind_group",label:l.$t("app.label.is_bind_group")},{default:t(()=>[e(k,{modelValue:a.value.is_bind_group,"onUpdate:modelValue":o[5]||(o[5]=u=>a.value.is_bind_group=u)},null,8,["modelValue"])]),_:1},8,["label"]),a.value.is_bind_group?(n(),f(d,{key:3,field:"group",label:l.$t("app.label.group"),rules:[{required:!0,message:l.$t("app.error.group.required")}]},{default:t(()=>[e(M,{modelValue:a.value.group,"onUpdate:modelValue":o[6]||(o[6]=u=>a.value.group=u),placeholder:l.$t("app.placeholder.group"),scrollbar:!1,"allow-search":"","allow-clear":""},{default:t(()=>[(n(!0),D(X,null,Y(w.value,u=>(n(),f(N,{key:u.id,value:u.id,label:u.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):q("",!0),e(d,{field:"ip_whitelist",label:l.$t("app.label.ip_whitelist")},{default:t(()=>[e(y,{modelValue:a.value.ip_whitelist,"onUpdate:modelValue":o[7]||(o[7]=u=>a.value.ip_whitelist=u),placeholder:l.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(d,{field:"ip_blacklist",label:l.$t("app.label.ip_blacklist")},{default:t(()=>[e(y,{modelValue:a.value.ip_blacklist,"onUpdate:modelValue":o[8]||(o[8]=u=>a.value.ip_blacklist=u),placeholder:l.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(d,{field:"remark",label:l.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[e(y,{modelValue:a.value.remark,"onUpdate:modelValue":o[9]||(o[9]=u=>a.value.remark=u),placeholder:l.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(j,null,{default:t(()=>[U("div",Re,[e($,{type:"secondary",onClick:o[10]||(o[10]=u=>l.$router.push({name:"AppList"}))},{default:t(()=>[b(v(l.$t("button.cancel")),1)]),_:1}),e($,{type:"primary",onClick:B},{default:t(()=>[b(v(l.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const oa=O(Le,[["__scopeId","data-v-967cf990"]]);export{oa as default};
