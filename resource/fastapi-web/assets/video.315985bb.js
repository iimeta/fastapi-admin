import{u as ce,_ as _e,s as He,A as Me,k as Oe,B as je}from"./index.715607dd.js";/* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css              */import{d as pe,e as y,w as Y,aZ as me,B as l,C as c,aH as t,aG as e,u as v,aD as d,aL as k,aM as i,aE as ue,bA as Ge,bB as Je,ad as Ke,bC as Ze,bD as ve,bE as Qe,r as re,c as J,bF as Xe,bu as K,aJ as Z,aI as Q,D as V,E as Ye,n as et,as as tt,aK as at,aF as lt,bH as ot,bI as st,b2 as nt,bG as it,aS as dt,b1 as ut,bJ as rt,bK as ct,b5 as _t,bL as pt,ab as mt,aU as vt,bi as ft,bj as bt,bk as kt,bl as ht,b4 as yt,bM as gt,bN as $t,aV as wt,bT as Ct}from"./arco.3f46b4ae.js";import{u as fe}from"./loading.37fd256d.js";import{e as Vt}from"./app.b68d22ed.js";import{q as It,v as Dt,a as St}from"./task.01a51bf4.js";import{c as X,S as zt}from"./sortable.esm.078712c4.js";import{u as be}from"./vue.dbcf9bc3.js";/* empty css                *//* empty css                */import"./chart.2cea905d.js";const Nt={style:{margin:"10px 0 30px 10px"}},Lt={key:1},Ut={key:1},Bt={key:1},Ft={key:1},At={key:1},Tt={key:1},qt={key:1},Pt={key:1},Et={key:1},Rt={key:1},Wt={key:1},xt={key:1},Ht={key:1},Mt={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},Ot={key:1},jt={key:1},Gt={key:1},Jt={key:1},Kt={key:1},Zt={key:1},Qt={name:"TaskVideoDetail"},Xt=pe({...Qt,props:{id:{type:String,default:""}},setup(ee){const $=ee,{t:E}=ce(),{loading:p,setLoading:T}=fe(!0),n=y({}),{copy:_,copied:F}=be();(async(s={id:$.id})=>{T(!0);try{const{data:h}=await It(s);n.value=h}catch{}finally{T(!1)}})();const g=s=>{_(s)};Y(F,()=>{F.value&&me.success(E("success.copy"))});const U=async(s,h)=>{const{data:m}=await Dt({id:s,field:h});_(m.value)},B=s=>s?s.startsWith("http://")||s.startsWith("https://")?s:window.location.origin+(s.startsWith("/")?s:`/${s}`):"";return(s,h)=>{const m=Ge,r=Je,I=Ke,f=Ze,N=ve,q=Qe;return l(),c("div",Nt,[t(q,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:e(()=>[t(f,{label:s.$t("common.trace_id"),span:2},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Lt,[k(i(n.value.trace_id)+" ",1),t(I,{class:"copy-btn",onClick:h[0]||(h[0]=z=>g(n.value.trace_id))})]))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.creator"),span:2},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Ut,[k(i(n.value.creator)+" ",1),t(I,{class:"copy-btn",onClick:h[1]||(h[1]=z=>U(n.value.id,"creator"))})]))]),_:1},8,["label"]),t(f,{label:s.$t("common.app_id")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Bt,i(n.value.app_id),1))]),_:1},8,["label"]),t(f,{label:s.$t("common.user_id")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Ft,i(n.value.user_id),1))]),_:1},8,["label"]),t(f,{label:s.$t("common.model")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",At,i(n.value.model),1))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.remixed_from_video_id")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Tt,i(n.value.remixed_from_video_id||"-"),1))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.video_id"),span:2},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",qt,[k(i(n.value.video_id)+" ",1),t(I,{class:"copy-btn",onClick:h[2]||(h[2]=z=>g(n.value.video_id))})]))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.video_url"),span:2},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Pt,[k(i(B(n.value.video_url)||"-")+" ",1),t(I,{class:"copy-btn",onClick:h[3]||(h[3]=z=>g(B(n.value.video_url)))})]))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.prompt"),span:2},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Et,i(n.value.prompt),1))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.width_height")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Rt,i(`${n.value.width} \xD7 ${n.value.height}`),1))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.seconds")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Wt,i(n.value.seconds),1))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.progress")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",xt,i(n.value.progress||0),1))]),_:1},8,["label"]),t(f,{label:s.$t("common.status")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Ht,[n.value.status==="completed"?(l(),d(N,{key:0,color:"green"},{default:e(()=>[k(i(s.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="queued"?(l(),d(N,{key:1,color:"arcoblue"},{default:e(()=>[k(i(s.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="in_progress"?(l(),d(N,{key:2,color:"orange"},{default:e(()=>[k(i(s.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="failed"||!n.value.status?(l(),d(N,{key:3,color:"red"},{default:e(()=>[k(i(s.$t(`task.dict.status.${n.value.status||"failed"}`)),1)]),_:1})):(l(),d(N,{key:4,color:"gray"},{default:e(()=>[k(i(s.$t(`task.dict.status.${n.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.error"),span:2},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Mt,i(n.value.error||"-"),1))]),_:1},8,["label"]),n.value.file_name?(l(),d(f,{key:0,label:s.$t("task.detail.file_name"),span:2},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Ot,i(n.value.file_name),1))]),_:1},8,["label"])):ue("",!0),n.value.file_path?(l(),d(f,{key:1,label:s.$t("task.detail.file_path"),span:2},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",jt,i(n.value.file_path),1))]),_:1},8,["label"])):ue("",!0),t(f,{label:s.$t("task.detail.completed_at")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Gt,i(n.value.completed_at||"-"),1))]),_:1},8,["label"]),t(f,{label:s.$t("task.detail.expires_at")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Jt,i(n.value.expires_at||"-"),1))]),_:1},8,["label"]),t(f,{label:s.$t("common.created_at")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Kt,i(n.value.created_at),1))]),_:1},8,["label"]),t(f,{label:s.$t("common.updated_at")},{default:e(()=>[v(p)?(l(),d(r,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(l(),c("span",Zt,i(n.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const Yt=_e(Xt,[["__scopeId","data-v-0ae2a439"]]),ea={class:"container"},ta={class:"action-icon"},aa={class:"action-icon"},la={id:"tableSetting"},oa={style:{"margin-right":"4px",cursor:"move"}},sa={class:"title"},na=["onClick"],ia=["onClick"],da={name:"TaskVideoList"},ua=pe({...da,setup(ee){const $=localStorage.getItem("userRole"),E=re({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),p=()=>({user_id:y(),app_id:y(),trace_id:"",video_id:"",video_url:"",status:y(),created_at:[]}),{loading:T,setLoading:n}=fe(!0),{t:_}=ce(),F=y([]),b=y(p()),g=y([]),U=y([]),B=y("medium"),s=y(),h=y([]);$==="user"&&(async()=>{try{const{data:a}=await Vt();h.value=a.items}catch{}})();const r={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},I=re({...r}),f=J(()=>[{name:_("size.mini"),value:"mini"},{name:_("size.small"),value:"small"},{name:_("size.medium"),value:"medium"},{name:_("size.large"),value:"large"}]),N=J(()=>[{title:_($==="reseller"||$==="admin"?"common.user_id":"common.app_id"),dataIndex:$==="reseller"||$==="admin"?"user_id":"app_id",slotName:$==="reseller"||$==="admin"?"user_id":"app_id",align:"center",width:75},{title:_("common.model"),dataIndex:"model",slotName:"model",align:"center",ellipsis:!0,tooltip:!0},{title:_("task.detail.video_id"),dataIndex:"video_id",slotName:"video_id",align:"center",ellipsis:!0,tooltip:!0},{title:_("task.detail.width_height"),dataIndex:"width_height",slotName:"width_height",align:"center"},{title:_("task.detail.seconds"),dataIndex:"seconds",slotName:"seconds",align:"center"},{title:_("task.detail.video_url"),dataIndex:"video_url",slotName:"video_url",align:"center",ellipsis:!0,tooltip:!0},{title:_("common.status"),dataIndex:"status",slotName:"status",align:"center"},{title:_("common.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:_("common.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),q=J(()=>[{label:_("task.dict.status.queued"),value:"queued"},{label:_("task.dict.status.in_progress"),value:"in_progress"},{label:_("task.dict.status.completed"),value:"completed"},{label:_("task.dict.status.failed"),value:"failed"},{label:_("task.dict.status.expired"),value:"expired"}]);$==="admin"&&q.value.push({label:_("task.dict.status.deleted"),value:"deleted"});const z=async(a={...r})=>{n(!0);try{const{data:u}=await St(a);F.value=u.items,I.current=a.current,I.pageSize=a.pageSize,I.total=u.paging.total}catch{}finally{n(!1)}},R=()=>{z({...r,...b.value})},ke=a=>{z({...r,...b.value,current:a})},he=a=>{r.pageSize=a,z({...r,...b.value})};z();const ye=()=>{b.value=p(),R()},ge=(a,u)=>{B.value=a},$e=(a,u,D)=>{a?g.value.splice(D,0,u):g.value=U.value.filter(w=>w.dataIndex!==u.dataIndex)},te=(a,u,D,w=!1)=>{const S=w?X(a):a;return u>-1&&D>-1&&S.splice(u,1,S.splice(D,1,S[u]).pop()),S},we=a=>{a&&et(()=>{const u=document.getElementById("tableSetting");new zt(u,{onEnd(D){const{oldIndex:w,newIndex:S}=D;te(g.value,w,S),te(U.value,w,S)}})})};Y(()=>N.value,a=>{g.value=X(a),g.value.forEach((u,D)=>{u.checked=!0}),U.value=X(g.value)},{deep:!0,immediate:!0});const W=y(!1),ae=y(),Ce=a=>{W.value=!0,ae.value=a},Ve=()=>{W.value=!1},{copy:Ie,copied:le}=be(),oe=async a=>{Ie(a)};Y(le,()=>{le.value&&me.success(_("success.copy"))});const se=a=>a?a.startsWith("http://")||a.startsWith("https://")?a:window.location.origin+(a.startsWith("/")?a:`/${a}`):"";return(a,u)=>{const D=tt,w=at,S=lt,De=ot,ne=st,L=nt,C=it,Se=dt,x=ut,ze=rt,H=ct,Ne=_t,ie=pt,Le=mt,M=vt,de=He,Ue=ft,O=bt,Be=Me,Fe=kt,Ae=ht,Te=Oe,qe=je,Pe=yt,Ee=gt,A=ve,Re=$t,We=wt,xe=Ct,j=Xe("permission");return l(),c("div",ea,[t(S,{class:"container-breadcrumb"},{default:e(()=>[t(w,null,{default:e(()=>[t(D)]),_:1}),t(w,null,{default:e(()=>[k(i(a.$t("task.menu")),1)]),_:1}),t(w,null,{default:e(()=>[k(i(a.$t("task.menu.video")),1)]),_:1})]),_:1}),t(xe,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:e(()=>[t(H,null,{default:e(()=>[t(C,{flex:1},{default:e(()=>[t(Ne,{model:b.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(H,{gutter:16},{default:e(()=>[K((l(),d(C,{span:8},{default:e(()=>[t(L,{field:"app_id",label:a.$t("common.app")},{default:e(()=>[t(ne,{modelValue:b.value.app_id,"onUpdate:modelValue":u[0]||(u[0]=o=>b.value.app_id=o),placeholder:a.$t("common.all"),"allow-search":"","allow-clear":""},{default:e(()=>[(l(!0),c(Z,null,Q(h.value,o=>(l(),d(De,{key:o.app_id,value:o.app_id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[j,["user"]]]),K((l(),d(C,{span:8},{default:e(()=>[t(L,{field:"user_id",label:a.$t("task.form.user_id")},{default:e(()=>[t(Se,{modelValue:b.value.user_id,"onUpdate:modelValue":u[1]||(u[1]=o=>b.value.user_id=o),placeholder:a.$t("placeholder.user_id"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[j,["reseller","admin"]]]),t(C,{span:8},{default:e(()=>[t(L,{field:"trace_id",label:a.$t("task.form.trace_id")},{default:e(()=>[t(x,{modelValue:b.value.trace_id,"onUpdate:modelValue":u[2]||(u[2]=o=>b.value.trace_id=o),placeholder:a.$t("placeholder.trace_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(L,{field:"video_id",label:a.$t("task.detail.video_id")},{default:e(()=>[t(x,{modelValue:b.value.video_id,"onUpdate:modelValue":u[3]||(u[3]=o=>b.value.video_id=o),placeholder:a.$t("task.form.placeholder.video_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(L,{field:"video_url",label:a.$t("task.detail.video_url")},{default:e(()=>[t(x,{modelValue:b.value.video_url,"onUpdate:modelValue":u[4]||(u[4]=o=>b.value.video_url=o),placeholder:a.$t("task.form.placeholder.video_url"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(L,{field:"status",label:a.$t("common.status")},{default:e(()=>[t(ne,{modelValue:b.value.status,"onUpdate:modelValue":u[5]||(u[5]=o=>b.value.status=o),options:v(q),placeholder:a.$t("common.all"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(L,{field:"created_at",label:a.$t("common.created_at")},{default:e(()=>[t(ze,{modelValue:b.value.created_at,"onUpdate:modelValue":u[6]||(u[6]=o=>b.value.created_at=o),placeholder:[a.$t("common.start_time"),a.$t("common.end_time")],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(ie,{style:{height:"84px"},direction:"vertical"}),t(C,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[t(Ue,{direction:"vertical",size:18},{default:e(()=>[t(M,{type:"primary",onClick:R},{icon:e(()=>[t(Le)]),default:e(()=>[k(" "+i(a.$t("button.search")),1)]),_:1}),t(M,{onClick:ye},{icon:e(()=>[t(de)]),default:e(()=>[k(" "+i(a.$t("button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),K(t(ie,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[j,["reseller","admin"]]]),t(H,{style:{"margin-bottom":"16px"}},{default:e(()=>[t(C,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:e(()=>[t(O,{content:a.$t("action.refresh")},{default:e(()=>[V("div",{class:"action-icon",onClick:R},[t(de,{size:"18"})])]),_:1},8,["content"]),t(Ae,{onSelect:ge},{content:e(()=>[(l(!0),c(Z,null,Q(v(f),o=>(l(),d(Fe,{key:o.value,value:o.value,class:Ye({active:o.value===B.value})},{default:e(()=>[V("span",null,i(o.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[t(O,{content:a.$t("action.density")},{default:e(()=>[V("div",ta,[t(Be,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(O,{content:a.$t("action.column_setting")},{default:e(()=>[t(Ee,{trigger:"click",position:"bl",onPopupVisibleChange:we},{content:e(()=>[V("div",la,[(l(!0),c(Z,null,Q(U.value,(o,P)=>(l(),c("div",{key:o.dataIndex,class:"setting"},[V("div",oa,[t(qe)]),V("div",null,[t(Pe,{modelValue:o.checked,"onUpdate:modelValue":G=>o.checked=G,onChange:G=>$e(G,o,P)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),V("div",sa,i(o.title),1)]))),128))])]),default:e(()=>[V("div",aa,[t(Te,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(Re,{ref_key:"tableRef",ref:s,"row-key":"id",loading:v(T),pagination:I,columns:g.value,data:F.value,bordered:!1,size:B.value,"row-selection":E,onPageChange:ke,onPageSizeChange:he},{video_id:e(({record:o})=>[V("span",{class:"copy-btn",onClick:P=>oe(o.video_id)},i(o.video_id||"-"),9,na)]),width_height:e(({record:o})=>[k(i(`${o.width} \xD7 ${o.height}`),1)]),video_url:e(({record:o})=>[V("span",{class:"copy-btn",onClick:P=>oe(se(o.video_url))},i(se(o.video_url)||"-"),9,ia)]),status:e(({record:o})=>[o.status==="completed"?(l(),d(A,{key:0,color:"green"},{default:e(()=>[k(i(a.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="queued"?(l(),d(A,{key:1,color:"arcoblue"},{default:e(()=>[k(i(a.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="in_progress"?(l(),d(A,{key:2,color:"orange"},{default:e(()=>[k(i(a.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="failed"||!o.status?(l(),d(A,{key:3,color:"red"},{default:e(()=>[k(i(a.$t(`task.dict.status.${o.status||"failed"}`)),1)]),_:2},1024)):(l(),d(A,{key:4,color:"gray"},{default:e(()=>[k(i(a.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024))]),operations:e(({record:o})=>[t(M,{type:"text",size:"small",onClick:P=>Ce(o.id)},{default:e(()=>[k(i(a.$t("button.detail")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),t(We,{title:a.$t("task.menu.video.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:W.value,onCancel:Ve},{default:e(()=>[t(Yt,{id:ae.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const Fa=_e(ua,[["__scopeId","data-v-b32f5fa2"]]);export{Fa as default};
