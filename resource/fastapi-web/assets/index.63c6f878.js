import{B as E,_ as O}from"./index.9184f0c9.js";/* empty css               *//* empty css              *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css               */import{d as P,e as b,B as _,C as D,aH as l,aG as t,aL as r,aM as f,F as y,aD as v,u as i,aE as q,bT as n,aJ as J,aI as K,aK as W,aF as X,b1 as Y,b2 as Z,bP as ee,aT as ae,aS as le,bQ as te,bV as oe,bW as ue,bF as se,bG as re,bO as pe,aU as ie,bi as de,b5 as ne,bN as me,bR as _e,g as ce}from"./arco.ba78a5b2.js";import{u as be}from"./loading.0618e973.js";import{h as fe,f as ve}from"./vue.2736b3ca.js";import{q as qe}from"./common.df364eef.js";import{g as ge,q as ye}from"./app.9f1e8618.js";import{b as he}from"./model.a3fec5d1.js";import{q as $e}from"./group.41231cf5.js";import"./chart.df189e8a.js";const we={class:"container"},Ve={class:"wrapper"},ke={class:"submit-btn"},De={name:"AppUpdate"},Ue=P({...De,setup(Ce){const{loading:U,setLoading:m}=be(!1),{proxy:C}=ce(),B=fe(),R=ve(),h=b([]);(async()=>{m(!0);try{const{data:a}=await he();h.value=a.items}catch{}finally{m(!1)}})();const $=b([]);(async()=>{m(!0);try{const{data:a}=await $e();$.value=a.items}catch{}finally{m(!1)}})();const w=b(),e=b({id:"",name:"",remark:"",status:1,models:[],is_limit_quota:!1,quota:b(),quota_expires_at:"",is_bind_group:!1,group:"",ip_whitelist:"",ip_blacklist:""}),L=async()=>{var o;if(!await((o=w.value)==null?void 0:o.validate())){m(!0);try{await ge(e.value).then(()=>{C.$message.success("\u66F4\u65B0\u6210\u529F"),R.push({name:"AppList"})})}catch{}finally{m(!1)}}};(async(a={id:B.query.id})=>{var o,c;m(!0);try{const{data:s}=await ye(a);e.value.id=s.id,e.value.name=s.name,e.value.remark=s.remark,e.value.status=s.status,e.value.models=s.models,e.value.is_limit_quota=s.is_limit_quota,e.value.quota=s.quota,e.value.quota_expires_at=s.quota_expires_at,e.value.is_bind_group=s.is_bind_group,e.value.group=s.group,e.value.ip_whitelist=((o=s==null?void 0:s.ip_whitelist)==null?void 0:o.join(`
`))||"",e.value.ip_blacklist=((c=s==null?void 0:s.ip_blacklist)==null?void 0:c.join(`
`))||""}catch{}finally{m(!1)}})();const F=a=>{e.value.quota=a*5e5};return(a,o)=>{const c=E,s=W,x=X,A=Y,p=Z,H=ee,V=ae,I=le,d=te,T=oe,S=ue,G=se,N=re,g=pe,k=ie,M=de,Q=ne,j=me,z=_e;return _(),D("div",we,[l(x,{class:"container-breadcrumb"},{default:t(()=>[l(s,null,{default:t(()=>[l(c)]),_:1}),l(s,null,{default:t(()=>[r(f(a.$t("menu.app")),1)]),_:1}),l(s,null,{default:t(()=>[r(f(a.$t("menu.app.update")),1)]),_:1})]),_:1}),l(z,{loading:i(U),style:{width:"100%"}},{default:t(()=>[l(j,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:t(()=>[y("div",Ve,[l(Q,{ref_key:"formRef",ref:w,model:e.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[l(p,{field:"name",label:a.$t("app.label.name"),rules:[{required:!0,message:a.$t("app.error.name.required")},{match:/^.{1,100}$/,message:a.$t("app.error.name.pattern")}]},{default:t(()=>[l(A,{modelValue:e.value.name,"onUpdate:modelValue":o[0]||(o[0]=u=>e.value.name=u),placeholder:a.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),l(p,{field:"models",label:a.$t("app.label.models")},{default:t(()=>[l(H,{modelValue:e.value.models,"onUpdate:modelValue":o[1]||(o[1]=u=>e.value.models=u),placeholder:a.$t("app.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:h.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"])]),_:1},8,["label"]),l(p,{field:"is_limit_quota",label:a.$t("app.label.isLimitQuota")},{default:t(()=>[l(V,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":o[2]||(o[2]=u=>e.value.is_limit_quota=u)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(_(),v(p,{key:0,field:"quota",label:a.$t("app.label.quota"),rules:[{required:!0,message:a.$t("app.error.quota.required")}]},{default:t(()=>[l(I,{modelValue:e.value.quota,"onUpdate:modelValue":o[3]||(o[3]=u=>e.value.quota=u),placeholder:a.$t("app.placeholder.quota"),precision:0,min:0,max:9999999999999,style:{width:"492px","margin-right":"10px"}},null,8,["modelValue","placeholder"]),y("div",null," $"+f(e.value.quota?i(qe)(e.value.quota):"0"),1)]),_:1},8,["label","rules"])):q("",!0),e.value.is_limit_quota?(_(),v(p,{key:1},{default:t(()=>[l(T,{type:"button",onChange:F},{default:t(()=>[l(d,{value:1},{default:t(()=>[r(" $1 ")]),_:1}),l(d,{value:5},{default:t(()=>[r(" $5 ")]),_:1}),l(d,{value:10},{default:t(()=>[r(" $10 ")]),_:1}),l(d,{value:20},{default:t(()=>[r(" $20 ")]),_:1}),l(d,{value:50},{default:t(()=>[r(" $50 ")]),_:1}),l(d,{value:100},{default:t(()=>[r(" $100 ")]),_:1}),l(d,{value:200},{default:t(()=>[r(" $200 ")]),_:1}),l(d,{value:500},{default:t(()=>[r(" $500 ")]),_:1}),l(d,{value:1e3},{default:t(()=>[r(" $1000 ")]),_:1})]),_:1},8,["onChange"])]),_:1})):q("",!0),e.value.is_limit_quota?(_(),v(p,{key:2,field:"quota_expires_at",label:a.$t("app.label.quota_expires_at")},{default:t(()=>[l(S,{modelValue:e.value.quota_expires_at,"onUpdate:modelValue":o[4]||(o[4]=u=>e.value.quota_expires_at=u),placeholder:a.$t("app.placeholder.quota_expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":u=>i(n)(u).isBefore(i(n)().subtract(1,"day")),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>i(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>i(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>i(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>i(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>i(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>i(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>i(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"])):q("",!0),l(p,{field:"is_bind_group",label:a.$t("app.label.is_bind_group")},{default:t(()=>[l(V,{modelValue:e.value.is_bind_group,"onUpdate:modelValue":o[5]||(o[5]=u=>e.value.is_bind_group=u)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_bind_group?(_(),v(p,{key:3,field:"group",label:a.$t("app.label.group"),rules:[{required:!0,message:a.$t("app.error.group.required")}]},{default:t(()=>[l(N,{modelValue:e.value.group,"onUpdate:modelValue":o[6]||(o[6]=u=>e.value.group=u),placeholder:a.$t("app.placeholder.group"),scrollbar:!1,"allow-search":"","allow-clear":""},{default:t(()=>[(_(!0),D(J,null,K($.value,u=>(_(),v(G,{key:u.id,value:u.id,label:u.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):q("",!0),l(p,{field:"ip_whitelist",label:a.$t("app.label.ip_whitelist")},{default:t(()=>[l(g,{modelValue:e.value.ip_whitelist,"onUpdate:modelValue":o[7]||(o[7]=u=>e.value.ip_whitelist=u),placeholder:a.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{field:"ip_blacklist",label:a.$t("app.label.ip_blacklist")},{default:t(()=>[l(g,{modelValue:e.value.ip_blacklist,"onUpdate:modelValue":o[8]||(o[8]=u=>e.value.ip_blacklist=u),placeholder:a.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{field:"remark",label:a.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[l(g,{modelValue:e.value.remark,"onUpdate:modelValue":o[9]||(o[9]=u=>e.value.remark=u),placeholder:a.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(M,null,{default:t(()=>[y("div",ke,[l(k,{type:"secondary",onClick:o[10]||(o[10]=u=>a.$router.push({name:"AppList"}))},{default:t(()=>[r(f(a.$t("button.cancel")),1)]),_:1}),l(k,{type:"primary",onClick:L},{default:t(()=>[r(f(a.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const ea=O(Ue,[["__scopeId","data-v-50b2c5f9"]]);export{ea as default};
