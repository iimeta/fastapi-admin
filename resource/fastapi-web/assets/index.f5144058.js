import{u as qe,x as Pe,p as He,y as Oe,i as Te,z as Re,_ as je}from"./index.0ef0cd46.js";/* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              */import{d as Ge,r as ne,e as u,c as R,w as Ke,B as r,C as v,aH as t,aG as a,aL as i,aM as d,aJ as z,aI as A,aD as j,u as G,F as h,D as Je,n as Qe,aK as We,aF as Xe,bA as Ye,bB as Ze,b2 as et,bC as tt,b1 as at,bD as lt,b5 as ot,bE as nt,ab as st,aU as ut,bi as it,bj as dt,bl as rt,bm as ct,b4 as mt,bF as pt,aT as _t,bG as gt,bH as ft,aV as vt,a_ as bt,bI as ht,g as yt}from"./arco.a9260898.js";import{u as kt}from"./loading.1f346a94.js";import{s as Ct,q as $t,a as wt,b as Vt}from"./agent.a9a8843c.js";import{c as K,S as xt}from"./sortable.esm.a0dfbf42.js";import{q as Ft}from"./corp.12c72f27.js";import{q as Et}from"./model.e52ac8e5.js";import{M as se}from"./models.6608ac17.js";import{_ as Bt}from"./index.vue_vue_type_script_setup_true_lang.1e55037c.js";import"./chart.d103b168.js";import"./vue.ad52ddbe.js";/* empty css                *//* empty css                */const Dt={class:"container"},It={class:"action-icon"},zt={class:"action-icon"},At={id:"tableSetting"},St={style:{"margin-right":"4px",cursor:"move"}},Mt={class:"title"},Lt={key:0},Nt={key:1},Ut={key:0},qt={key:1},Pt={name:"ModelAgentList"},Ht=Ge({...Pt,setup(Ot){const{loading:ue,setLoading:m}=kt(!0),{proxy:x}=yt(),ie=ne({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),J=u([]);(async()=>{m(!0);try{const{data:e}=await Ft();J.value=e.items}catch{}finally{m(!1)}})();const Q=u([]);(async()=>{try{const{data:e}=await Et();Q.value=e.items}catch{}})();const de=async e=>{m(!0);try{await Ct(e),x.$message.success("\u5220\u9664\u6210\u529F"),F()}catch{}finally{m(!1)}},W=()=>({corp:"",name:"",base_url:"",models:[],status:u(),remark:""}),{t:s}=qe(),X=u([]),n=u(W()),y=u([]),E=u([]),S=u("medium"),k=u([]),C=u(!0),Y=u(),$={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},B=ne({...$}),re=R(()=>[{name:s("size.mini"),value:"mini"},{name:s("size.small"),value:"small"},{name:s("size.medium"),value:"medium"},{name:s("size.large"),value:"large"}]),ce=R(()=>[{title:s("model.agent.columns.corp"),dataIndex:"corp_name",slotName:"corp_name",align:"center",width:110},{title:s("model.agent.columns.name"),dataIndex:"name",slotName:"name",align:"center",ellipsis:!0,tooltip:!0},{title:s("model.agent.columns.models"),dataIndex:"model_names",slotName:"model_names",align:"center",ellipsis:!0,tooltip:!0},{title:s("model.agent.columns.fallback_models"),dataIndex:"fallback_model_names",slotName:"fallback_model_names",align:"center",ellipsis:!0,tooltip:!0},{title:s("common.weight"),dataIndex:"weight",slotName:"weight",align:"center"},{title:s("model.columns.lb_strategy"),dataIndex:"lb_strategy",slotName:"lb_strategy",align:"center"},{title:s("model.agent.columns.remark"),dataIndex:"remark",slotName:"remark",align:"center",ellipsis:!0,tooltip:!0},{title:s("model.agent.columns.status"),dataIndex:"status",slotName:"status",align:"center",width:65},{title:s("model.agent.columns.updated_at"),dataIndex:"updated_at",slotName:"updated_at",align:"center",width:132},{title:s("model.agent.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:216}]),me=R(()=>[{label:s("model.agent.dict.status.1"),value:1},{label:s("model.agent.dict.status.2"),value:2}]),D=async(e={...$})=>{m(!0);try{const{data:o}=await $t(e);X.value=o.items,B.current=e.current,B.pageSize=e.pageSize,B.total=o.paging.total}catch{}finally{m(!1)}},F=()=>{D({...$,...n.value})},pe=e=>{D({...$,...n.value,current:e})},_e=e=>{$.pageSize=e,D({...$,...n.value})};D();const ge=()=>{n.value=W()},fe=async e=>{m(!0);try{await wt(e),x.$message.success("\u64CD\u4F5C\u6210\u529F"),F()}catch{}finally{m(!1)}},ve=(e,o)=>{S.value=e},be=(e,o,p)=>{e?y.value.splice(p,0,o):y.value=E.value.filter(_=>_.dataIndex!==o.dataIndex)},Z=(e,o,p,_=!1)=>{const b=_?K(e):e;return o>-1&&p>-1&&b.splice(o,1,b.splice(p,1,b[o]).pop()),b},he=e=>{e&&Qe(()=>{const o=document.getElementById("tableSetting");new xt(o,{onEnd(p){const{oldIndex:_,newIndex:b}=p;Z(y.value,_,b),Z(E.value,_,b)}})})};Ke(()=>ce.value,e=>{y.value=K(e),y.value.forEach((o,p)=>{o.checked=!0}),E.value=K(y.value)},{deep:!0,immediate:!0});const ye=e=>{k.value=e,C.value=!e.length},M=e=>{if(k.value.length===0)x.$message.info("\u8BF7\u9009\u62E9\u8981\u64CD\u4F5C\u7684\u6570\u636E");else{let o=`\u662F\u5426\u786E\u5B9A\u64CD\u4F5C\u6240\u9009\u7684${k.value.length}\u6761\u6570\u636E?`;switch(e.action){case"status":e.value===1?o=`\u662F\u5426\u786E\u5B9A\u542F\u7528\u6240\u9009\u7684${k.value.length}\u6761\u6570\u636E?`:o=`\u662F\u5426\u786E\u5B9A\u7981\u7528\u6240\u9009\u7684${k.value.length}\u6761\u6570\u636E?`;break;case"delete":o=`\u662F\u5426\u786E\u5B9A\u5220\u9664\u6240\u9009\u7684${k.value.length}\u6761\u6570\u636E?`;break}x.$modal.warning({title:"\u8B66\u544A",titleAlign:"center",content:o,hideCancel:!1,onOk:()=>{m(!0),e.ids=k.value,Vt(e).then(p=>{m(!1),x.$message.success("\u64CD\u4F5C\u6210\u529F"),F(),Y.value.selectAll(!1)})}})}},L=u(!1),w=u(),ke=e=>{L.value=!0,w.value=e},Ce=()=>{L.value=!1},N=u(!1),U=u(!1),I=u(),$e=e=>{N.value=!0,w.value=e,I.value="agent"},we=e=>{U.value=!0,w.value=e,I.value="fallback"};return(e,o)=>{const p=Pe,_=We,b=Xe,ee=Ye,q=Ze,V=et,g=tt,P=at,H=lt,Ve=ot,te=nt,xe=st,c=ut,ae=He,le=it,O=dt,Fe=Oe,Ee=rt,Be=ct,De=Te,Ie=Re,ze=mt,Ae=pt,Se=_t,Me=gt,Le=ft,Ne=vt,oe=bt,Ue=ht;return r(),v("div",Dt,[t(b,{class:"container-breadcrumb"},{default:a(()=>[t(_,null,{default:a(()=>[t(p)]),_:1}),t(_,null,{default:a(()=>[i(d(e.$t("menu.agent")),1)]),_:1}),t(_,null,{default:a(()=>[i(d(e.$t("menu.model.agent.list")),1)]),_:1})]),_:1}),t(Ue,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:a(()=>[t(H,null,{default:a(()=>[t(g,{flex:1},{default:a(()=>[t(Ve,{model:n.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[t(H,{gutter:16},{default:a(()=>[t(g,{span:8},{default:a(()=>[t(V,{field:"corp",label:e.$t("model.agent.form.corp")},{default:a(()=>[t(q,{modelValue:n.value.corp,"onUpdate:modelValue":o[0]||(o[0]=l=>n.value.corp=l),placeholder:e.$t("model.agent.form.selectDefault"),"allow-search":"","allow-clear":""},{default:a(()=>[(r(!0),v(z,null,A(J.value,l=>(r(),j(ee,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(g,{span:8},{default:a(()=>[t(V,{field:"name",label:e.$t("model.agent.form.name")},{default:a(()=>[t(P,{modelValue:n.value.name,"onUpdate:modelValue":o[1]||(o[1]=l=>n.value.name=l),placeholder:e.$t("model.agent.form.name.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(g,{span:8},{default:a(()=>[t(V,{field:"base_url",label:e.$t("model.agent.form.base_url")},{default:a(()=>[t(P,{modelValue:n.value.base_url,"onUpdate:modelValue":o[2]||(o[2]=l=>n.value.base_url=l),placeholder:e.$t("model.agent.form.base_url.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(g,{span:8},{default:a(()=>[t(V,{field:"models",label:e.$t("model.agent.form.models")},{default:a(()=>[t(q,{modelValue:n.value.models,"onUpdate:modelValue":o[3]||(o[3]=l=>n.value.models=l),placeholder:e.$t("model.agent.form.selectDefault"),"max-tag-count":2,multiple:"","allow-search":"","allow-clear":""},{default:a(()=>[(r(!0),v(z,null,A(Q.value,l=>(r(),j(ee,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(g,{span:8},{default:a(()=>[t(V,{field:"status",label:e.$t("model.agent.form.status")},{default:a(()=>[t(q,{modelValue:n.value.status,"onUpdate:modelValue":o[4]||(o[4]=l=>n.value.status=l),options:G(me),placeholder:e.$t("model.agent.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(g,{span:8},{default:a(()=>[t(V,{field:"remark",label:e.$t("model.agent.form.remark")},{default:a(()=>[t(P,{modelValue:n.value.remark,"onUpdate:modelValue":o[5]||(o[5]=l=>n.value.remark=l),placeholder:e.$t("model.agent.form.remark.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(te,{style:{height:"84px"},direction:"vertical"}),t(g,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[t(le,{direction:"vertical",size:18},{default:a(()=>[t(c,{type:"primary",onClick:F},{icon:a(()=>[t(xe)]),default:a(()=>[i(" "+d(e.$t("model.agent.form.search")),1)]),_:1}),t(c,{onClick:ge},{icon:a(()=>[t(ae)]),default:a(()=>[i(" "+d(e.$t("model.agent.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(te,{style:{"margin-top":"0","margin-bottom":"16px"}}),t(H,{style:{"margin-bottom":"16px"}},{default:a(()=>[t(g,{span:12},{default:a(()=>[t(le,null,{default:a(()=>[t(c,{type:"primary",onClick:o[6]||(o[6]=l=>e.$router.push({name:"ModelAgentCreate"}))},{default:a(()=>[i(d(e.$t("model.agent.operation.create")),1)]),_:1}),t(c,{type:"primary",status:"success",disabled:C.value,title:C.value?"\u8BF7\u9009\u62E9\u8981\u64CD\u4F5C\u7684\u6570\u636E":"",onClick:o[7]||(o[7]=l=>M({action:"status",value:1}))},{default:a(()=>[i(" \u542F\u7528 ")]),_:1},8,["disabled","title"]),t(c,{type:"primary",status:"danger",disabled:C.value,title:C.value?"\u8BF7\u9009\u62E9\u8981\u64CD\u4F5C\u7684\u6570\u636E":"",onClick:o[8]||(o[8]=l=>M({action:"status",value:2}))},{default:a(()=>[i(" \u7981\u7528 ")]),_:1},8,["disabled","title"]),t(c,{type:"primary",status:"danger",disabled:C.value,title:C.value?"\u8BF7\u9009\u62E9\u8981\u64CD\u4F5C\u7684\u6570\u636E":"",onClick:o[9]||(o[9]=l=>M({action:"delete"}))},{default:a(()=>[i(" \u5220\u9664 ")]),_:1},8,["disabled","title"])]),_:1})]),_:1}),t(g,{span:12,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:a(()=>[t(O,{content:e.$t("actions.refresh")},{default:a(()=>[h("div",{class:"action-icon",onClick:F},[t(ae,{size:"18"})])]),_:1},8,["content"]),t(Be,{onSelect:ve},{content:a(()=>[(r(!0),v(z,null,A(G(re),l=>(r(),j(Ee,{key:l.value,value:l.value,class:Je({active:l.value===S.value})},{default:a(()=>[h("span",null,d(l.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[t(O,{content:e.$t("actions.density")},{default:a(()=>[h("div",It,[t(Fe,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(O,{content:e.$t("actions.column_setting")},{default:a(()=>[t(Ae,{trigger:"click",position:"bl",onPopupVisibleChange:he},{content:a(()=>[h("div",At,[(r(!0),v(z,null,A(E.value,(l,f)=>(r(),v("div",{key:l.dataIndex,class:"setting"},[h("div",St,[t(Ie)]),h("div",null,[t(ze,{modelValue:l.checked,"onUpdate:modelValue":T=>l.checked=T,onChange:T=>be(T,l,f)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),h("div",Mt,d(l.title==="#"?"\u5E8F\u5217\u53F7":l.title),1)]))),128))])]),default:a(()=>[h("div",zt,[t(De,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(Le,{ref_key:"tableRef",ref:Y,"row-key":"id",loading:G(ue),pagination:B,columns:y.value,data:X.value,bordered:!1,size:S.value,"row-selection":ie,onPageChange:pe,onPageSizeChange:_e,onSelectionChange:ye},{model_names:a(({record:l})=>[l.model_names?(r(),v("span",Lt,[t(c,{type:"text",size:"small",onClick:f=>$e(l.id)},{default:a(()=>[i(" \u67E5\u770B ")]),_:2},1032,["onClick"])])):(r(),v("span",Nt,d("-")))]),fallback_model_names:a(({record:l})=>[l.fallback_model_names?(r(),v("span",Ut,[t(c,{type:"text",size:"small",onClick:f=>we(l.id)},{default:a(()=>[i(" \u67E5\u770B ")]),_:2},1032,["onClick"])])):(r(),v("span",qt,d("-")))]),lb_strategy:a(({record:l})=>[i(d(e.$t(`dict.lb_strategy.${l.lb_strategy||1}`)),1)]),remark:a(({record:l})=>[i(d(l.remark||"-"),1)]),status:a(({record:l})=>[t(Se,{modelValue:l.status,"onUpdate:modelValue":f=>l.status=f,"checked-value":1,"unchecked-value":2,onChange:f=>fe({id:`${l.id}`,status:Number(`${l.status}`)})},null,8,["modelValue","onUpdate:modelValue","onChange"])]),operations:a(({record:l})=>[t(c,{type:"text",size:"small",onClick:f=>ke(l.id)},{default:a(()=>[i(d(e.$t("model.agent.columns.operations.view")),1)]),_:2},1032,["onClick"]),t(c,{type:"text",size:"small",onClick:f=>e.$router.push({name:"ModelAgentUpdate",query:{id:`${l.id}`}})},{default:a(()=>[i(d(e.$t("model.agent.columns.operations.update")),1)]),_:2},1032,["onClick"]),t(c,{type:"text",size:"small",onClick:f=>e.$router.push({name:"ModelKeyList",query:{agent_id:`${l.id}`}})},{default:a(()=>[i(d(e.$t("model.agent.columns.operations.manageKey")),1)]),_:2},1032,["onClick"]),t(Me,{content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?",onOk:f=>de({id:`${l.id}`})},{default:a(()=>[t(c,{type:"text",size:"small"},{default:a(()=>[i(d(e.$t("model.agent.columns.operations.delete")),1)]),_:1})]),_:2},1032,["onOk"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),t(Ne,{title:e.$t("menu.model.agent.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:L.value,onCancel:Ce},{default:a(()=>[t(Bt,{id:w.value},null,8,["id"])]),_:1},8,["title","visible"]),t(oe,{visible:N.value,"onUpdate:visible":o[10]||(o[10]=l=>N.value=l),title:"\u7ED1\u5B9A\u6A21\u578B","modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"920px","ok-text":"\u5173\u95ED"},{default:a(()=>[t(se,{id:w.value,action:I.value},null,8,["id","action"])]),_:1},8,["visible"]),t(oe,{visible:U.value,"onUpdate:visible":o[11]||(o[11]=l=>U.value=l),title:"\u540E\u5907\u6A21\u578B","modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"920px","ok-text":"\u5173\u95ED"},{default:a(()=>[t(se,{id:w.value,action:I.value},null,8,["id","action"])]),_:1},8,["visible"])]),_:1})])}}});const Ca=je(Ht,[["__scopeId","data-v-96ce3c81"]]);export{Ca as default};
