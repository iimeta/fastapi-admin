import{a as P,B as W,_ as j}from"./index.04742449.js";/* empty css                *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css               */import{d as J,e as _,bS as K,B as n,C as B,aH as e,aG as t,aL as s,aM as f,F as $,bu as X,aD as c,u as d,aE as v,bT as i,aJ as Y,aI as Z,aW as ee,aK as ae,aF as le,aS as te,b2 as oe,b1 as ue,bP as re,aT as se,bQ as de,bV as pe,bW as ie,bA as ne,bB as me,bO as _e,aU as ce,bi as be,b5 as fe,bI as ve,bR as ye,g as ge}from"./arco.75032696.js";import{u as qe}from"./loading.96e1cbd7.js";import{f as $e}from"./vue.ebfaaf45.js";import{q as Ve}from"./common.df364eef.js";import{f as he}from"./app.f0fb02b3.js";import{b as ke}from"./model.a6f972cf.js";import{q as we}from"./group.f3ec82f6.js";import"./chart.f8f3ffb1.js";const De={class:"container"},Ce={class:"wrapper"},Be={class:"submit-btn"},Ue={name:"AppCreate"},Fe=J({...Ue,setup(Ae){const{loading:U,setLoading:m}=qe(!1),{proxy:F}=ge(),A=$e(),V=P(),h=_([]);(async()=>{m(!0);try{const{data:l}=await ke();h.value=l.items}catch{}finally{m(!1)}})();const k=_([]);(async()=>{m(!0);try{const{data:l}=await we();k.value=l.items}catch{}finally{m(!1)}})();const w=_(),a=_({user_id:_(),name:"",models:[],is_limit_quota:!1,quota:_(),quota_expires_at:"",is_bind_group:!1,group:"",ip_whitelist:"",ip_blacklist:"",is_create_key:!0,remark:""}),L=async()=>{var u;if(!await((u=w.value)==null?void 0:u.validate())){m(!0);try{const{data:b}=await he(a.value);b.key?(navigator.clipboard.writeText(b.key),ee.success("\u65B0\u5EFA\u6210\u529F, \u5BC6\u94A5\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")):F.$message.success("\u65B0\u5EFA\u6210\u529F"),A.push({name:"AppList"})}catch{}finally{m(!1)}}},R=l=>{a.value.quota=l*5e5};return(l,u)=>{const b=W,y=ae,S=le,D=te,r=oe,I=ue,T=re,g=se,p=de,H=pe,G=ie,M=ne,N=me,q=_e,C=ce,E=be,Q=fe,x=ve,z=ye,O=K("permission");return n(),B("div",De,[e(S,{class:"container-breadcrumb"},{default:t(()=>[e(y,null,{default:t(()=>[e(b)]),_:1}),e(y,null,{default:t(()=>[s(f(l.$t("menu.app")),1)]),_:1}),e(y,null,{default:t(()=>[s(f(l.$t("menu.app.create")),1)]),_:1})]),_:1}),e(z,{loading:d(U),style:{width:"100%"}},{default:t(()=>[e(x,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:t(()=>[$("div",Ce,[e(Q,{ref_key:"formRef",ref:w,model:a.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[X((n(),c(r,{field:"user_id",label:l.$t("app.label.user_id"),rules:[{required:d(V).role==="reseller"||d(V).role==="admin",message:l.$t("app.error.user_id.required")}]},{default:t(()=>[e(D,{modelValue:a.value.user_id,"onUpdate:modelValue":u[0]||(u[0]=o=>a.value.user_id=o),placeholder:l.$t("app.placeholder.user_id"),precision:0,min:1},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])),[[O,["reseller","admin"]]]),e(r,{field:"name",label:l.$t("app.label.name"),rules:[{required:!0,message:l.$t("app.error.name.required")},{match:/^.{1,100}$/,message:l.$t("app.error.name.pattern")}]},{default:t(()=>[e(I,{modelValue:a.value.name,"onUpdate:modelValue":u[1]||(u[1]=o=>a.value.name=o),placeholder:l.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(r,{field:"models",label:l.$t("app.label.models")},{default:t(()=>[e(T,{modelValue:a.value.models,"onUpdate:modelValue":u[2]||(u[2]=o=>a.value.models=o),placeholder:l.$t("app.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:h.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"])]),_:1},8,["label"]),e(r,{field:"is_limit_quota",label:l.$t("app.label.isLimitQuota")},{default:t(()=>[e(g,{modelValue:a.value.is_limit_quota,"onUpdate:modelValue":u[3]||(u[3]=o=>a.value.is_limit_quota=o)},null,8,["modelValue"])]),_:1},8,["label"]),a.value.is_limit_quota?(n(),c(r,{key:0,field:"quota",label:l.$t("app.label.quota"),rules:[{required:!0,message:l.$t("app.error.quota.required")}]},{default:t(()=>[e(D,{modelValue:a.value.quota,"onUpdate:modelValue":u[4]||(u[4]=o=>a.value.quota=o),placeholder:l.$t("app.placeholder.quota"),precision:0,min:0,max:9999999999999,style:{width:"492px","margin-right":"10px"}},null,8,["modelValue","placeholder"]),$("div",null," $"+f(a.value.quota?d(Ve)(a.value.quota):"0"),1)]),_:1},8,["label","rules"])):v("",!0),a.value.is_limit_quota?(n(),c(r,{key:1},{default:t(()=>[e(H,{type:"button",onChange:R},{default:t(()=>[e(p,{value:1},{default:t(()=>[s(" $1 ")]),_:1}),e(p,{value:5},{default:t(()=>[s(" $5 ")]),_:1}),e(p,{value:10},{default:t(()=>[s(" $10 ")]),_:1}),e(p,{value:20},{default:t(()=>[s(" $20 ")]),_:1}),e(p,{value:50},{default:t(()=>[s(" $50 ")]),_:1}),e(p,{value:100},{default:t(()=>[s(" $100 ")]),_:1}),e(p,{value:200},{default:t(()=>[s(" $200 ")]),_:1}),e(p,{value:500},{default:t(()=>[s(" $500 ")]),_:1}),e(p,{value:1e3},{default:t(()=>[s(" $1000 ")]),_:1})]),_:1},8,["onChange"])]),_:1})):v("",!0),a.value.is_limit_quota?(n(),c(r,{key:2,field:"quota_expires_at",label:l.$t("app.label.quota_expires_at")},{default:t(()=>[e(G,{modelValue:a.value.quota_expires_at,"onUpdate:modelValue":u[5]||(u[5]=o=>a.value.quota_expires_at=o),placeholder:l.$t("app.placeholder.quota_expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":o=>d(i)(o).isBefore(d(i)().subtract(1,"day")),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>d(i)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>d(i)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>d(i)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>d(i)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>d(i)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>d(i)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>d(i)(a.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"])):v("",!0),e(r,{field:"is_bind_group",label:l.$t("app.label.is_bind_group")},{default:t(()=>[e(g,{modelValue:a.value.is_bind_group,"onUpdate:modelValue":u[6]||(u[6]=o=>a.value.is_bind_group=o)},null,8,["modelValue"])]),_:1},8,["label"]),a.value.is_bind_group?(n(),c(r,{key:3,field:"group",label:l.$t("app.label.group"),rules:[{required:!0,message:l.$t("app.error.group.required")}]},{default:t(()=>[e(N,{modelValue:a.value.group,"onUpdate:modelValue":u[7]||(u[7]=o=>a.value.group=o),placeholder:l.$t("app.placeholder.group"),scrollbar:!1,"allow-search":"","allow-clear":""},{default:t(()=>[(n(!0),B(Y,null,Z(k.value,o=>(n(),c(M,{key:o.id,value:o.id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):v("",!0),e(r,{field:"ip_whitelist",label:l.$t("app.label.ip_whitelist")},{default:t(()=>[e(q,{modelValue:a.value.ip_whitelist,"onUpdate:modelValue":u[8]||(u[8]=o=>a.value.ip_whitelist=o),placeholder:l.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(r,{field:"ip_blacklist",label:l.$t("app.label.ip_blacklist")},{default:t(()=>[e(q,{modelValue:a.value.ip_blacklist,"onUpdate:modelValue":u[9]||(u[9]=o=>a.value.ip_blacklist=o),placeholder:l.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(r,{field:"is_create_key",label:l.$t("app.label.is_create_key")},{default:t(()=>[e(g,{modelValue:a.value.is_create_key,"onUpdate:modelValue":u[10]||(u[10]=o=>a.value.is_create_key=o)},null,8,["modelValue"])]),_:1},8,["label"]),e(r,{field:"remark",label:l.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[e(q,{modelValue:a.value.remark,"onUpdate:modelValue":u[11]||(u[11]=o=>a.value.remark=o),placeholder:l.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(E,null,{default:t(()=>[$("div",Be,[e(C,{type:"secondary",onClick:u[12]||(u[12]=o=>l.$router.push({name:"AppList"}))},{default:t(()=>[s(f(l.$t("button.cancel")),1)]),_:1}),e(C,{type:"primary",onClick:L},{default:t(()=>[s(f(l.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const ta=j(Fe,[["__scopeId","data-v-c78f187e"]]);export{ta as default};
