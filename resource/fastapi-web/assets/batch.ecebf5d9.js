import{u as ue,_ as re,s as He,A as Me,k as Oe,B as je}from"./index.fbcd5073.js";/* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css              */import{d as ce,e as $,w as ee,aZ as _e,B as a,C as r,aH as t,aG as e,u as b,aD as i,aL as m,aM as n,aE as Ge,bA as Je,bB as Ke,ad as xe,bC as Ze,bD as pe,bE as Qe,r as de,c as Z,bF as We,bu as Q,aJ as W,aI as X,D as w,E as Xe,n as Ye,as as et,aK as tt,aF as at,bH as lt,bI as ot,b2 as st,bG as nt,aS as it,b1 as dt,bJ as ut,bK as rt,b5 as ct,bL as _t,ab as pt,aU as mt,bi as ft,bj as bt,bk as vt,bl as kt,b4 as yt,bM as gt,bN as ht,aV as $t,bT as wt}from"./arco.3f46b4ae.js";import{u as me}from"./loading.37fd256d.js";import{e as Ct}from"./app.6c93bd02.js";import{d as Vt,e as It,g as zt}from"./task.ab9376be.js";import{c as Y,S as St}from"./sortable.esm.078712c4.js";import{u as fe}from"./vue.dbcf9bc3.js";/* empty css                *//* empty css                */import"./chart.2cea905d.js";const Dt={style:{margin:"10px 0 30px 10px"}},Bt={key:1},Nt={key:1},Lt={key:1},Ut={key:1},At={key:1},Tt={key:1},Ft={key:1},Pt={key:1},Et={key:1},Rt={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},qt={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},Ht={key:1},Mt={key:1},Ot={key:1},jt={key:1},Gt={key:1},Jt={key:1},Kt={key:1},xt={key:1},Zt={name:"TaskBatchDetail"},Qt=ce({...Zt,props:{id:{type:String,default:""}},setup(te){const C=te,{t:E}=ue(),{loading:f,setLoading:F}=me(!0),s=$({}),{copy:p,copied:A}=fe();(async(d={id:C.id})=>{F(!0);try{const{data:y}=await Vt(d);s.value=y}catch{}finally{F(!1)}})();const g=d=>{p(d)};ee(A,()=>{A.value&&_e.success(E("success.copy"))});const L=async(d,y)=>{const{data:c}=await It({id:d,field:y});p(c.value)};return(d,y)=>{const c=Je,k=Ke,h=xe,_=Ze,D=pe,R=Qe;return a(),r("div",Dt,[t(R,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:e(()=>[t(_,{label:d.$t("common.trace_id"),span:2},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Bt,[m(n(s.value.trace_id)+" ",1),t(h,{class:"copy-btn",onClick:y[0]||(y[0]=B=>g(s.value.trace_id))})]))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.creator"),span:2},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Nt,[m(n(s.value.creator)+" ",1),t(h,{class:"copy-btn",onClick:y[1]||(y[1]=B=>L(s.value.id,"creator"))})]))]),_:1},8,["label"]),t(_,{label:d.$t("common.app_id")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Lt,n(s.value.app_id),1))]),_:1},8,["label"]),t(_,{label:d.$t("common.user_id")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Ut,n(s.value.user_id),1))]),_:1},8,["label"]),t(_,{label:d.$t("common.model")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",At,n(s.value.model),1))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.batch_id"),span:2},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Tt,[m(n(s.value.batch_id)+" ",1),t(h,{class:"copy-btn",onClick:y[2]||(y[2]=B=>g(s.value.batch_id))})]))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.input_file_id"),span:2},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Ft,[m(n(s.value.input_file_id)+" ",1),t(h,{class:"copy-btn",onClick:y[3]||(y[3]=B=>g(s.value.input_file_id))})]))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.output_file_id"),span:2},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Pt,[m(n(s.value.output_file_id)+" ",1),t(h,{class:"copy-btn",onClick:y[4]||(y[4]=B=>g(s.value.output_file_id))})]))]),_:1},8,["label"]),s.value.error_file_id?(a(),i(_,{key:0,label:d.$t("task.detail.error_file_id"),span:2},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Et,[m(n(s.value.error_file_id)+" ",1),t(h,{class:"copy-btn",onClick:y[5]||(y[5]=B=>g(s.value.error_file_id))})]))]),_:1},8,["label"])):Ge("",!0),t(_,{label:d.$t("task.detail.response_data"),span:2},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Rt,n(s.value.response_data||"-"),1))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.error"),span:2},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",qt,n(s.value.error||"-"),1))]),_:1},8,["label"]),t(_,{label:d.$t("common.status")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Ht,[s.value.status==="completed"?(a(),i(D,{key:0,color:"green"},{default:e(()=>[m(n(d.$t(`task.dict.status.${s.value.status}`)),1)]),_:1})):s.value.status==="finalizing"?(a(),i(D,{key:1,color:"green"},{default:e(()=>[m(n(d.$t(`task.dict.status.${s.value.status}`)),1)]),_:1})):s.value.status==="validating"?(a(),i(D,{key:2,color:"arcoblue"},{default:e(()=>[m(n(d.$t(`task.dict.status.${s.value.status}`)),1)]),_:1})):s.value.status==="in_progress"?(a(),i(D,{key:3,color:"orange"},{default:e(()=>[m(n(d.$t(`task.dict.status.${s.value.status}`)),1)]),_:1})):s.value.status==="failed"||!s.value.status?(a(),i(D,{key:4,color:"red"},{default:e(()=>[m(n(d.$t(`task.dict.status.${s.value.status||"failed"}`)),1)]),_:1})):(a(),i(D,{key:5,color:"gray"},{default:e(()=>[m(n(d.$t(`task.dict.status.${s.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.in_progress_at")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Mt,n(s.value.in_progress_at||"-"),1))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.finalizing_at")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Ot,n(s.value.finalizing_at||"-"),1))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.completed_at")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",jt,n(s.value.completed_at||"-"),1))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.expires_at")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Gt,n(s.value.expires_at||"-"),1))]),_:1},8,["label"]),t(_,{label:d.$t("task.detail.cancelled_at")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Jt,n(s.value.cancelled_at||s.value.cancelling_at||"-"),1))]),_:1},8,["label"]),t(_,{label:d.$t("common.created_at")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",Kt,n(s.value.created_at),1))]),_:1},8,["label"]),t(_,{label:d.$t("common.updated_at")},{default:e(()=>[b(f)?(a(),i(k,{key:0,animation:!0},{default:e(()=>[t(c,{rows:1})]),_:1})):(a(),r("span",xt,n(s.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const Wt=re(Qt,[["__scopeId","data-v-a8a232a0"]]),Xt={class:"container"},Yt={class:"action-icon"},ea={class:"action-icon"},ta={id:"tableSetting"},aa={style:{"margin-right":"4px",cursor:"move"}},la={class:"title"},oa=["onClick"],sa=["onClick"],na=["onClick"],ia={name:"TaskBatchList"},da=ce({...ia,setup(te){const C=localStorage.getItem("userRole"),E=de({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),f=()=>({user_id:$(),app_id:$(),trace_id:"",batch_id:"",file_id:"",status:$(),created_at:[]}),{loading:F,setLoading:s}=me(!0),{t:p}=ue(),A=$([]),v=$(f()),g=$([]),L=$([]),d=$("medium"),y=$(),c=$([]);C==="user"&&(async()=>{try{const{data:l}=await Ct();c.value=l.items}catch{}})();const h={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},_=de({...h}),D=Z(()=>[{name:p("size.mini"),value:"mini"},{name:p("size.small"),value:"small"},{name:p("size.medium"),value:"medium"},{name:p("size.large"),value:"large"}]),R=Z(()=>[{title:p(C==="reseller"||C==="admin"?"common.user_id":"common.app_id"),dataIndex:C==="reseller"||C==="admin"?"user_id":"app_id",slotName:C==="reseller"||C==="admin"?"user_id":"app_id",align:"center",width:75},{title:p("common.model"),dataIndex:"model",slotName:"model",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.detail.batch_id"),dataIndex:"batch_id",slotName:"batch_id",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.detail.input_file_id"),dataIndex:"input_file_id",slotName:"input_file_id",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.detail.output_file_id"),dataIndex:"output_file_id",slotName:"output_file_id",align:"center",ellipsis:!0,tooltip:!0},{title:p("common.status"),dataIndex:"status",slotName:"status",align:"center"},{title:p("common.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:p("common.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),B=Z(()=>[{label:p("task.dict.status.queued"),value:"queued"},{label:p("task.dict.status.in_progress"),value:"in_progress"},{label:p("task.dict.status.completed"),value:"completed"},{label:p("task.dict.status.failed"),value:"failed"},{label:p("task.dict.status.expired"),value:"expired"}]);C==="admin"&&B.value.push({label:p("task.dict.status.deleted"),value:"deleted"});const P=async(l={...h})=>{s(!0);try{const{data:u}=await zt(l);A.value=u.items,_.current=l.current,_.pageSize=l.pageSize,_.total=u.paging.total}catch{}finally{s(!1)}},q=()=>{P({...h,...v.value})},be=l=>{P({...h,...v.value,current:l})},ve=l=>{h.pageSize=l,P({...h,...v.value})};P();const ke=()=>{v.value=f(),q()},ye=(l,u)=>{d.value=l},ge=(l,u,z)=>{l?g.value.splice(z,0,u):g.value=L.value.filter(V=>V.dataIndex!==u.dataIndex)},ae=(l,u,z,V=!1)=>{const S=V?Y(l):l;return u>-1&&z>-1&&S.splice(u,1,S.splice(z,1,S[u]).pop()),S},he=l=>{l&&Ye(()=>{const u=document.getElementById("tableSetting");new St(u,{onEnd(z){const{oldIndex:V,newIndex:S}=z;ae(g.value,V,S),ae(L.value,V,S)}})})};ee(()=>R.value,l=>{g.value=Y(l),g.value.forEach((u,z)=>{u.checked=!0}),L.value=Y(g.value)},{deep:!0,immediate:!0});const H=$(!1),le=$(),$e=l=>{H.value=!0,le.value=l},we=()=>{H.value=!1},{copy:Ce,copied:oe}=fe(),M=async l=>{Ce(l)};return ee(oe,()=>{oe.value&&_e.success(p("success.copy"))}),(l,u)=>{const z=et,V=tt,S=at,Ve=lt,se=ot,N=st,I=nt,Ie=it,O=dt,ze=ut,j=rt,Se=ct,ne=_t,De=pt,G=mt,ie=He,Be=ft,J=bt,Ne=Me,Le=vt,Ue=kt,Ae=Oe,Te=je,Fe=yt,Pe=gt,U=pe,Ee=ht,Re=$t,qe=wt,K=We("permission");return a(),r("div",Xt,[t(S,{class:"container-breadcrumb"},{default:e(()=>[t(V,null,{default:e(()=>[t(z)]),_:1}),t(V,null,{default:e(()=>[m(n(l.$t("task.menu")),1)]),_:1}),t(V,null,{default:e(()=>[m(n(l.$t("task.menu.batch")),1)]),_:1})]),_:1}),t(qe,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:e(()=>[t(j,null,{default:e(()=>[t(I,{flex:1},{default:e(()=>[t(Se,{model:v.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(j,{gutter:16},{default:e(()=>[Q((a(),i(I,{span:8},{default:e(()=>[t(N,{field:"app_id",label:l.$t("common.app")},{default:e(()=>[t(se,{modelValue:v.value.app_id,"onUpdate:modelValue":u[0]||(u[0]=o=>v.value.app_id=o),placeholder:l.$t("common.all"),"allow-search":"","allow-clear":""},{default:e(()=>[(a(!0),r(W,null,X(c.value,o=>(a(),i(Ve,{key:o.app_id,value:o.app_id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[K,["user"]]]),Q((a(),i(I,{span:8},{default:e(()=>[t(N,{field:"user_id",label:l.$t("task.form.user_id")},{default:e(()=>[t(Ie,{modelValue:v.value.user_id,"onUpdate:modelValue":u[1]||(u[1]=o=>v.value.user_id=o),placeholder:l.$t("placeholder.user_id"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[K,["reseller","admin"]]]),t(I,{span:8},{default:e(()=>[t(N,{field:"trace_id",label:l.$t("task.form.trace_id")},{default:e(()=>[t(O,{modelValue:v.value.trace_id,"onUpdate:modelValue":u[2]||(u[2]=o=>v.value.trace_id=o),placeholder:l.$t("placeholder.trace_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(I,{span:8},{default:e(()=>[t(N,{field:"batch_id",label:l.$t("task.detail.batch_id")},{default:e(()=>[t(O,{modelValue:v.value.batch_id,"onUpdate:modelValue":u[3]||(u[3]=o=>v.value.batch_id=o),placeholder:l.$t("task.form.placeholder.batch_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(I,{span:8},{default:e(()=>[t(N,{field:"file_id",label:l.$t("task.detail.file_id")},{default:e(()=>[t(O,{modelValue:v.value.file_id,"onUpdate:modelValue":u[4]||(u[4]=o=>v.value.file_id=o),placeholder:l.$t("task.form.placeholder.file_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(I,{span:8},{default:e(()=>[t(N,{field:"status",label:l.$t("common.status")},{default:e(()=>[t(se,{modelValue:v.value.status,"onUpdate:modelValue":u[5]||(u[5]=o=>v.value.status=o),options:b(B),placeholder:l.$t("common.all"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(I,{span:8},{default:e(()=>[t(N,{field:"created_at",label:l.$t("common.created_at")},{default:e(()=>[t(ze,{modelValue:v.value.created_at,"onUpdate:modelValue":u[6]||(u[6]=o=>v.value.created_at=o),placeholder:[l.$t("common.start_time"),l.$t("common.end_time")],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(ne,{style:{height:"84px"},direction:"vertical"}),t(I,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[t(Be,{direction:"vertical",size:18},{default:e(()=>[t(G,{type:"primary",onClick:q},{icon:e(()=>[t(De)]),default:e(()=>[m(" "+n(l.$t("button.search")),1)]),_:1}),t(G,{onClick:ke},{icon:e(()=>[t(ie)]),default:e(()=>[m(" "+n(l.$t("button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),Q(t(ne,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[K,["reseller","admin"]]]),t(j,{style:{"margin-bottom":"16px"}},{default:e(()=>[t(I,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:e(()=>[t(J,{content:l.$t("action.refresh")},{default:e(()=>[w("div",{class:"action-icon",onClick:q},[t(ie,{size:"18"})])]),_:1},8,["content"]),t(Ue,{onSelect:ye},{content:e(()=>[(a(!0),r(W,null,X(b(D),o=>(a(),i(Le,{key:o.value,value:o.value,class:Xe({active:o.value===d.value})},{default:e(()=>[w("span",null,n(o.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[t(J,{content:l.$t("action.density")},{default:e(()=>[w("div",Yt,[t(Ne,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(J,{content:l.$t("action.column_setting")},{default:e(()=>[t(Pe,{trigger:"click",position:"bl",onPopupVisibleChange:he},{content:e(()=>[w("div",ta,[(a(!0),r(W,null,X(L.value,(o,T)=>(a(),r("div",{key:o.dataIndex,class:"setting"},[w("div",aa,[t(Te)]),w("div",null,[t(Fe,{modelValue:o.checked,"onUpdate:modelValue":x=>o.checked=x,onChange:x=>ge(x,o,T)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),w("div",la,n(o.title),1)]))),128))])]),default:e(()=>[w("div",ea,[t(Ae,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(Ee,{ref_key:"tableRef",ref:y,"row-key":"id",loading:b(F),pagination:_,columns:g.value,data:A.value,bordered:!1,size:d.value,"row-selection":E,onPageChange:be,onPageSizeChange:ve},{batch_id:e(({record:o})=>[w("span",{class:"copy-btn",onClick:T=>M(o.batch_id)},n(o.batch_id||"-"),9,oa)]),input_file_id:e(({record:o})=>[w("span",{class:"copy-btn",onClick:T=>M(o.input_file_id)},n(o.input_file_id||"-"),9,sa)]),output_file_id:e(({record:o})=>[w("span",{class:"copy-btn",onClick:T=>M(o.output_file_id)},n(o.output_file_id||"-"),9,na)]),status:e(({record:o})=>[o.status==="completed"?(a(),i(U,{key:0,color:"green"},{default:e(()=>[m(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="finalizing"?(a(),i(U,{key:1,color:"green"},{default:e(()=>[m(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="validating"?(a(),i(U,{key:2,color:"arcoblue"},{default:e(()=>[m(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="in_progress"?(a(),i(U,{key:3,color:"orange"},{default:e(()=>[m(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="failed"||!o.status?(a(),i(U,{key:4,color:"red"},{default:e(()=>[m(n(l.$t(`task.dict.status.${o.status||"failed"}`)),1)]),_:2},1024)):(a(),i(U,{key:5,color:"gray"},{default:e(()=>[m(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024))]),operations:e(({record:o})=>[t(G,{type:"text",size:"small",onClick:T=>$e(o.id)},{default:e(()=>[m(n(l.$t("button.detail")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),t(Re,{title:l.$t("task.menu.batch.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:H.value,onCancel:we},{default:e(()=>[t(Wt,{id:le.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const Ua=re(da,[["__scopeId","data-v-d5f5cb7d"]]);export{Ua as default};
