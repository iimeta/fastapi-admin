import{u as $e,w as we,o as ke,x as Ce,I as Ie,y as Ve,_ as ze}from"./index.6fc23535.js";/* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css                *//* empty css               *//* empty css              *//* empty css                */import{c as M,S as Se}from"./sortable.esm.2109e0e3.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              */import{d as De,r as K,e as _,c as B,w as xe,B as g,C as b,aH as e,aG as a,aL as d,aM as s,aJ as T,aI as L,aD as R,u as N,F as h,D as Ae,n as Me,aK as Be,aF as Te,b1 as Le,b2 as Ne,bA as Ue,bB as Fe,bC as Pe,bD as qe,bE as Ee,b5 as Oe,bF as je,ab as He,aU as Ke,bi as Re,a5 as Ge,bj as Je,bl as Qe,bm as We,b4 as Xe,bG as Ye,bH as Ze,bI as et,bJ as tt}from"./arco.aed15247.js";import{u as at}from"./loading.b5911e1d.js";import{s as lt,q as ot,a as nt}from"./agent.6c0f1ffb.js";import{q as st}from"./model.a03bd543.js";import"./chart.9aa6eafa.js";import"./vue.0cc5b64a.js";import"./base.87fcf6e2.js";const it={class:"container"},dt={class:"action-icon"},ut={class:"action-icon"},ct={id:"tableSetting"},rt={style:{"margin-right":"4px",cursor:"move"}},mt={class:"title"},pt={key:0,class:"circle red"},_t={key:1,class:"circle"},gt={name:"ModelAgentList"},ft=De({...gt,setup(ht){const G=K({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),U=_([]);(async()=>{try{const{data:t}=await st();U.value=t.items}catch{}})();const J=async t=>{y(!0);try{await lt(t),V()}catch{}finally{y(!1)}},F=()=>({app_id:_(),name:"",models:[],key:"",type:_(),status:_(),created_at:[]}),{loading:Q,setLoading:y}=at(!0),{t:i}=$e(),P=_([]),n=_(F()),v=_([]),k=_([]),z=_("medium"),$={current:1,pageSize:10,showTotal:!0,showPageSize:!0},C=K({...$}),W=B(()=>[{name:i("searchTable.size.mini"),value:"mini"},{name:i("searchTable.size.small"),value:"small"},{name:i("searchTable.size.medium"),value:"medium"},{name:i("searchTable.size.large"),value:"large"}]),X=B(()=>[{title:i("model.agent.columns.name"),dataIndex:"name",slotName:"name",align:"center",ellipsis:!0,tooltip:!0},{title:i("model.agent.columns.baseUrl"),dataIndex:"base_url",slotName:"base_url",align:"center",ellipsis:!0,tooltip:!0},{title:i("model.agent.columns.models"),dataIndex:"model_names",slotName:"model_names",align:"center",ellipsis:!0,tooltip:!0},{title:i("model.agent.columns.weight"),dataIndex:"weight",slotName:"weight",align:"center",width:80},{title:i("model.agent.columns.status"),dataIndex:"status",slotName:"status",align:"center",width:80},{title:i("model.agent.columns.updated_at"),dataIndex:"updated_at",slotName:"updated_at",align:"center",width:132},{title:i("model.agent.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:290}]),Y=B(()=>[{label:i("model.agent.dict.status.1"),value:1},{label:i("model.agent.dict.status.2"),value:2}]),I=async(t={...$})=>{y(!0);try{const{data:o}=await ot(t);P.value=o.items,C.current=t.current,C.pageSize=t.pageSize,C.total=o.paging.total}catch{}finally{y(!1)}},V=()=>{I({...$,...n.value})},Z=t=>{I({...$,...n.value,current:t})},ee=t=>{$.pageSize=t,I({...$,...n.value})};I();const te=()=>{n.value=F()},ae=async t=>{y(!0);try{t.status=t.status===1?2:1,await nt(t),V()}catch{}finally{y(!1)}},le=(t,o)=>{z.value=t},oe=(t,o,r)=>{t?v.value.splice(r,0,o):v.value=k.value.filter(u=>u.dataIndex!==o.dataIndex)},q=(t,o,r,u=!1)=>{const m=u?M(t):t;return o>-1&&r>-1&&m.splice(o,1,m.splice(r,1,m[o]).pop()),m},ne=t=>{t&&Me(()=>{const o=document.getElementById("tableSetting");new Se(o,{onEnd(r){const{oldIndex:u,newIndex:m}=r;q(v.value,u,m),q(k.value,u,m)}})})};return xe(()=>X.value,t=>{v.value=M(t),v.value.forEach((o,r)=>{o.checked=!0}),k.value=M(v.value)},{deep:!0,immediate:!0}),(t,o)=>{const r=we,u=Be,m=Te,S=Le,w=Ne,c=Ue,se=Fe,E=Pe,ie=qe,D=Ee,de=Oe,O=je,ue=He,f=Ke,j=ke,H=Re,ce=Ge,x=Je,re=Ce,me=Qe,pe=We,_e=Ie,ge=Ve,fe=Xe,he=Ye,ve=Ze,be=et,ye=tt;return g(),b("div",it,[e(m,{class:"container-breadcrumb"},{default:a(()=>[e(u,null,{default:a(()=>[e(r)]),_:1}),e(u,null,{default:a(()=>[d(s(t.$t("menu.agent")),1)]),_:1}),e(u,null,{default:a(()=>[d(s(t.$t("menu.model.agent.list")),1)]),_:1})]),_:1}),e(ye,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:a(()=>[e(D,null,{default:a(()=>[e(c,{flex:1},{default:a(()=>[e(de,{model:n.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(D,{gutter:16},{default:a(()=>[e(c,{span:8},{default:a(()=>[e(w,{field:"app_id",label:t.$t("model.agent.form.appId")},{default:a(()=>[e(S,{modelValue:n.value.app_id,"onUpdate:modelValue":o[0]||(o[0]=l=>n.value.app_id=l),placeholder:t.$t("model.agent.form.appId.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"name",label:t.$t("model.agent.form.name")},{default:a(()=>[e(S,{modelValue:n.value.name,"onUpdate:modelValue":o[1]||(o[1]=l=>n.value.name=l),placeholder:t.$t("model.agent.form.name.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"models",label:t.$t("model.agent.form.models")},{default:a(()=>[e(E,{modelValue:n.value.models,"onUpdate:modelValue":o[2]||(o[2]=l=>n.value.models=l),placeholder:t.$t("model.agent.form.selectDefault"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:a(()=>[(g(!0),b(T,null,L(U.value,l=>(g(),R(se,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"key",label:t.$t("model.agent.form.key")},{default:a(()=>[e(S,{modelValue:n.value.key,"onUpdate:modelValue":o[3]||(o[3]=l=>n.value.key=l),placeholder:t.$t("model.agent.form.key.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"status",label:t.$t("model.agent.form.status")},{default:a(()=>[e(E,{modelValue:n.value.status,"onUpdate:modelValue":o[4]||(o[4]=l=>n.value.status=l),options:N(Y),placeholder:t.$t("model.agent.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),e(c,{span:8},{default:a(()=>[e(w,{field:"created_at",label:t.$t("model.agent.form.created_at")},{default:a(()=>[e(ie,{modelValue:n.value.created_at,"onUpdate:modelValue":o[5]||(o[5]=l=>n.value.created_at=l),style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(O,{style:{height:"84px"},direction:"vertical"}),e(c,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(H,{direction:"vertical",size:18},{default:a(()=>[e(f,{type:"primary",onClick:V},{icon:a(()=>[e(ue)]),default:a(()=>[d(" "+s(t.$t("model.agent.form.search")),1)]),_:1}),e(f,{onClick:te},{icon:a(()=>[e(j)]),default:a(()=>[d(" "+s(t.$t("model.agent.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{style:{"margin-top":"0","margin-bottom":"16px"}}),e(D,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(c,{span:12},{default:a(()=>[e(H,null,{default:a(()=>[e(f,{type:"primary",onClick:o[6]||(o[6]=l=>t.$router.push({name:"ModelAgentCreate"}))},{icon:a(()=>[e(ce)]),default:a(()=>[d(" "+s(t.$t("model.agent.operation.create")),1)]),_:1})]),_:1})]),_:1}),e(c,{span:12,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:a(()=>[e(x,{content:t.$t("searchTable.actions.refresh")},{default:a(()=>[h("div",{class:"action-icon",onClick:V},[e(j,{size:"18"})])]),_:1},8,["content"]),e(pe,{onSelect:le},{content:a(()=>[(g(!0),b(T,null,L(N(W),l=>(g(),R(me,{key:l.value,value:l.value,class:Ae({active:l.value===z.value})},{default:a(()=>[h("span",null,s(l.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(x,{content:t.$t("searchTable.actions.density")},{default:a(()=>[h("div",dt,[e(re,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(x,{content:t.$t("searchTable.actions.columnSetting")},{default:a(()=>[e(he,{trigger:"click",position:"bl",onPopupVisibleChange:ne},{content:a(()=>[h("div",ct,[(g(!0),b(T,null,L(k.value,(l,p)=>(g(),b("div",{key:l.dataIndex,class:"setting"},[h("div",rt,[e(ge)]),h("div",null,[e(fe,{modelValue:l.checked,"onUpdate:modelValue":A=>l.checked=A,onChange:A=>oe(A,l,p)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),h("div",mt,s(l.title==="#"?"\u5E8F\u5217\u53F7":l.title),1)]))),128))])]),default:a(()=>[h("div",ut,[e(_e,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(be,{"row-key":"id",loading:N(Q),pagination:C,columns:v.value,data:P.value,bordered:!1,size:z.value,"row-selection":G,onPageChange:Z,onPageSizeChange:ee},{model_names:a(({record:l})=>{var p;return[d(s(((p=l==null?void 0:l.model_names)==null?void 0:p.join(","))||"-"),1)]}),weight:a(({record:l})=>[d(s(l.weight||"-"),1)]),status:a(({record:l})=>[l.status===2?(g(),b("span",pt)):(g(),b("span",_t)),d(" "+s(t.$t(`app.dict.status.${l.status}`)),1)]),operations:a(({record:l})=>[e(f,{type:"text",size:"small",onClick:p=>t.$router.push({name:"ModelAgentDetail",query:{id:`${l.id}`}})},{default:a(()=>[d(s(t.$t("model.agent.columns.operations.view")),1)]),_:2},1032,["onClick"]),e(f,{type:"text",size:"small",onClick:p=>t.$router.push({name:"ModelAgentUpdate",query:{id:`${l.id}`}})},{default:a(()=>[d(s(t.$t("model.agent.columns.operations.update")),1)]),_:2},1032,["onClick"]),e(f,{type:"text",size:"small",onClick:p=>t.$router.push({name:"KeyModelList",query:{agent_id:`${l.id}`}})},{default:a(()=>[d(s(t.$t("model.agent.columns.operations.manageKey")),1)]),_:2},1032,["onClick"]),e(f,{type:"text",size:"small",onClick:p=>ae({id:`${l.id}`,status:Number(`${l.status}`)})},{default:a(()=>[d(s(t.$t(`key.columns.operations.status.${l.status}`)),1)]),_:2},1032,["onClick"]),e(ve,{content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?",onOk:p=>J({id:`${l.id}`})},{default:a(()=>[e(f,{type:"text",size:"small"},{default:a(()=>[d(s(t.$t("model.agent.columns.operations.delete")),1)]),_:1})]),_:2},1032,["onOk"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"])]),_:1})])}}});const Ot=ze(ft,[["__scopeId","data-v-799af3f7"]]);export{Ot as default};
