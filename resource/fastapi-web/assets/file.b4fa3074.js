import{u as re,_ as ue,s as Oe,A as qe,k as We,B as je}from"./index.77c70861.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css              */import{d as ce,e as g,w as ee,aZ as pe,B as t,C as p,aH as e,aG as a,u as _,aD as d,aL as v,aM as i,aE as J,bA as Ge,bB as Je,ad as Ke,bC as Ze,bD as _e,bE as Qe,r as de,c as K,bF as Xe,bu as Z,aJ as Q,aI as X,D as z,E as Ye,n as ea,as as aa,aK as ta,aF as la,bH as oa,bI as sa,b2 as na,bG as ia,aS as da,b1 as ra,bJ as ua,bK as ca,b5 as pa,bL as _a,ab as ma,aU as fa,bi as ba,bj as va,bk as ka,bl as ya,b4 as ga,bM as ha,bO as $a,aV as wa,bU as Ca}from"./arco.73de4031.js";import{u as me}from"./loading.0c20cf1b.js";import{f as Va}from"./app.5111953a.js";import{b as Ia,f as Sa,c as Da}from"./task.2999f722.js";import{c as Y,S as za}from"./sortable.esm.7de80f5d.js";import{u as fe}from"./vue.e54f3d1e.js";import{f as be}from"./common.0ef165cd.js";/* empty css                *//* empty css                */import"./chart.b5ad42b0.js";const Fa={style:{margin:"10px 0 30px 10px"}},Na={key:1},La={key:1},Ba={key:1},Ua={key:1},Aa={key:1},Pa={key:1},Ta={key:1},Ea={key:1},Ra={key:1},xa={key:1},Ha={key:1},Ma={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},Oa={key:1},qa={key:1},Wa={key:1},ja={key:1},Ga={key:1},Ja={name:"TaskFileDetail"},Ka=ce({...Ja,props:{id:{type:String,default:""}},setup(ae){const $=ae,{t:E}=re(),{loading:m,setLoading:A}=me(!0),n=g({}),{copy:c,copied:U}=fe();(async(s={id:$.id})=>{A(!0);try{const{data:y}=await Ia(s);n.value=y}catch{}finally{A(!1)}})();const h=s=>{c(s)};ee(U,()=>{U.value&&pe.success(E("success.copy"))});const N=async(s,y)=>{const{data:b}=await Sa({id:s,field:y});c(b.value)},L=s=>s?s.startsWith("http://")||s.startsWith("https://")?s:window.location.origin+(s.startsWith("/")?s:`/${s}`):"";return(s,y)=>{const b=Ge,u=Je,w=Ke,k=Ze,B=_e,P=Qe;return t(),p("div",Fa,[e(P,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:a(()=>[e(k,{label:s.$t("common.trace_id"),span:2},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Na,[v(i(n.value.trace_id)+" ",1),e(w,{class:"copy-btn",onClick:y[0]||(y[0]=I=>h(n.value.trace_id))})]))]),_:1},8,["label"]),n.value.batch_trace_id?(t(),d(k,{key:0,label:s.$t("task.detail.batch_trace_id"),span:2},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",La,[v(i(n.value.batch_trace_id)+" ",1),e(w,{class:"copy-btn",onClick:y[1]||(y[1]=I=>h(n.value.batch_trace_id))})]))]),_:1},8,["label"])):J("",!0),e(k,{label:s.$t("task.detail.creator"),span:2},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Ba,[v(i(n.value.creator)+" ",1),e(w,{class:"copy-btn",onClick:y[2]||(y[2]=I=>N(n.value.id,"creator"))})]))]),_:1},8,["label"]),e(k,{label:s.$t("common.app_id")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Ua,i(n.value.app_id),1))]),_:1},8,["label"]),e(k,{label:s.$t("common.user_id")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Aa,i(n.value.user_id),1))]),_:1},8,["label"]),e(k,{label:s.$t("common.model")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Pa,i(n.value.model),1))]),_:1},8,["label"]),e(k,{label:s.$t("task.detail.purpose")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Ta,i(n.value.purpose||"-"),1))]),_:1},8,["label"]),e(k,{label:s.$t("task.detail.file_id"),span:2},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Ea,[v(i(n.value.file_id)+" ",1),e(w,{class:"copy-btn",onClick:y[3]||(y[3]=I=>h(n.value.file_id))})]))]),_:1},8,["label"]),e(k,{label:s.$t("task.detail.file_name")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Ra,i(n.value.file_name||"-"),1))]),_:1},8,["label"]),e(k,{label:s.$t("task.detail.bytes")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",xa,i(_(be)(n.value.bytes)||"-"),1))]),_:1},8,["label"]),n.value.file_url?(t(),d(k,{key:1,label:s.$t("task.detail.file_url"),span:2},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Ha,[v(i(L(n.value.file_url)||"-")+" ",1),e(w,{class:"copy-btn",onClick:y[4]||(y[4]=I=>h(L(n.value.file_url)))})]))]),_:1},8,["label"])):J("",!0),e(k,{label:s.$t("task.detail.error"),span:2},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Ma,i(n.value.error||"-"),1))]),_:1},8,["label"]),n.value.file_path?(t(),d(k,{key:2,label:s.$t("task.detail.file_path"),span:2},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Oa,i(n.value.file_path),1))]),_:1},8,["label"])):J("",!0),e(k,{label:s.$t("common.status")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",qa,[n.value.status==="processed"?(t(),d(B,{key:0,color:"green"},{default:a(()=>[v(i(s.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="uploaded"?(t(),d(B,{key:1,color:"uploaded"},{default:a(()=>[v(i(s.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="error"?(t(),d(B,{key:2,color:"red"},{default:a(()=>[v(i(s.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):(t(),d(B,{key:3,color:"gray"},{default:a(()=>[v(i(s.$t(`task.dict.status.${n.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),e(k,{label:s.$t("task.detail.expires_at")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Wa,i(n.value.expires_at||"-"),1))]),_:1},8,["label"]),e(k,{label:s.$t("common.created_at")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",ja,i(n.value.created_at),1))]),_:1},8,["label"]),e(k,{label:s.$t("common.updated_at")},{default:a(()=>[_(m)?(t(),d(u,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),p("span",Ga,i(n.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const Za=ue(Ka,[["__scopeId","data-v-9c46ba33"]]),Qa={class:"container"},Xa={class:"action-icon"},Ya={class:"action-icon"},et={id:"tableSetting"},at={style:{"margin-right":"4px",cursor:"move"}},tt={class:"title"},lt=["onClick"],ot={name:"TaskFileList"},st=ce({...ot,setup(ae){const $=localStorage.getItem("userRole"),E=de({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),m=()=>({user_id:g(),app_id:g(),trace_id:"",file_id:"",file_name:"",status:g(),created_at:[]}),{loading:A,setLoading:n}=me(!0),{t:c}=re(),U=g([]),f=g(m()),h=g([]),N=g([]),L=g("medium"),s=g(),y=g([]);$==="user"&&(async()=>{try{const{data:l}=await Va();y.value=l.items}catch{}})();const u={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},w=de({...u}),k=K(()=>[{name:c("size.mini"),value:"mini"},{name:c("size.small"),value:"small"},{name:c("size.medium"),value:"medium"},{name:c("size.large"),value:"large"}]),B=K(()=>[{title:c($==="reseller"||$==="admin"?"common.user_id":"common.app_id"),dataIndex:$==="reseller"||$==="admin"?"user_id":"app_id",slotName:$==="reseller"||$==="admin"?"user_id":"app_id",align:"center",width:75},{title:c("common.model"),dataIndex:"model",slotName:"model",align:"center"},{title:c("task.detail.purpose"),dataIndex:"purpose",slotName:"purpose",align:"center"},{title:c("task.detail.file_id"),dataIndex:"file_id",slotName:"file_id",align:"center",ellipsis:!0,tooltip:!0},{title:c("task.detail.file_name"),dataIndex:"file_name",slotName:"file_name",align:"center",ellipsis:!0,tooltip:!0},{title:c("task.detail.bytes"),dataIndex:"bytes",slotName:"bytes",align:"center"},{title:c("common.status"),dataIndex:"status",slotName:"status",align:"center"},{title:c("common.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:c("common.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),P=K(()=>[{label:c("task.dict.status.uploaded"),value:"uploaded"},{label:c("task.dict.status.processed"),value:"processed"},{label:c("task.dict.status.error"),value:"error"},{label:c("task.dict.status.expired"),value:"expired"}]);$==="admin"&&P.value.push({label:c("task.dict.status.deleted"),value:"deleted"});const I=async(l={...u})=>{n(!0);try{const{data:r}=await Da(l);U.value=r.items,w.current=l.current,w.pageSize=l.pageSize,w.total=r.paging.total}catch{}finally{n(!1)}},R=()=>{I({...u,...f.value})},ve=l=>{I({...u,...f.value,current:l})},ke=l=>{u.pageSize=l,I({...u,...f.value})};I();const ye=()=>{f.value=m(),R()},ge=(l,r)=>{L.value=l},he=(l,r,S)=>{l?h.value.splice(S,0,r):h.value=N.value.filter(C=>C.dataIndex!==r.dataIndex)},te=(l,r,S,C=!1)=>{const D=C?Y(l):l;return r>-1&&S>-1&&D.splice(r,1,D.splice(S,1,D[r]).pop()),D},$e=l=>{l&&ea(()=>{const r=document.getElementById("tableSetting");new za(r,{onEnd(S){const{oldIndex:C,newIndex:D}=S;te(h.value,C,D),te(N.value,C,D)}})})};ee(()=>B.value,l=>{h.value=Y(l),h.value.forEach((r,S)=>{r.checked=!0}),N.value=Y(h.value)},{deep:!0,immediate:!0});const x=g(!1),le=g(),we=l=>{x.value=!0,le.value=l},Ce=()=>{x.value=!1},{copy:Ve,copied:oe}=fe(),Ie=async l=>{Ve(l)};return ee(oe,()=>{oe.value&&pe.success(c("success.copy"))}),(l,r)=>{const S=aa,C=ta,D=la,Se=oa,se=sa,F=na,V=ia,De=da,H=ra,ze=ua,M=ca,Fe=pa,ne=_a,Ne=ma,O=fa,ie=Oe,Le=ba,q=va,Be=qe,Ue=ka,Ae=ya,Pe=We,Te=je,Ee=ga,Re=ha,T=_e,xe=$a,He=wa,Me=Ca,W=Xe("permission");return t(),p("div",Qa,[e(D,{class:"container-breadcrumb"},{default:a(()=>[e(C,null,{default:a(()=>[e(S)]),_:1}),e(C,null,{default:a(()=>[v(i(l.$t("task.menu")),1)]),_:1}),e(C,null,{default:a(()=>[v(i(l.$t("task.menu.file")),1)]),_:1})]),_:1}),e(Me,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:a(()=>[e(M,null,{default:a(()=>[e(V,{flex:1},{default:a(()=>[e(Fe,{model:f.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(M,{gutter:16},{default:a(()=>[Z((t(),d(V,{span:8},{default:a(()=>[e(F,{field:"app_id",label:l.$t("common.app")},{default:a(()=>[e(se,{modelValue:f.value.app_id,"onUpdate:modelValue":r[0]||(r[0]=o=>f.value.app_id=o),placeholder:l.$t("common.all"),"allow-search":"","allow-clear":""},{default:a(()=>[(t(!0),p(Q,null,X(y.value,o=>(t(),d(Se,{key:o.app_id,value:o.app_id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[W,["user"]]]),Z((t(),d(V,{span:8},{default:a(()=>[e(F,{field:"user_id",label:l.$t("task.form.user_id")},{default:a(()=>[e(De,{modelValue:f.value.user_id,"onUpdate:modelValue":r[1]||(r[1]=o=>f.value.user_id=o),placeholder:l.$t("placeholder.user_id"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[W,["reseller","admin"]]]),e(V,{span:8},{default:a(()=>[e(F,{field:"trace_id",label:l.$t("task.form.trace_id")},{default:a(()=>[e(H,{modelValue:f.value.trace_id,"onUpdate:modelValue":r[2]||(r[2]=o=>f.value.trace_id=o),placeholder:l.$t("placeholder.trace_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(V,{span:8},{default:a(()=>[e(F,{field:"file_id",label:l.$t("task.detail.file_id")},{default:a(()=>[e(H,{modelValue:f.value.file_id,"onUpdate:modelValue":r[3]||(r[3]=o=>f.value.file_id=o),placeholder:l.$t("task.form.placeholder.file_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(V,{span:8},{default:a(()=>[e(F,{field:"file_name",label:l.$t("task.detail.file_name")},{default:a(()=>[e(H,{modelValue:f.value.file_name,"onUpdate:modelValue":r[4]||(r[4]=o=>f.value.file_name=o),placeholder:l.$t("task.form.placeholder.file_name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(V,{span:8},{default:a(()=>[e(F,{field:"status",label:l.$t("common.status")},{default:a(()=>[e(se,{modelValue:f.value.status,"onUpdate:modelValue":r[5]||(r[5]=o=>f.value.status=o),options:_(P),placeholder:l.$t("common.all"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),e(V,{span:8},{default:a(()=>[e(F,{field:"created_at",label:l.$t("common.created_at")},{default:a(()=>[e(ze,{modelValue:f.value.created_at,"onUpdate:modelValue":r[6]||(r[6]=o=>f.value.created_at=o),placeholder:[l.$t("common.start_time"),l.$t("common.end_time")],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(ne,{style:{height:"84px"},direction:"vertical"}),e(V,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(Le,{direction:"vertical",size:18},{default:a(()=>[e(O,{type:"primary",onClick:R},{icon:a(()=>[e(Ne)]),default:a(()=>[v(" "+i(l.$t("button.search")),1)]),_:1}),e(O,{onClick:ye},{icon:a(()=>[e(ie)]),default:a(()=>[v(" "+i(l.$t("button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),Z(e(ne,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[W,["reseller","admin"]]]),e(M,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(V,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:a(()=>[e(q,{content:l.$t("action.refresh")},{default:a(()=>[z("div",{class:"action-icon",onClick:R},[e(ie,{size:"18"})])]),_:1},8,["content"]),e(Ae,{onSelect:ge},{content:a(()=>[(t(!0),p(Q,null,X(_(k),o=>(t(),d(Ue,{key:o.value,value:o.value,class:Ye({active:o.value===L.value})},{default:a(()=>[z("span",null,i(o.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(q,{content:l.$t("action.density")},{default:a(()=>[z("div",Xa,[e(Be,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(q,{content:l.$t("action.column_setting")},{default:a(()=>[e(Re,{trigger:"click",position:"bl",onPopupVisibleChange:$e},{content:a(()=>[z("div",et,[(t(!0),p(Q,null,X(N.value,(o,j)=>(t(),p("div",{key:o.dataIndex,class:"setting"},[z("div",at,[e(Te)]),z("div",null,[e(Ee,{modelValue:o.checked,"onUpdate:modelValue":G=>o.checked=G,onChange:G=>he(G,o,j)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),z("div",tt,i(o.title),1)]))),128))])]),default:a(()=>[z("div",Ya,[e(Pe,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(xe,{ref_key:"tableRef",ref:s,"row-key":"id",loading:_(A),pagination:w,columns:h.value,data:U.value,bordered:!1,size:L.value,"row-selection":E,onPageChange:ve,onPageSizeChange:ke},{file_id:a(({record:o})=>[z("span",{class:"copy-btn",onClick:j=>Ie(o.file_id)},i(o.file_id||"-"),9,lt)]),file_name:a(({record:o})=>[v(i(o.file_name||"-"),1)]),bytes:a(({record:o})=>[v(i(_(be)(o.bytes)||"-"),1)]),status:a(({record:o})=>[o.status==="processed"?(t(),d(T,{key:0,color:"green"},{default:a(()=>[v(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="uploaded"?(t(),d(T,{key:1,color:"uploaded"},{default:a(()=>[v(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="error"?(t(),d(T,{key:2,color:"red"},{default:a(()=>[v(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):(t(),d(T,{key:3,color:"gray"},{default:a(()=>[v(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024))]),operations:a(({record:o})=>[e(O,{type:"text",size:"small",onClick:j=>we(o.id)},{default:a(()=>[v(i(l.$t("button.detail")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),e(He,{title:l.$t("task.menu.file.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:x.value,onCancel:Ce},{default:a(()=>[e(Za,{id:le.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const Lt=ue(st,[["__scopeId","data-v-a5245a7f"]]);export{Lt as default};
