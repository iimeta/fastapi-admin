import{_ as q,z as E}from"./index.118dd0ea.js";import{u as S}from"./loading.b0aa7954.js";/* empty css                */import{d as C,e as h,B as v,aD as k,aG as t,aH as a,aL as f,aM as b,b2 as O,b3 as U,bL as R,aV as A,b6 as B,C as I,aJ as G,aI as H,aE as N,bC as J,bD as P,aU as Q,aT as W,bj as T,bA as X,F as Y,bt as Z,u as x,aK as ee,aF as ae,bM as te,bN as le,bK as oe,bO as se}from"./arco.a11b8b88.js";import{e as F,f as ne}from"./app.400f4820.js";/* empty css               *//* empty css               *//* empty css                */import{h as M}from"./vue.e9a5701d.js";/* empty css               *//* empty css              *//* empty css              *//* empty css               */import{q as pe}from"./model.8ec249e7.js";/* empty css               */import"./chart.87d6227d.js";const ue=C({__name:"base-info",emits:["changeStep"],setup(y,{emit:c}){const{setLoading:d}=S(!1),n=M(),m=h(),r=h({id:"",name:"",remark:"",status:1});(async(p={id:n.query.id})=>{d(!0);try{const{data:s}=await F(p);r.value.id=s.id,r.value.name=s.name,r.value.remark=s.remark,r.value.status=s.status}catch{}finally{d(!1)}})();const e=async()=>{var s;await((s=m.value)==null?void 0:s.validate())||c("changeStep","forward",{...r.value})};return(p,s)=>{const w=O,l=U,o=R,$=A,u=B;return v(),k(u,{ref_key:"formRef",ref:m,model:r.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[a(l,{field:"name",label:p.$t("app.label.name"),rules:[{required:!0,message:p.$t("app.error.name.required")},{match:/^.{1,20}$/,message:p.$t("app.error.name.pattern")}]},{default:t(()=>[a(w,{modelValue:r.value.name,"onUpdate:modelValue":s[0]||(s[0]=_=>r.value.name=_),placeholder:p.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(l,{field:"remark",label:p.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[a(o,{modelValue:r.value.remark,"onUpdate:modelValue":s[1]||(s[1]=_=>r.value.remark=_),placeholder:p.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(l,null,{default:t(()=>[a($,{type:"primary",onClick:e},{default:t(()=>[f(b(p.$t("app.button.next")),1)]),_:1})]),_:1})]),_:1},8,["model"])}}});const re=q(ue,[["__scopeId","data-v-ed2f66ae"]]),ie=C({__name:"advanced",emits:["changeStep"],setup(y,{emit:c}){const{setLoading:d}=S(!0),n=M(),m=h([]);(async()=>{d(!0);try{const{data:l}=await pe();m.value=l.items}catch{}finally{d(!1)}})();const g=h(),e=h({models:[],is_limit_quota:!1,quota:h(),ip_whitelist:"",ip_blacklist:""});(async(l={id:n.query.id})=>{var o,$;d(!0);try{const{data:u}=await F(l);e.value.models=u.models,e.value.is_limit_quota=u.is_limit_quota,e.value.quota=u.quota,e.value.ip_whitelist=((o=u==null?void 0:u.ip_whitelist)==null?void 0:o.join(`
`))||"",e.value.ip_blacklist=(($=u==null?void 0:u.ip_blacklist)==null?void 0:$.join(`
`))||""}catch{}finally{d(!1)}})();const s=async()=>{var o;await((o=g.value)==null?void 0:o.validate())||c("changeStep","submit",{...e.value})},w=()=>{c("changeStep","backward")};return(l,o)=>{const $=J,u=P,_=U,V=Q,z=W,L=R,D=A,j=T,K=B;return v(),k(K,{ref_key:"formRef",ref:g,model:e.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[a(_,{field:"models",label:l.$t("app.label.models"),rules:[{required:!1}]},{default:t(()=>[a(u,{modelValue:e.value.models,"onUpdate:modelValue":o[0]||(o[0]=i=>e.value.models=i),placeholder:l.$t("app.placeholder.models"),"max-tag-count":3,multiple:"","allow-clear":""},{default:t(()=>[(v(!0),I(G,null,H(m.value,i=>(v(),k($,{key:i.id,value:i.id,label:i.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(_,{field:"is_limit_quota",label:l.$t("app.label.isLimitQuota")},{default:t(()=>[a(V,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":o[1]||(o[1]=i=>e.value.is_limit_quota=i)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(v(),k(_,{key:0,field:"quota",label:l.$t("app.label.quota"),rules:[{required:!0,message:l.$t("app.error.quota.required")}]},{default:t(()=>[a(z,{modelValue:e.value.quota,"onUpdate:modelValue":o[2]||(o[2]=i=>e.value.quota=i),precision:0,min:1,placeholder:l.$t("app.placeholder.quota")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):N("",!0),a(_,{field:"ip_whitelist",label:l.$t("app.label.ip_whitelist"),rules:[{required:!1}]},{default:t(()=>[a(L,{modelValue:e.value.ip_whitelist,"onUpdate:modelValue":o[3]||(o[3]=i=>e.value.ip_whitelist=i),placeholder:l.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(_,{field:"ip_blacklist",label:l.$t("app.label.ip_blacklist"),rules:[{required:!1}]},{default:t(()=>[a(L,{modelValue:e.value.ip_blacklist,"onUpdate:modelValue":o[4]||(o[4]=i=>e.value.ip_blacklist=i),placeholder:l.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(_,null,{default:t(()=>[a(j,null,{default:t(()=>[a(D,{type:"secondary",onClick:w},{default:t(()=>[f(b(l.$t("model.button.prev")),1)]),_:1}),a(D,{type:"primary",onClick:s},{default:t(()=>[f(b(l.$t("model.button.next")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])}}});const de=q(ie,[["__scopeId","data-v-3a5afcd0"]]);const me={},_e={class:"success-wrap"};function ce(y,c){const d=X,n=A,m=T;return v(),I("div",_e,[a(d,{status:"success",title:y.$t("app.success.title"),subtitle:y.$t("app.success.update.subTitle")},null,8,["title","subtitle"]),a(m,{size:16},{default:t(()=>[a(n,{key:"finish",type:"secondary",onClick:c[0]||(c[0]=r=>y.$router.push({name:"AppList"}))},{default:t(()=>[f(b(y.$t("app.button.return")),1)]),_:1}),a(n,{key:"again",type:"primary",onClick:c[1]||(c[1]=r=>y.$router.push({name:"AppDetail",query:{id:`${y.$route.query.id}`}}))},{default:t(()=>[f(b(y.$t("app.button.view")),1)]),_:1})]),_:1})])}const fe=q(me,[["render",ce],["__scopeId","data-v-04d88f29"]]),be={class:"container"},ve={class:"wrapper"},ye={name:"AppUpdate"},$e=C({...ye,setup(y){const{loading:c,setLoading:d}=S(!1),n=h(1),m=h({}),r=async()=>{d(!0);try{await ne(m.value),n.value=3,m.value={}}catch{}finally{d(!1)}},g=(e,p)=>{if(typeof e=="number"){n.value=e;return}if(e==="forward"||e==="submit"){if(m.value={...m.value,...p},e==="submit"){r();return}n.value+=1}else e==="backward"&&(n.value-=1)};return(e,p)=>{const s=E,w=ee,l=ae,o=te,$=le,u=oe,_=se;return v(),I("div",be,[a(l,{class:"container-breadcrumb"},{default:t(()=>[a(w,null,{default:t(()=>[a(s)]),_:1}),a(w,null,{default:t(()=>[f(b(e.$t("menu.app")),1)]),_:1}),a(w,null,{default:t(()=>[f(b(e.$t("menu.app.update")),1)]),_:1})]),_:1}),a(_,{loading:x(c),style:{width:"100%"}},{default:t(()=>[a(u,{class:"general-card",bordered:!1},{title:t(()=>[f(b(e.$t("app.title.update")),1)]),default:t(()=>[Y("div",ve,[a($,{current:n.value,"onUpdate:current":p[0]||(p[0]=V=>n.value=V),style:{width:"660px"},"line-less":"",class:"steps"},{default:t(()=>[a(o,{description:e.$t("app.subTitle.baseInfo")},{default:t(()=>[f(b(e.$t("app.title.baseInfo")),1)]),_:1},8,["description"]),a(o,{description:e.$t("app.subTitle.advanced")},{default:t(()=>[f(b(e.$t("app.title.advanced")),1)]),_:1},8,["description"]),a(o,{description:e.$t("app.subTitle.update.finish")},{default:t(()=>[f(b(e.$t("app.title.update.finish")),1)]),_:1},8,["description"])]),_:1},8,["current"]),(v(),k(Z,null,[n.value===1?(v(),k(re,{key:0,onChangeStep:g})):n.value===2?(v(),k(de,{key:1,onChangeStep:g})):n.value===3?(v(),k(fe,{key:2,onChangeStep:g})):N("",!0)],1024))])]),_:1})]),_:1},8,["loading"])])}}});const Te=q($e,[["__scopeId","data-v-87c01ba8"]]);export{Te as default};
