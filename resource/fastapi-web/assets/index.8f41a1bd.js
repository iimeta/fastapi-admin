import{u as de,b as ne,H as se,_ as ie}from"./index.1e796edc.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                */import{d as me,e as p,B as d,C as y,aH as l,aG as o,aL as i,aM as f,D as P,aD as m,aE as c,aJ as k,aI as q,u as _,bu as fe,bv as _e,aZ as pe,aK as ce,aF as ge,bL as ve,b1 as be,b2 as we,aS as ye,bP as he,aT as Ve,bT as $e,bQ as ke,bi as qe,bH as Ue,bI as Ce,bR as De,b4 as Le,a5 as Se,aU as Me,a4 as Ie,bS as He,b5 as Be,bU as Te,bV as Ge}from"./arco.73de4031.js";import{u as Qe}from"./loading.0c20cf1b.js";import{p as K,d as Re,a as w}from"./common.0ef165cd.js";import{f as Ae}from"./vue.e54f3d1e.js";import{g as Fe}from"./group.e2a79774.js";import{q as Ne,a as Pe}from"./model.e8b55de3.js";import{q as Ke}from"./model_agent.63f4d1de.js";import{Q as s}from"./quota.782f590b.js";import"./chart.b5ad42b0.js";const ze={class:"container"},Ee={class:"wrapper"},je={class:"submit-btn"},Je={name:"GroupCreate"},Oe=me({...Je,setup(Ze){const{t:z}=de(),{loading:E,setLoading:S}=Qe(!1),j=Ae(),M=ne(),U=p([]);(async()=>{try{const{data:a}=await Ne();U.value=a.items}catch{}})();const I=p([]);(async()=>{try{const{data:a}=await Pe();I.value=a.items}catch{}})();const H=p([]);(async()=>{try{const{data:a}=await Ke();H.value=a.items}catch{}})();const B=p(),e=p({name:"",discount:p(),models:[],is_default:!1,is_public:!0,weight:p(),expires_at:"",remark:"",is_enable_model_agent:!1,lb_strategy:"1",model_agents:[],is_limit_quota:!1,quota:p(),is_enable_forward:!1,forward_config:{forward_rule:"1",match_rule:["2"],target_model:"",decision_model:"",keywords:[],target_models:[],content_length:p(),used_quota:p()}}),J=async()=>{var u;if(!await((u=B.value)==null?void 0:u.validate())){S(!0);try{await Fe(e.value).then(()=>{pe.success(z("success.create")),j.push({name:"GroupList"})})}catch{}finally{S(!1)}}},O=a=>{e.value.quota=a},Z=a=>{e.value.forward_config.used_quota=a},T=()=>{e.value.is_enable_forward?e.value.forward_config.forward_rule==="2"?(e.value.forward_config.keywords=[""],e.value.forward_config.target_models=[""],e.value.forward_config.target_model="",e.value.forward_config.content_length=p()):(e.value.forward_config.forward_rule==="1"||e.value.forward_config.forward_rule==="3"||e.value.forward_config.forward_rule==="4")&&(e.value.forward_config.keywords=[],e.value.forward_config.target_models=[]):(e.value.forward_config.target_model="",e.value.forward_config.keywords=[],e.value.forward_config.target_models=[],e.value.forward_config.content_length=p())},W=()=>{e.value.forward_config.keywords.push(""),e.value.forward_config.target_models.push("")},X=a=>{e.value.forward_config.keywords.length>1&&(e.value.forward_config.keywords.splice(a,1),e.value.forward_config.target_models.splice(a,1))};return(a,u)=>{const G=se,D=ce,Y=ge,Q=ve,R=be,t=we,h=ye,x=he,V=Ve,ee=$e,n=ke,L=qe,v=Ue,$=Ce,A=De,F=Le,le=Se,C=Me,ae=Ie,oe=He,re=Be,ue=Te,te=Ge;return d(),y("div",ze,[l(Y,{class:"container-breadcrumb"},{default:o(()=>[l(D,null,{default:o(()=>[l(G)]),_:1}),l(D,null,{default:o(()=>[i(f(a.$t("group.menu")),1)]),_:1}),l(D,null,{default:o(()=>[i(f(a.$t("group.menu.create")),1)]),_:1})]),_:1}),l(te,{loading:_(E),style:{width:"100%"}},{default:o(()=>[l(ue,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:o(()=>[P("div",Ee,[l(re,{ref_key:"formRef",ref:B,model:e.value,class:"form","label-col-props":{span:4},"wrapper-col-props":{span:18}},{default:o(()=>{var N;return[l(Q,{orientation:"left"},{default:o(()=>[i(f(a.$t("common.title.base_info")),1)]),_:1}),l(t,{field:"name",label:a.$t("group.label.name"),rules:[{required:!0,message:a.$t("group.placeholder.name")}]},{default:o(()=>[l(R,{modelValue:e.value.name,"onUpdate:modelValue":u[0]||(u[0]=r=>e.value.name=r),placeholder:a.$t("group.placeholder.name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),l(t,{field:"discount",label:a.$t("common.discount"),rules:[{required:!0,message:a.$t("placeholder.discount")}]},{default:o(()=>[l(h,{modelValue:e.value.discount,"onUpdate:modelValue":u[1]||(u[1]=r=>e.value.discount=r),placeholder:a.$t("placeholder.discount"),min:.01,max:9999999999999,"allow-clear":""},{append:o(()=>[i(" % ")]),_:1},8,["modelValue","placeholder","min"])]),_:1},8,["label","rules"]),e.value.is_default?c("",!0):(d(),m(t,{key:0,field:"weight",label:a.$t("group.label.weight"),rules:[{required:!0,message:a.$t("group.error.required.weight")}]},{default:o(()=>[l(h,{modelValue:e.value.weight,"onUpdate:modelValue":u[2]||(u[2]=r=>e.value.weight=r),placeholder:a.$t("group.placeholder.weight"),precision:0,min:1,max:99999,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])),l(t,{field:"models",label:a.$t("common.model"),rules:[{required:!0,message:a.$t("placeholder.model")}]},{default:o(()=>[l(x,{modelValue:e.value.models,"onUpdate:modelValue":u[3]||(u[3]=r=>e.value.models=r),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:I.value,placeholder:a.$t("placeholder.model"),"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","data","placeholder"])]),_:1},8,["label","rules"]),l(t,{field:"is_public",label:a.$t("common.public"),rules:[{required:!0}]},{default:o(()=>[l(V,{modelValue:e.value.is_public,"onUpdate:modelValue":u[4]||(u[4]=r=>e.value.is_public=r)},null,8,["modelValue"])]),_:1},8,["label"]),l(t,{field:"is_default",label:a.$t("common.default")},{default:o(()=>[l(V,{modelValue:e.value.is_default,"onUpdate:modelValue":u[5]||(u[5]=r=>e.value.is_default=r)},null,8,["modelValue"])]),_:1},8,["label"]),l(t,{field:"remark",label:a.$t("group.label.remark"),rules:[{required:!1}]},{default:o(()=>[l(ee,{modelValue:e.value.remark,"onUpdate:modelValue":u[6]||(u[6]=r=>e.value.remark=r),placeholder:a.$t("group.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(Q,{orientation:"left"},{default:o(()=>[i(f(a.$t("common.title.advanced")),1)]),_:1}),l(t,{field:"is_enable_model_agent",label:a.$t("common.enable_model_agent")},{default:o(()=>[l(V,{modelValue:e.value.is_enable_model_agent,"onUpdate:modelValue":u[7]||(u[7]=r=>e.value.is_enable_model_agent=r)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_enable_model_agent?(d(),m(t,{key:1,field:"lb_strategy",label:a.$t("common.lb_strategy"),rules:[{required:!0}]},{default:o(()=>[l(L,{size:"large"},{default:o(()=>[l(n,{modelValue:e.value.lb_strategy,"onUpdate:modelValue":u[8]||(u[8]=r=>e.value.lb_strategy=r),value:"1","default-checked":!0},{default:o(()=>[i(f(a.$t("dict.lb_strategy.1")),1)]),_:1},8,["modelValue"]),l(n,{modelValue:e.value.lb_strategy,"onUpdate:modelValue":u[9]||(u[9]=r=>e.value.lb_strategy=r),value:"2"},{default:o(()=>[i(f(a.$t("dict.lb_strategy.2")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"])):c("",!0),e.value.is_enable_model_agent?(d(),m(t,{key:2,field:"model_agents",label:a.$t("common.model_agents"),rules:[{required:!0,message:a.$t("placeholder.model_agents")}]},{default:o(()=>[l($,{modelValue:e.value.model_agents,"onUpdate:modelValue":u[10]||(u[10]=r=>e.value.model_agents=r),placeholder:a.$t("placeholder.model_agents"),"max-tag-count":3,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:o(()=>[(d(!0),y(k,null,q(H.value,r=>(d(),m(v,{key:r.id,value:r.id,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):c("",!0),l(t,{field:"is_limit_quota",label:a.$t("common.limit_quota")},{default:o(()=>[l(V,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":u[11]||(u[11]=r=>e.value.is_limit_quota=r)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(d(),m(t,{key:3,field:"quota",label:a.$t("common.quota"),rules:[{required:!0,message:a.$t("placeholder.quota")}]},{default:o(()=>[l(h,{modelValue:e.value.quota,"onUpdate:modelValue":u[12]||(u[12]=r=>e.value.quota=r),placeholder:a.$t("placeholder.quota"),min:1e-6,max:9999999999999,parser:_(K),"allow-clear":""},{prefix:o(()=>[i(f(_(M).getCurrencySymbol),1)]),_:1},8,["modelValue","placeholder","min","parser"])]),_:1},8,["label","rules"])):c("",!0),e.value.is_limit_quota?(d(),m(t,{key:4},{default:o(()=>[l(A,{type:"button",onChange:O},{default:o(()=>[l(n,{value:100},{default:o(()=>[l(s,{"model-value":100})]),_:1}),l(n,{value:500},{default:o(()=>[l(s,{"model-value":500})]),_:1}),l(n,{value:1e3},{default:o(()=>[l(s,{"model-value":1e3})]),_:1}),l(n,{value:5e3},{default:o(()=>[l(s,{"model-value":5e3})]),_:1}),l(n,{value:1e4},{default:o(()=>[l(s,{"model-value":1e4})]),_:1}),l(n,{value:5e4},{default:o(()=>[l(s,{"model-value":5e4})]),_:1}),l(n,{value:1e5},{default:o(()=>[l(s,{"model-value":1e5})]),_:1}),l(n,{value:5e5},{default:o(()=>[l(s,{"model-value":5e5})]),_:1}),l(n,{value:1e6,style:{padding:"0 1px"}},{default:o(()=>[l(s,{"model-value":1e6})]),_:1})]),_:1})]),_:1})):c("",!0),l(t,{field:"model_forward",label:a.$t("group.label.is_enable_forward")},{default:o(()=>[l(V,{modelValue:e.value.is_enable_forward,"onUpdate:modelValue":u[13]||(u[13]=r=>e.value.is_enable_forward=r),onChange:T},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_enable_forward?(d(),m(t,{key:5,field:"forward_config.forward_rule",label:a.$t("group.label.forward_rule"),rules:[{required:!0,message:a.$t("group.placeholder.forward_rule")}]},{default:o(()=>[l($,{modelValue:e.value.forward_config.forward_rule,"onUpdate:modelValue":u[14]||(u[14]=r=>e.value.forward_config.forward_rule=r),placeholder:a.$t("group.placeholder.forward_rule"),scrollbar:!1,onChange:T},{default:o(()=>[l(v,{value:"1"},{default:o(()=>[i(f(a.$t("dict.forward_rule.1")),1)]),_:1}),l(v,{value:"2"},{default:o(()=>[i(f(a.$t("dict.forward_rule.2")),1)]),_:1}),l(v,{value:"3"},{default:o(()=>[i(f(a.$t("dict.forward_rule.3")),1)]),_:1}),l(v,{value:"4"},{default:o(()=>[i(f(a.$t("dict.forward_rule.4")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):c("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="3"?(d(),m(t,{key:6,field:"forward_config.content_length",label:a.$t("group.label.content_length"),rules:[{required:!0,message:a.$t("group.error.required.content_length")}]},{default:o(()=>[l(h,{modelValue:e.value.forward_config.content_length,"onUpdate:modelValue":u[15]||(u[15]=r=>e.value.forward_config.content_length=r),placeholder:a.$t("group.placeholder.content_length"),precision:0,min:1,max:9999999999999,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):c("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="4"?(d(),m(t,{key:7,field:"forward_config.used_quota",label:a.$t("common.quota"),rules:[{required:!0,message:a.$t("placeholder.quota")}]},{default:o(()=>[l(h,{modelValue:e.value.forward_config.used_quota,"onUpdate:modelValue":u[16]||(u[16]=r=>e.value.forward_config.used_quota=r),placeholder:a.$t("placeholder.quota"),min:1e-6,max:9999999999999,parser:_(K),"allow-clear":""},{prefix:o(()=>[i(f(_(M).getCurrencySymbol),1)]),_:1},8,["modelValue","placeholder","min","parser"])]),_:1},8,["label","rules"])):c("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="4"?(d(),m(t,{key:8},{default:o(()=>[l(A,{type:"button",onChange:Z},{default:o(()=>[l(n,{value:100},{default:o(()=>[l(s,{"model-value":100})]),_:1}),l(n,{value:500},{default:o(()=>[l(s,{"model-value":500})]),_:1}),l(n,{value:1e3},{default:o(()=>[l(s,{"model-value":1e3})]),_:1}),l(n,{value:5e3},{default:o(()=>[l(s,{"model-value":5e3})]),_:1}),l(n,{value:1e4},{default:o(()=>[l(s,{"model-value":1e4})]),_:1}),l(n,{value:5e4},{default:o(()=>[l(s,{"model-value":5e4})]),_:1}),l(n,{value:1e5},{default:o(()=>[l(s,{"model-value":1e5})]),_:1}),l(n,{value:5e5},{default:o(()=>[l(s,{"model-value":5e5})]),_:1}),l(n,{value:1e6,style:{padding:"0 1px"}},{default:o(()=>[l(s,{"model-value":1e6})]),_:1})]),_:1})]),_:1})):c("",!0),e.value.is_enable_forward&&(e.value.forward_config.forward_rule==="1"||e.value.forward_config.forward_rule==="3"||e.value.forward_config.forward_rule==="4")?(d(),m(t,{key:9,field:"forward_config.target_model",label:a.$t("group.label.target_model"),rules:[{required:!0,message:a.$t("group.placeholder.target_model")}]},{default:o(()=>[l($,{modelValue:e.value.forward_config.target_model,"onUpdate:modelValue":u[17]||(u[17]=r=>e.value.forward_config.target_model=r),placeholder:a.$t("group.placeholder.target_model"),scrollbar:!1,"allow-search":""},{default:o(()=>[(d(!0),y(k,null,q(U.value,r=>(d(),m(v,{key:r.id,value:r.id,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):c("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"?(d(),m(t,{key:10,field:"forward_config.match_rule",label:a.$t("group.label.match_rule"),rules:[{required:!0,message:a.$t("group.error.required.match_rule")}]},{default:o(()=>[l(L,{size:"large"},{default:o(()=>[l(F,{modelValue:e.value.forward_config.match_rule,"onUpdate:modelValue":u[18]||(u[18]=r=>e.value.forward_config.match_rule=r),value:"1","default-checked":!0},{default:o(()=>[i(f(a.$t("dict.match_rule.1")),1)]),_:1},8,["modelValue"]),l(F,{modelValue:e.value.forward_config.match_rule,"onUpdate:modelValue":u[19]||(u[19]=r=>e.value.forward_config.match_rule=r),value:"2"},{default:o(()=>[i(f(a.$t("dict.match_rule.2")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"])):c("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"&&e.value.forward_config.match_rule.includes("1")?(d(),m(t,{key:11,field:"forward_config.decision_model",label:a.$t("group.label.decision_model"),rules:[{required:!0,message:a.$t("group.placeholder.decision_model")}]},{default:o(()=>[l($,{modelValue:e.value.forward_config.decision_model,"onUpdate:modelValue":u[20]||(u[20]=r=>e.value.forward_config.decision_model=r),placeholder:a.$t("group.placeholder.decision_model"),scrollbar:!1,"allow-search":""},{default:o(()=>[(d(!0),y(k,null,q(U.value,r=>(d(),m(v,{key:r.id,value:r.id,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):c("",!0),(d(!0),y(k,null,q((N=e.value.forward_config)==null?void 0:N.keywords,(r,g)=>fe((d(),m(t,{key:g,field:`forward_config.keywords[${g}]`&&`forward_config.target_models[${g}]`,label:`${g+1}. `+a.$t("group.label.keywords"),rules:[{required:!0,message:a.$t("group.error.required.keywords_target_model")}]},{default:o(()=>[l(R,{modelValue:e.value.forward_config.keywords[g],"onUpdate:modelValue":b=>e.value.forward_config.keywords[g]=b,placeholder:a.$t("group.placeholder.keywords"),style:{width:"46%","margin-right":"5px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),l($,{modelValue:e.value.forward_config.target_models[g],"onUpdate:modelValue":b=>e.value.forward_config.target_models[g]=b,placeholder:a.$t("group.placeholder.target_model"),scrollbar:!1,style:{width:"40%","margin-right":"4px"},"allow-search":""},{default:o(()=>[(d(!0),y(k,null,q(U.value,b=>(d(),m(v,{key:b.id,value:b.id,label:b.name},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),l(C,{type:"primary",shape:"circle",style:{margin:"0 10px 0 10px"},onClick:W},{default:o(()=>[l(le)]),_:1}),l(C,{type:"secondary",shape:"circle",onClick:b=>X(g)},{default:o(()=>[l(ae)]),_:2},1032,["onClick"])]),_:2},1032,["field","label","rules"])),[[_e,e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"]])),128)),l(t,{field:"expires_at",label:a.$t("common.expires_at")},{default:o(()=>[l(oe,{modelValue:e.value.expires_at,"onUpdate:modelValue":u[21]||(u[21]=r=>e.value.expires_at=r),placeholder:a.$t("placeholder.expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":_(Re),"allow-clear":"",style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>_(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>_(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>_(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>_(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>_(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>_(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>_(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"]),l(L,null,{default:o(()=>[P("div",je,[l(C,{type:"secondary",onClick:u[22]||(u[22]=r=>a.$router.push({name:"GroupList"}))},{default:o(()=>[i(f(a.$t("button.cancel")),1)]),_:1}),l(C,{type:"primary",onClick:J},{default:o(()=>[i(f(a.$t("button.submit")),1)]),_:1})])]),_:1})]}),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const Vl=ie(Oe,[["__scopeId","data-v-3b965e5c"]]);export{Vl as default};
