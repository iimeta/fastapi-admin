import{u as O,E as X,_ as Z}from"./index.3c1965ee.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                */import{d as j,e as d,B as c,C as f,aH as o,aG as s,aL as i,aM as m,D as q,aJ as B,aI as D,aD as I,u as Q,aZ as W,aK as Y,aF as x,bL as ee,bH as ae,bI as le,b2 as oe,b1 as te,aS as se,bT as re,bP as ne,aT as de,aU as ue,bi as ie,b5 as me,bU as pe,bV as ce}from"./arco.73de4031.js";import{u as _e}from"./loading.0c20cf1b.js";import{f as ve,h as fe}from"./vue.e54f3d1e.js";import{e as ye,q as be}from"./key.4d748a65.js";import{q as ge}from"./provider.27277c6b.js";import{a as ke}from"./model.26d54a46.js";import{q as he}from"./model_agent.cf129096.js";import"./chart.b5ad42b0.js";const we={class:"container"},Ve={class:"wrapper"},$e={class:"submit-btn"},Le={name:"KeyUpdate"},Me=j({...Le,setup(Ue){const{loading:K,setLoading:_}=_e(!1),S=ve(),T=fe(),{t:n}=O(),p=d([]),y=new Map,C=async()=>{try{const{data:a}=await ge();p.value=a.items;for(let e=0;e<p.value.length;e+=1)y.set(p.value[e].id,p.value[e])}catch{}},u=d(n("key.placeholder.update.key")),b=async()=>{switch(y.get(l.value.provider_id).code){case"Baidu":u.value=n("key.placeholder.update.key.baidu");break;case"Xfyun":u.value=n("key.placeholder.update.key.xfyun");break;case"DeepSeek-Baidu":u.value=n("key.placeholder.update.key.deepseek.baidu");break;case"VolcEngine":u.value=n("key.placeholder.update.key.volcengine");break;default:u.value=n("key.placeholder.update.key")}},g=d([]);(async()=>{try{const{data:a}=await ke();g.value=a.items}catch{}})();const k=d([]);(async()=>{try{const{data:a}=await he();k.value=a.items}catch{}})();const h=d(),l=d({id:"",provider_id:"",key:"",weight:d(20),remark:"",status:1,models:[],model_agents:[],is_agents_only:!1,is_never_disable:!1}),R=async()=>{var e;if(!await((e=h.value)==null?void 0:e.validate())){_(!0);try{await ye(l.value).then(()=>{W.success(n("success.update")),S.push({name:"ModelKeyList"})})}catch{}finally{_(!1)}}};return(async(a={id:T.query.id})=>{_(!0);try{C();const{data:e}=await be(a);l.value.id=e.id,l.value.provider_id=e.provider_id,l.value.key=e.key,l.value.weight=e.weight,l.value.remark=e.remark,l.value.status=e.status,l.value.models=e.models,l.value.model_agents=e.model_agents,l.value.is_agents_only=e.is_agents_only,l.value.is_never_disable=e.is_never_disable,b()}catch{}finally{_(!1)}})(),(a,e)=>{const w=X,v=Y,F=x,V=ee,$=ae,L=le,r=oe,P=te,A=se,N=re,E=ne,M=de,U=ue,H=ie,z=me,G=pe,J=ce;return c(),f("div",we,[o(F,{class:"container-breadcrumb"},{default:s(()=>[o(v,null,{default:s(()=>[o(w)]),_:1}),o(v,null,{default:s(()=>[i(m(a.$t("key.menu")),1)]),_:1}),o(v,null,{default:s(()=>[i(m(a.$t("key.menu.update")),1)]),_:1})]),_:1}),o(J,{loading:Q(K),style:{width:"100%"}},{default:s(()=>[o(G,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:s(()=>[q("div",Ve,[o(z,{ref_key:"formRef",ref:h,model:l.value,class:"form","label-col-props":{span:4},"wrapper-col-props":{span:18}},{default:s(()=>[o(V,{orientation:"left"},{default:s(()=>[i(m(a.$t("common.title.base_info")),1)]),_:1}),o(r,{field:"provider_id",label:a.$t("common.provider"),rules:[{required:!0,message:a.$t("placeholder.provider")}]},{default:s(()=>[o(L,{modelValue:l.value.provider_id,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.provider_id=t),placeholder:a.$t("placeholder.provider"),scrollbar:!1,"allow-search":"",onChange:b},{default:s(()=>[(c(!0),f(B,null,D(p.value,t=>(c(),I($,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(r,{field:"key",label:a.$t("common.key"),rules:[{required:!0,message:a.$t("key.error.required.key")}]},{default:s(()=>[o(P,{modelValue:l.value.key,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.key=t),placeholder:u.value,"auto-size":{minRows:5,maxRows:10},"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(r,{field:"weight",label:a.$t("common.weight")},{default:s(()=>[o(A,{modelValue:l.value.weight,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.weight=t),placeholder:a.$t("placeholder.weight"),precision:0,min:0,max:999},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(r,{field:"remark",label:a.$t("common.remark")},{default:s(()=>[o(N,{modelValue:l.value.remark,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.remark=t),placeholder:a.$t("placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(V,{orientation:"left"},{default:s(()=>[i(m(a.$t("common.title.advanced")),1)]),_:1}),o(r,{field:"models",label:a.$t("common.bind_models")},{default:s(()=>[o(E,{modelValue:l.value.models,"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.models=t),placeholder:a.$t("key.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:g.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"])]),_:1},8,["label"]),o(r,{field:"model_agents",label:a.$t("common.bind_model_agents")},{default:s(()=>[o(L,{modelValue:l.value.model_agents,"onUpdate:modelValue":e[5]||(e[5]=t=>l.value.model_agents=t),placeholder:a.$t("key.placeholder.model_agents"),"max-tag-count":3,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:s(()=>[(c(!0),f(B,null,D(k.value,t=>(c(),I($,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(r,{field:"is_agents_only",label:a.$t("key.label.is_agents_only")},{default:s(()=>[o(M,{modelValue:l.value.is_agents_only,"onUpdate:modelValue":e[6]||(e[6]=t=>l.value.is_agents_only=t)},null,8,["modelValue"])]),_:1},8,["label"]),o(r,{field:"is_never_disable",label:a.$t("key.label.is_never_disable")},{default:s(()=>[o(M,{modelValue:l.value.is_never_disable,"onUpdate:modelValue":e[7]||(e[7]=t=>l.value.is_never_disable=t)},null,8,["modelValue"])]),_:1},8,["label"]),o(H,null,{default:s(()=>[q("div",$e,[o(U,{type:"secondary",onClick:e[8]||(e[8]=t=>a.$router.push({name:"ModelKeyList"}))},{default:s(()=>[i(m(a.$t("button.cancel")),1)]),_:1}),o(U,{type:"primary",onClick:R},{default:s(()=>[i(m(a.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const Qe=Z(Me,[["__scopeId","data-v-5e36863a"]]);export{Qe as default};
