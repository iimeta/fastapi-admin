import{u as x,x as ee,_ as le}from"./index.d8cab1b0.js";/* empty css                *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css                *//* empty css               *//* empty css                */import{d as ae,e as i,B as g,C as h,aH as o,aG as t,aL as u,aM as c,F as R,aJ as A,aI as S,aD as F,bu as oe,bv as te,u as re,aK as de,aF as se,bE as ne,bA as ue,bB as me,b2 as pe,b1 as ie,aS as ce,bO as _e,bP as be,aT as ge,a5 as fe,aU as ve,a4 as ye,bQ as he,bi as ke,b5 as Ve,bI as $e,bR as we,g as Ue}from"./arco.a9260898.js";import{u as Ce}from"./loading.1f346a94.js";import{h as Me,f as qe}from"./vue.ad52ddbe.js";import{e as Be,c as Ie}from"./agent.f34b296b.js";import{q as De}from"./corp.a5274466.js";import{b as Re}from"./model.c9c2685b.js";import"./chart.d103b168.js";const Ae={class:"container"},Se={class:"wrapper"},Fe={class:"submit-btn"},Le={name:"ModelAgentUpdate"},Te=ae({...Le,setup(Ee){const{loading:L,setLoading:n}=Ce(!1),{proxy:T}=Ue(),E=Me(),N=qe(),{t:m}=x(),_=i([]),k=new Map;(async()=>{n(!0);try{const{data:a}=await De();_.value=a.items;for(let l=0;l<_.value.length;l+=1)k.set(_.value[l].id,_.value[l])}catch{}finally{n(!1)}})();const p=i(m("key.placeholder.key")),V=async()=>{switch(k.get(e.value.corp).code){case"Baidu":p.value=m("key.placeholder.key.baidu");break;case"Xfyun":p.value=m("key.placeholder.key.xfyun");break;case"DeepSeek-Baidu":p.value=m("key.placeholder.key.deepseek.baidu");break;case"VolcEngine":p.value=m("key.placeholder.key.volcengine");break;default:p.value=m("key.placeholder.key")}},$=i([]);(async()=>{n(!0);try{const{data:a}=await Re();$.value=a.items}catch{}finally{n(!1)}})();const w=i(),e=i({id:"",corp:"",name:"",base_url:"",path:"",weight:i(20),remark:"",status:1,models:[],is_enable_model_replace:!1,replace_models:[],target_models:[],lb_strategy:"",key:"",is_agents_only:!0}),P=async()=>{var l;if(!await((l=w.value)==null?void 0:l.validate())){n(!0);try{await Be(e.value).then(()=>{T.$message.success("\u66F4\u65B0\u6210\u529F"),N.push({name:"ModelAgentList"})})}catch{}finally{n(!1)}}};(async(a={id:E.query.id})=>{n(!0);try{const{data:l}=await Ie(a);e.value.id=l.id,e.value.corp=l.corp,e.value.name=l.name,e.value.base_url=l.base_url,e.value.path=l.path,e.value.weight=l.weight,e.value.remark=l.remark,e.value.status=l.status,e.value.models=l.models,e.value.is_enable_model_replace=l.is_enable_model_replace,l.replace_models&&(e.value.replace_models=l.replace_models,e.value.target_models=l.target_models),e.value.lb_strategy=String(l.lb_strategy),e.value.key=l.key,V()}catch{}finally{n(!1)}})();const O=()=>{e.value.is_enable_model_replace?U():(e.value.replace_models=[],e.value.target_models=[])},U=()=>{e.value.replace_models.push(""),e.value.target_models.push("")},z=a=>{e.value.replace_models.length>1&&(e.value.replace_models.splice(a,1),e.value.target_models.splice(a,1))};return(a,l)=>{const C=ee,y=de,K=se,M=ne,G=ue,H=me,d=pe,b=ie,J=ce,q=_e,Q=be,B=ge,X=fe,f=ve,j=ye,I=he,D=ke,W=Ve,Y=$e,Z=we;return g(),h("div",Ae,[o(K,{class:"container-breadcrumb"},{default:t(()=>[o(y,null,{default:t(()=>[o(C)]),_:1}),o(y,null,{default:t(()=>[u(c(a.$t("menu.agent")),1)]),_:1}),o(y,null,{default:t(()=>[u(c(a.$t("menu.model.agent.update")),1)]),_:1})]),_:1}),o(Z,{loading:re(L),style:{width:"100%"}},{default:t(()=>[o(Y,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:t(()=>[R("div",Se,[o(W,{ref_key:"formRef",ref:w,model:e.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[o(M,{orientation:"left"},{default:t(()=>[u(c(a.$t("common.title.baseInfo")),1)]),_:1}),o(d,{field:"corp",label:a.$t("model.agent.label.corp"),rules:[{required:!0,message:a.$t("model.agent.error.corp.required")}]},{default:t(()=>[o(H,{modelValue:e.value.corp,"onUpdate:modelValue":l[0]||(l[0]=r=>e.value.corp=r),placeholder:a.$t("model.agent.placeholder.corp"),"allow-search":"",onChange:V},{default:t(()=>[(g(!0),h(A,null,S(_.value,r=>(g(),F(G,{key:r.id,value:r.id,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(d,{field:"name",label:a.$t("model.agent.label.name"),rules:[{required:!0,message:a.$t("model.agent.error.name.required")},{match:/^.{1,100}$/,message:a.$t("model.agent.error.name.pattern")}]},{default:t(()=>[o(b,{modelValue:e.value.name,"onUpdate:modelValue":l[1]||(l[1]=r=>e.value.name=r),placeholder:a.$t("model.agent.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(d,{field:"base_url",label:a.$t("model.agent.label.baseUrl"),rules:[{required:!0,message:a.$t("model.agent.error.baseUrl.required")}]},{default:t(()=>[o(b,{modelValue:e.value.base_url,"onUpdate:modelValue":l[2]||(l[2]=r=>e.value.base_url=r),placeholder:a.$t("model.agent.placeholder.baseUrl")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(d,{field:"path",label:a.$t("model.agent.label.path")},{default:t(()=>[o(b,{modelValue:e.value.path,"onUpdate:modelValue":l[3]||(l[3]=r=>e.value.path=r),placeholder:a.$t("model.agent.placeholder.path")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{field:"weight",label:a.$t("model.agent.label.weight")},{default:t(()=>[o(J,{modelValue:e.value.weight,"onUpdate:modelValue":l[4]||(l[4]=r=>e.value.weight=r),precision:0,min:0,max:999,placeholder:a.$t("model.agent.placeholder.weight")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{field:"remark",label:a.$t("model.agent.label.remark")},{default:t(()=>[o(q,{modelValue:e.value.remark,"onUpdate:modelValue":l[5]||(l[5]=r=>e.value.remark=r),placeholder:a.$t("model.agent.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(M,{orientation:"left"},{default:t(()=>[u(c(a.$t("common.title.advanced")),1)]),_:1}),o(d,{field:"models",label:a.$t("model.agent.label.models"),rules:[{required:!1}]},{default:t(()=>[o(Q,{modelValue:e.value.models,"onUpdate:modelValue":l[6]||(l[6]=r=>e.value.models=r),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,"tree-checked-strategy":"child",data:$.value,placeholder:a.$t("model.agent.placeholder.models"),"max-tag-count":3},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),o(d,{field:"is_enable_model_replace",label:a.$t("model.agent.label.is_enable_model_replace")},{default:t(()=>[o(B,{modelValue:e.value.is_enable_model_replace,"onUpdate:modelValue":l[7]||(l[7]=r=>e.value.is_enable_model_replace=r),onChange:O},null,8,["modelValue"])]),_:1},8,["label"]),(g(!0),h(A,null,S(e.value.replace_models,(r,s)=>oe((g(),F(d,{key:s,field:`replace_models[${s}]`&&`target_models[${s}]`,label:`${s+1}. `+a.$t("model.agent.label.replace_models"),rules:[{required:!0,message:a.$t("model.agent.error.replace_models.required")}]},{default:t(()=>[o(b,{modelValue:e.value.replace_models[s],"onUpdate:modelValue":v=>e.value.replace_models[s]=v,placeholder:a.$t("model.agent.placeholder.replace_models"),style:{width:"218px","margin-right":"5px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),o(b,{modelValue:e.value.target_models[s],"onUpdate:modelValue":v=>e.value.target_models[s]=v,placeholder:a.$t("model.agent.placeholder.target_models"),style:{width:"218px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),o(f,{type:"primary",shape:"circle",style:{margin:"0 10px 0 10px"},onClick:U},{default:t(()=>[o(X)]),_:1}),o(f,{type:"secondary",shape:"circle",onClick:v=>z(s)},{default:t(()=>[o(j)]),_:2},1032,["onClick"])]),_:2},1032,["field","label","rules"])),[[te,e.value.is_enable_model_replace]])),128)),o(d,{field:"lb_strategy",label:a.$t("model.agent.label.lb_strategy")},{default:t(()=>[o(D,{size:"large"},{default:t(()=>[o(I,{modelValue:e.value.lb_strategy,"onUpdate:modelValue":l[8]||(l[8]=r=>e.value.lb_strategy=r),value:"1","default-checked":!0},{default:t(()=>[u(" \u8F6E\u8BE2 ")]),_:1},8,["modelValue"]),o(I,{modelValue:e.value.lb_strategy,"onUpdate:modelValue":l[9]||(l[9]=r=>e.value.lb_strategy=r),value:"2"},{default:t(()=>[u("\u6743\u91CD")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"]),o(d,{field:"key",label:a.$t("model.agent.label.key")},{default:t(()=>[o(q,{modelValue:e.value.key,"onUpdate:modelValue":l[10]||(l[10]=r=>e.value.key=r),placeholder:p.value,"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(d,{field:"is_agents_only",label:a.$t("model.agent.label.isAgentsOnly")},{default:t(()=>[o(B,{modelValue:e.value.is_agents_only,"onUpdate:modelValue":l[11]||(l[11]=r=>e.value.is_agents_only=r)},null,8,["modelValue"])]),_:1},8,["label"]),o(D,null,{default:t(()=>[R("div",Fe,[o(f,{type:"secondary",onClick:l[12]||(l[12]=r=>a.$router.push({name:"ModelAgentList"}))},{default:t(()=>[u(c(a.$t("button.cancel")),1)]),_:1}),o(f,{type:"primary",onClick:P},{default:t(()=>[u(c(a.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const ml=le(Te,[["__scopeId","data-v-e8599bc3"]]);export{ml as default};
