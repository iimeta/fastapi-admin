import{u as ye,G as ke,q as xe,z as Ce,j as we,A as Ee,_ as De}from"./index.13181180.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              */import{d as Ie,r as H,e as s,c as R,w as ze,B as l,C as u,aH as e,aG as t,aL as g,aM as c,aJ as z,aI as B,aD as j,D as _,u as O,E as Be,n as Se,aK as Ve,aF as Ae,b1 as Fe,b2 as $e,bG as Le,bH as Ne,bI as Me,bK as Ue,b5 as Pe,bL as Ge,ab as Te,aU as qe,bi as He,bj as Re,bl as je,bm as Oe,b4 as Ke,bM as Je,bO as Qe,a_ as We,bU as Xe}from"./arco.088e2a49.js";import{u as Ye}from"./loading.6f488126.js";import{b as Ze}from"./group.e666c24c.js";import{c as S,S as ea}from"./sortable.esm.70bb3f9a.js";import{M as aa}from"./models.f47936b6.js";import{q as ta}from"./model.f572240a.js";import"./chart.0bfa65d3.js";import"./vue.bd25b247.js";import"./provider.096f1d99.js";const oa={class:"container"},na={class:"action-icon"},la={class:"action-icon"},sa={id:"tableSetting"},ua={style:{"margin-right":"4px",cursor:"move"}},ca={class:"title"},ia={key:0,title:"\u9ED8\u8BA4\u5206\u7EC4"},ra={key:1},da={key:0},ma={key:1},pa={key:0,class:"circle red"},_a={key:1,class:"circle"},ga={name:"MyGroup"},fa=Ie({...ga,setup(va){const{loading:K,setLoading:V}=Ye(!0),{t:i}=ye(),J=H({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),Q=()=>({name:"",models:[],model_agents:[],status:s(),remark:"",expires_at:[]}),A=s([]),r=s(Q()),f=s([]),b=s([]),x=s("medium"),F=s(),h={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},y=H({...h}),W=R(()=>[{name:i("size.mini"),value:"mini"},{name:i("size.small"),value:"small"},{name:i("size.medium"),value:"medium"},{name:i("size.large"),value:"large"}]),X=R(()=>[{title:i("group.columns.name"),dataIndex:"name",slotName:"name",align:"center",width:168},{title:i("group.columns.discount"),dataIndex:"discount",slotName:"discount",align:"center",width:128},{title:i("group.columns.models"),dataIndex:"model_names",slotName:"model_names",align:"center",width:128},{title:i("group.columns.expires_at"),dataIndex:"expires_at",slotName:"expires_at",align:"center",width:178},{title:i("group.columns.remark"),dataIndex:"remark",slotName:"remark",align:"center"},{title:i("group.columns.status"),dataIndex:"status",slotName:"status",align:"center",width:75}]),k=async(o={...h})=>{V(!0);try{const{data:n}=await Ze(o);A.value=n.items,y.current=o.current,y.pageSize=o.pageSize,y.total=n.paging.total}catch{}finally{V(!1),F.value.selectAll(!1)}};k();const $=()=>{k({...h,...r.value})},Y=o=>{k({...h,...r.value,current:o})},Z=o=>{h.pageSize=o,k({...h,...r.value})},ee=(o,n)=>{x.value=o},ae=(o,n,d)=>{o?f.value.splice(d,0,n):f.value=b.value.filter(m=>m.dataIndex!==n.dataIndex)},L=(o,n,d,m=!1)=>{const p=m?S(o):o;return n>-1&&d>-1&&p.splice(n,1,p.splice(d,1,p[n]).pop()),p},te=o=>{o&&Se(()=>{const n=document.getElementById("tableSetting");new ea(n,{onEnd(d){const{oldIndex:m,newIndex:p}=d;L(f.value,m,p),L(b.value,m,p)}})})};ze(()=>X.value,o=>{f.value=S(o),f.value.forEach((n,d)=>{n.checked=!0}),b.value=S(f.value)},{deep:!0,immediate:!0});const N=s([]);(async()=>{try{const{data:o}=await ta();N.value=o.items}catch{}})();const C=s(!1),M=s(),U=s(),oe=o=>{C.value=!0,M.value=o,U.value="group"};return(o,n)=>{const d=ke,m=Ve,p=Ae,P=Fe,w=$e,v=Le,ne=Ne,le=Me,E=Ue,se=Pe,G=Ge,ue=Te,T=qe,ce=He,ie=xe,D=Re,re=Ce,de=je,me=Oe,pe=we,_e=Ee,ge=Ke,fe=Je,ve=Qe,he=We,be=Xe;return l(),u("div",oa,[e(p,{class:"container-breadcrumb"},{default:t(()=>[e(m,null,{default:t(()=>[e(d)]),_:1}),e(m,null,{default:t(()=>[g(c(o.$t("menu.my.group")),1)]),_:1})]),_:1}),e(be,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{flex:1},{default:t(()=>[e(se,{model:r.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:t(()=>[e(E,{gutter:16},{default:t(()=>[e(v,{span:8},{default:t(()=>[e(w,{field:"name",label:o.$t("group.form.name")},{default:t(()=>[e(P,{modelValue:r.value.name,"onUpdate:modelValue":n[0]||(n[0]=a=>r.value.name=a),placeholder:o.$t("group.form.name.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(v,{span:8},{default:t(()=>[e(w,{field:"models",label:o.$t("group.form.models")},{default:t(()=>[e(le,{modelValue:r.value.models,"onUpdate:modelValue":n[1]||(n[1]=a=>r.value.models=a),placeholder:o.$t("group.form.selectDefault"),"max-tag-count":2,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:t(()=>[(l(!0),u(z,null,B(N.value,a=>(l(),j(ne,{key:a.id,value:a.id,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(v,{span:8},{default:t(()=>[e(w,{field:"remark",label:o.$t("group.form.remark")},{default:t(()=>[e(P,{modelValue:r.value.remark,"onUpdate:modelValue":n[2]||(n[2]=a=>r.value.remark=a),placeholder:o.$t("group.form.remark.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(G,{style:{height:"32px"},direction:"vertical"}),e(v,{flex:"86px",style:{"text-align":"right"}},{default:t(()=>[e(ce,{direction:"vertical",size:18},{default:t(()=>[e(T,{type:"primary",onClick:$},{icon:t(()=>[e(ue)]),default:t(()=>[g(" "+c(o.$t("group.form.search")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(G,{style:{"margin-top":"0"}}),e(E,{style:{"margin-bottom":"16px"}},{default:t(()=>[e(v,{span:22},{default:t(()=>[g(" \u8BF4\u660E: \u5206\u7EC4\u540D\u79F0\u52A0\u7C97\u7684\u4E3A\u9ED8\u8BA4\u5206\u7EC4, \u9ED8\u8BA4\u6392\u5728\u5217\u8868\u9996\u4F4D, \u5F53\u5E94\u7528\u6216\u5BC6\u94A5\u4E0D\u7ED1\u5B9A\u5206\u7EC4\u65F6, \u8C03\u7528\u6A21\u578B\u5C06\u6309\u5206\u7EC4\u5217\u8868\u987A\u5E8F\u4F9D\u6B21\u67E5\u627E, \u63A8\u8350\u5C06\u5E94\u7528\u6216\u5BC6\u94A5\u7ED1\u5B9A\u5206\u7EC4\u4F7F\u7528 ")]),_:1}),e(v,{span:2,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:t(()=>[e(D,{content:o.$t("actions.refresh")},{default:t(()=>[_("div",{class:"action-icon",onClick:$},[e(ie,{size:"18"})])]),_:1},8,["content"]),e(me,{onSelect:ee},{content:t(()=>[(l(!0),u(z,null,B(O(W),a=>(l(),j(de,{key:a.value,value:a.value,class:Be({active:a.value===x.value})},{default:t(()=>[_("span",null,c(a.name),1)]),_:2},1032,["value","class"]))),128))]),default:t(()=>[e(D,{content:o.$t("actions.density")},{default:t(()=>[_("div",na,[e(re,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(D,{content:o.$t("actions.column_setting")},{default:t(()=>[e(fe,{trigger:"click",position:"bl",onPopupVisibleChange:te},{content:t(()=>[_("div",sa,[(l(!0),u(z,null,B(b.value,(a,q)=>(l(),u("div",{key:a.dataIndex,class:"setting"},[_("div",ua,[e(_e)]),_("div",null,[e(ge,{modelValue:a.checked,"onUpdate:modelValue":I=>a.checked=I,onChange:I=>ae(I,a,q)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_("div",ca,c(a.title==="#"?"\u5E8F\u5217\u53F7":a.title),1)]))),128))])]),default:t(()=>[_("div",la,[e(pe,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(ve,{ref_key:"tableRef",ref:F,"row-key":"id",loading:O(K),pagination:y,columns:f.value,data:A.value,bordered:!1,size:x.value,"row-selection":J,onPageChange:Y,onPageSizeChange:Z},{name:t(({record:a})=>[a.is_default?(l(),u("span",ia,[_("b",null,c(a.name),1)])):(l(),u("span",ra,c(a.name),1))]),discount:t(({record:a})=>[g(c(Number((a.discount*100).toFixed(2)))+"% ",1)]),model_names:t(({record:a})=>[a.model_names?(l(),u("span",da,[e(T,{type:"text",size:"small",onClick:q=>oe(a.id)},{default:t(()=>[g(" \u67E5\u770B ")]),_:2},1032,["onClick"])])):(l(),u("span",ma,c("-")))]),expires_at:t(({record:a})=>[g(c(a.expires_at||"-"),1)]),remark:t(({record:a})=>[g(c(a.remark||"-"),1)]),status:t(({record:a})=>[a.status===2?(l(),u("span",pa)):(l(),u("span",_a)),g(" "+c(o.$t(`dict.status.${a.status}`)),1)]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),e(he,{visible:C.value,"onUpdate:visible":n[3]||(n[3]=a=>C.value=a),title:o.$t("common.models"),"modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"1080px","ok-text":"\u5173\u95ED"},{default:t(()=>[e(aa,{id:M.value,action:U.value},null,8,["id","action"])]),_:1},8,["visible","title"])]),_:1})])}}});const qa=De(fa,[["__scopeId","data-v-973a852d"]]);export{qa as default};
