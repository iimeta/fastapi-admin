import{H as ue,_ as te}from"./index.15d033c0.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css                */import{d as de,e as _,B as s,C as y,aH as l,aG as a,aL as t,aM as b,D as U,aD as i,aE as f,aJ as q,aI as k,u as m,bn as se,bo as ne,aK as ie,aF as _e,bJ as fe,b1 as me,b2 as pe,aS as ge,bP as ce,aT as ve,bO as be,bQ as we,bi as ye,bF as he,bG as $e,bU as Ve,b4 as qe,a5 as ke,aU as Ue,a4 as Ce,bV as De,b5 as Be,bN as Fe,bR as Ie,b9 as Le,ba as Me,g as Se}from"./arco.cbac690a.js";import{u as Ae}from"./loading.b56ef223.js";import{q as N,d as Ee,a as w}from"./common.4090c8c2.js";import{f as He}from"./vue.4014b72a.js";import{g as Ge}from"./group.b193b4af.js";import{q as Re,b as Te}from"./model.9884c1b9.js";import{f as Ne}from"./agent.9d225bc3.js";import"./chart.e521dee8.js";const Qe=C=>(Le("data-v-38877129"),C=C(),Me(),C),Ke={class:"container"},Pe={class:"wrapper"},ze=Qe(()=>U("div",{style:{"margin-left":"10px"}}," % ",-1)),Je={style:{"margin-left":"10px"}},Oe={style:{"margin-left":"10px"}},je={class:"submit-btn"},We={name:"GroupCreate"},Xe=de({...We,setup(C){const{loading:Q,setLoading:g}=Ae(!1),{proxy:K}=Se(),P=He(),D=_([]);(async()=>{g(!0);try{const{data:o}=await Re();D.value=o.items}catch{}finally{g(!1)}})();const L=_([]);(async()=>{g(!0);try{const{data:o}=await Te();L.value=o.items}catch{}finally{g(!1)}})();const M=_([]);(async()=>{g(!0);try{const{data:o}=await Ne();M.value=o.items}catch{}finally{g(!1)}})();const S=_(),e=_({name:"",discount:_(),models:[],is_default:!1,is_public:!0,weight:_(),expires_at:"",remark:"",is_enable_model_agent:!1,lb_strategy:"1",model_agents:[],is_limit_quota:!1,quota:_(),is_enable_forward:!1,forward_config:{forward_rule:"1",match_rule:["2"],target_model:"",decision_model:"",keywords:[],target_models:[],content_length:_(),used_quota:_()}}),z=async()=>{var u;if(!await((u=S.value)==null?void 0:u.validate())){g(!0);try{await Ge(e.value).then(()=>{K.$message.success("\u65B0\u5EFA\u6210\u529F"),P.push({name:"GroupList"})})}catch{}finally{g(!1)}}},J=o=>{e.value.quota=o*5e5},O=o=>{e.value.forward_config.used_quota=o*5e5},A=()=>{e.value.is_enable_forward?e.value.forward_config.forward_rule==="2"?(e.value.forward_config.keywords=[""],e.value.forward_config.target_models=[""],e.value.forward_config.target_model="",e.value.forward_config.content_length=_()):(e.value.forward_config.forward_rule==="1"||e.value.forward_config.forward_rule==="3"||e.value.forward_config.forward_rule==="4")&&(e.value.forward_config.keywords=[],e.value.forward_config.target_models=[]):(e.value.forward_config.target_model="",e.value.forward_config.keywords=[],e.value.forward_config.target_models=[],e.value.forward_config.content_length=_())},j=()=>{e.value.forward_config.keywords.push(""),e.value.forward_config.target_models.push("")},W=o=>{e.value.forward_config.keywords.length>1&&(e.value.forward_config.keywords.splice(o,1),e.value.forward_config.target_models.splice(o,1))};return(o,u)=>{const E=ue,F=ie,X=_e,H=fe,G=me,d=pe,h=ge,Y=ce,$=ve,Z=be,n=we,I=ye,c=he,V=$e,R=Ve,T=qe,x=ke,B=Ue,ee=Ce,le=De,ae=Be,oe=Fe,re=Ie;return s(),y("div",Ke,[l(X,{class:"container-breadcrumb"},{default:a(()=>[l(F,null,{default:a(()=>[l(E)]),_:1}),l(F,null,{default:a(()=>[t(b(o.$t("menu.group")),1)]),_:1}),l(F,null,{default:a(()=>[t(b(o.$t("menu.group.create")),1)]),_:1})]),_:1}),l(re,{loading:m(Q),style:{width:"100%"}},{default:a(()=>[l(oe,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:a(()=>[U("div",Pe,[l(ae,{ref_key:"formRef",ref:S,model:e.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:a(()=>[l(H,{orientation:"left"},{default:a(()=>[t(b(o.$t("common.title.baseInfo")),1)]),_:1}),l(d,{field:"name",label:o.$t("group.label.name"),rules:[{required:!0,message:o.$t("group.error.name.required")}]},{default:a(()=>[l(G,{modelValue:e.value.name,"onUpdate:modelValue":u[0]||(u[0]=r=>e.value.name=r),placeholder:o.$t("group.placeholder.name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),l(d,{field:"discount",label:o.$t("group.label.discount"),rules:[{required:!0,message:o.$t("group.error.discount.required")}]},{default:a(()=>[l(h,{modelValue:e.value.discount,"onUpdate:modelValue":u[1]||(u[1]=r=>e.value.discount=r),placeholder:o.$t("group.placeholder.discount"),min:.01,max:9999999999999,"allow-clear":""},null,8,["modelValue","placeholder","min"]),ze]),_:1},8,["label","rules"]),e.value.is_default?f("",!0):(s(),i(d,{key:0,field:"weight",label:o.$t("group.label.weight"),rules:[{required:!0,message:o.$t("group.error.weight.required")}]},{default:a(()=>[l(h,{modelValue:e.value.weight,"onUpdate:modelValue":u[2]||(u[2]=r=>e.value.weight=r),placeholder:o.$t("group.placeholder.weight"),precision:0,min:1,max:99999,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])),l(d,{field:"models",label:o.$t("group.label.models"),rules:[{required:!0,message:o.$t("group.error.models.required")}]},{default:a(()=>[l(Y,{modelValue:e.value.models,"onUpdate:modelValue":u[3]||(u[3]=r=>e.value.models=r),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:L.value,placeholder:o.$t("group.placeholder.models"),"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","data","placeholder"])]),_:1},8,["label","rules"]),l(d,{field:"is_public",label:o.$t("group.label.is_public"),rules:[{required:!0}]},{default:a(()=>[l($,{modelValue:e.value.is_public,"onUpdate:modelValue":u[4]||(u[4]=r=>e.value.is_public=r)},null,8,["modelValue"])]),_:1},8,["label"]),l(d,{field:"is_default",label:o.$t("group.label.is_default")},{default:a(()=>[l($,{modelValue:e.value.is_default,"onUpdate:modelValue":u[5]||(u[5]=r=>e.value.is_default=r)},null,8,["modelValue"])]),_:1},8,["label"]),l(d,{field:"remark",label:o.$t("group.label.remark"),rules:[{required:!1}]},{default:a(()=>[l(Z,{modelValue:e.value.remark,"onUpdate:modelValue":u[6]||(u[6]=r=>e.value.remark=r),placeholder:o.$t("group.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(H,{orientation:"left"},{default:a(()=>[t(b(o.$t("common.title.advanced")),1)]),_:1}),l(d,{field:"is_enable_model_agent",label:o.$t("group.label.is_enable_model_agent")},{default:a(()=>[l($,{modelValue:e.value.is_enable_model_agent,"onUpdate:modelValue":u[7]||(u[7]=r=>e.value.is_enable_model_agent=r)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_enable_model_agent?(s(),i(d,{key:1,field:"lb_strategy",label:o.$t("model.label.lb_strategy"),rules:[{required:!0}]},{default:a(()=>[l(I,{size:"large"},{default:a(()=>[l(n,{modelValue:e.value.lb_strategy,"onUpdate:modelValue":u[8]||(u[8]=r=>e.value.lb_strategy=r),value:"1","default-checked":!0},{default:a(()=>[t(" \u8F6E\u8BE2 ")]),_:1},8,["modelValue"]),l(n,{modelValue:e.value.lb_strategy,"onUpdate:modelValue":u[9]||(u[9]=r=>e.value.lb_strategy=r),value:"2"},{default:a(()=>[t("\u6743\u91CD")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"])):f("",!0),e.value.is_enable_model_agent?(s(),i(d,{key:2,field:"model_agents",label:o.$t("group.label.model_agents"),rules:[{required:!0,message:o.$t("group.error.model_agents.required")}]},{default:a(()=>[l(V,{modelValue:e.value.model_agents,"onUpdate:modelValue":u[10]||(u[10]=r=>e.value.model_agents=r),placeholder:o.$t("group.placeholder.model_agents"),"max-tag-count":3,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:a(()=>[(s(!0),y(q,null,k(M.value,r=>(s(),i(c,{key:r.id,value:r.id,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):f("",!0),l(d,{field:"is_limit_quota",label:o.$t("group.label.is_limit_quota")},{default:a(()=>[l($,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":u[11]||(u[11]=r=>e.value.is_limit_quota=r)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(s(),i(d,{key:3,field:"quota",label:o.$t("group.label.quota"),rules:[{required:!0,message:o.$t("group.error.quota.required")}]},{default:a(()=>[l(h,{modelValue:e.value.quota,"onUpdate:modelValue":u[12]||(u[12]=r=>e.value.quota=r),placeholder:o.$t("group.placeholder.quota"),precision:0,min:1,max:9999999999999,"allow-clear":""},null,8,["modelValue","placeholder"]),U("div",Je," $"+b(e.value.quota?m(N)(e.value.quota):"0.00"),1)]),_:1},8,["label","rules"])):f("",!0),e.value.is_limit_quota?(s(),i(d,{key:4},{default:a(()=>[l(R,{type:"button",onChange:J},{default:a(()=>[l(n,{value:1},{default:a(()=>[t(" $1 ")]),_:1}),l(n,{value:2},{default:a(()=>[t(" $2 ")]),_:1}),l(n,{value:5},{default:a(()=>[t(" $5 ")]),_:1}),l(n,{value:10},{default:a(()=>[t(" $10 ")]),_:1}),l(n,{value:20},{default:a(()=>[t(" $20 ")]),_:1}),l(n,{value:50},{default:a(()=>[t(" $50 ")]),_:1}),l(n,{value:100},{default:a(()=>[t(" $100 ")]),_:1}),l(n,{value:200},{default:a(()=>[t(" $200 ")]),_:1}),l(n,{value:500},{default:a(()=>[t(" $500 ")]),_:1}),l(n,{value:1e3},{default:a(()=>[t(" $1000 ")]),_:1})]),_:1},8,["onChange"])]),_:1})):f("",!0),l(d,{field:"model_forward",label:o.$t("group.label.is_enable_forward")},{default:a(()=>[l($,{modelValue:e.value.is_enable_forward,"onUpdate:modelValue":u[13]||(u[13]=r=>e.value.is_enable_forward=r),onChange:A},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_enable_forward?(s(),i(d,{key:5,field:"forward_config.forward_rule",label:o.$t("group.label.forward_rule"),rules:[{required:!0,message:o.$t("group.error.forward_rule.required")}]},{default:a(()=>[l(V,{modelValue:e.value.forward_config.forward_rule,"onUpdate:modelValue":u[14]||(u[14]=r=>e.value.forward_config.forward_rule=r),placeholder:o.$t("group.placeholder.forward_rule"),scrollbar:!1,onChange:A},{default:a(()=>[l(c,{value:"1"},{default:a(()=>[t("\u5168\u90E8\u8F6C\u53D1")]),_:1}),l(c,{value:"2"},{default:a(()=>[t("\u6309\u5173\u952E\u5B57")]),_:1}),l(c,{value:"3"},{default:a(()=>[t("\u5185\u5BB9\u957F\u5EA6")]),_:1}),l(c,{value:"4"},{default:a(()=>[t("\u5DF2\u7528\u989D\u5EA6")]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):f("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="3"?(s(),i(d,{key:6,field:"forward_config.content_length",label:o.$t("group.label.content_length"),rules:[{required:!0,message:o.$t("group.error.content_length.required")}]},{default:a(()=>[l(h,{modelValue:e.value.forward_config.content_length,"onUpdate:modelValue":u[15]||(u[15]=r=>e.value.forward_config.content_length=r),placeholder:o.$t("group.placeholder.content_length"),precision:0,min:1,max:9999999999999,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):f("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="4"?(s(),i(d,{key:7,field:"forward_config.used_quota",label:o.$t("group.label.used_quota"),rules:[{required:!0,message:o.$t("group.error.used_quota.required")}]},{default:a(()=>[l(h,{modelValue:e.value.forward_config.used_quota,"onUpdate:modelValue":u[16]||(u[16]=r=>e.value.forward_config.used_quota=r),placeholder:o.$t("group.placeholder.used_quota"),precision:0,min:1,max:9999999999999,"allow-clear":""},null,8,["modelValue","placeholder"]),U("div",Oe," $"+b(e.value.forward_config.used_quota?m(N)(e.value.forward_config.used_quota):"0.00"),1)]),_:1},8,["label","rules"])):f("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="4"?(s(),i(d,{key:8},{default:a(()=>[l(R,{type:"button",onChange:O},{default:a(()=>[l(n,{value:1},{default:a(()=>[t(" $1 ")]),_:1}),l(n,{value:2},{default:a(()=>[t(" $2 ")]),_:1}),l(n,{value:5},{default:a(()=>[t(" $5 ")]),_:1}),l(n,{value:10},{default:a(()=>[t(" $10 ")]),_:1}),l(n,{value:20},{default:a(()=>[t(" $20 ")]),_:1}),l(n,{value:50},{default:a(()=>[t(" $50 ")]),_:1}),l(n,{value:100},{default:a(()=>[t(" $100 ")]),_:1}),l(n,{value:200},{default:a(()=>[t(" $200 ")]),_:1}),l(n,{value:500},{default:a(()=>[t(" $500 ")]),_:1}),l(n,{value:1e3},{default:a(()=>[t(" $1000 ")]),_:1})]),_:1},8,["onChange"])]),_:1})):f("",!0),e.value.is_enable_forward&&(e.value.forward_config.forward_rule==="1"||e.value.forward_config.forward_rule==="3"||e.value.forward_config.forward_rule==="4")?(s(),i(d,{key:9,field:"forward_config.target_model",label:o.$t("group.label.target_model"),rules:[{required:!0,message:o.$t("group.error.target_model.required")}]},{default:a(()=>[l(V,{modelValue:e.value.forward_config.target_model,"onUpdate:modelValue":u[17]||(u[17]=r=>e.value.forward_config.target_model=r),placeholder:o.$t("group.placeholder.target_model"),scrollbar:!1,"allow-search":""},{default:a(()=>[(s(!0),y(q,null,k(D.value,r=>(s(),i(c,{key:r.id,value:r.id,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):f("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"?(s(),i(d,{key:10,field:"forward_config.match_rule",label:o.$t("group.label.match_rule"),rules:[{required:!0,message:o.$t("group.error.match_rule.required")}]},{default:a(()=>[l(I,{size:"large"},{default:a(()=>[l(T,{modelValue:e.value.forward_config.match_rule,"onUpdate:modelValue":u[18]||(u[18]=r=>e.value.forward_config.match_rule=r),value:"1","default-checked":!0},{default:a(()=>[t("\u667A\u80FD\u5339\u914D")]),_:1},8,["modelValue"]),l(T,{modelValue:e.value.forward_config.match_rule,"onUpdate:modelValue":u[19]||(u[19]=r=>e.value.forward_config.match_rule=r),value:"2"},{default:a(()=>[t("\u6B63\u5219\u5339\u914D")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"])):f("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"&&e.value.forward_config.match_rule.includes("1")?(s(),i(d,{key:11,field:"forward_config.decision_model",label:o.$t("group.label.decision_model"),rules:[{required:!0,message:o.$t("group.error.decision_model.required")}]},{default:a(()=>[l(V,{modelValue:e.value.forward_config.decision_model,"onUpdate:modelValue":u[20]||(u[20]=r=>e.value.forward_config.decision_model=r),placeholder:o.$t("group.placeholder.decision_model"),scrollbar:!1,"allow-search":""},{default:a(()=>[(s(!0),y(q,null,k(D.value,r=>(s(),i(c,{key:r.id,value:r.id,label:r.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):f("",!0),(s(!0),y(q,null,k(e.value.forward_config.keywords,(r,p)=>se((s(),i(d,{key:p,field:`forward_config.keywords[${p}]`&&`forward_config.target_models[${p}]`,label:`${p+1}. `+o.$t("group.label.keywords"),rules:[{required:!0,message:o.$t("group.error.keywords_target_model.required")}]},{default:a(()=>[l(G,{modelValue:e.value.forward_config.keywords[p],"onUpdate:modelValue":v=>e.value.forward_config.keywords[p]=v,placeholder:o.$t("group.placeholder.keywords"),style:{width:"45%","margin-right":"5px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),l(V,{modelValue:e.value.forward_config.target_models[p],"onUpdate:modelValue":v=>e.value.forward_config.target_models[p]=v,placeholder:o.$t("group.placeholder.target_model"),scrollbar:!1,style:{width:"40%"},"allow-search":""},{default:a(()=>[(s(!0),y(q,null,k(D.value,v=>(s(),i(c,{key:v.id,value:v.id,label:v.name},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),l(B,{type:"primary",shape:"circle",style:{margin:"0 10px 0 10px"},onClick:j},{default:a(()=>[l(x)]),_:1}),l(B,{type:"secondary",shape:"circle",onClick:v=>W(p)},{default:a(()=>[l(ee)]),_:2},1032,["onClick"])]),_:2},1032,["field","label","rules"])),[[ne,e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"]])),128)),l(d,{field:"expires_at",label:o.$t("group.label.expires_at")},{default:a(()=>[l(le,{modelValue:e.value.expires_at,"onUpdate:modelValue":u[21]||(u[21]=r=>e.value.expires_at=r),placeholder:o.$t("group.placeholder.expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":m(Ee),"allow-clear":"",style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>m(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>m(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>m(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>m(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>m(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>m(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>m(w)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"]),l(I,null,{default:a(()=>[U("div",je,[l(B,{type:"secondary",onClick:u[22]||(u[22]=r=>o.$router.push({name:"GroupList"}))},{default:a(()=>[t(b(o.$t("button.cancel")),1)]),_:1}),l(B,{type:"primary",onClick:z},{default:a(()=>[t(b(o.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const $l=te(Xe,[["__scopeId","data-v-38877129"]]);export{$l as default};
