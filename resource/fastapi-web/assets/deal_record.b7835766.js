import{u as he,G as ye,s as we,A as ke,k as Se,B as $e,_ as Ie}from"./index.2b50796c.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css              */import{d as Ve,r as U,e as u,c as $,w as Ce,bS as xe,B as p,C as b,aH as e,aG as a,aL as v,aM as d,bu as A,aD as E,u as h,D as _,aJ as T,aI as G,E as ze,n as De,aK as qe,aF as Be,aS as Ne,b2 as Pe,bH as Fe,bG as Le,bT as Re,bI as Ue,b5 as Ae,bJ as Ee,ab as Te,aU as Ge,bi as He,bj as Oe,bk as je,bl as Je,b4 as Ke,bK as Me,bM as Qe,bN as We}from"./arco.278964f1.js";import{u as Xe}from"./loading.a887a82e.js";import{c as z,S as Ye}from"./sortable.esm.cede697b.js";import{p as H}from"./common.aee3db13.js";import{b as Ze}from"./finance.6335291a.js";import"./chart.3af80f5f.js";import"./vue.f2e81e01.js";const ea={class:"container"},aa={class:"action-icon"},ta={class:"action-icon"},na={id:"tableSetting"},oa={style:{"margin-right":"4px",cursor:"move"}},la={class:"title"},sa={key:0,class:"circle red"},ca={key:1,class:"circle"},ia={name:"DealRecordList"},ra=Ve({...ia,setup(ua){const{loading:O,setLoading:D}=Xe(!0),{t:l}=he(),j=U({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),J=()=>({user_id:u(),type:u(),status:u(),created_at:[]}),q=u([]),s=u(J()),m=u([]),y=u([]),I=u("medium"),B=u(),g={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},w=U({...g}),K=$(()=>[{name:l("size.mini"),value:"mini"},{name:l("size.small"),value:"small"},{name:l("size.medium"),value:"medium"},{name:l("size.large"),value:"large"}]),M=$(()=>[{title:l("finance.columns.user_id"),dataIndex:"user_id",slotName:"user_id",align:"center"},{title:l("finance.columns.quota"),dataIndex:"quota",slotName:"quota",align:"center"},{title:l("finance.columns.type"),dataIndex:"type",slotName:"type",align:"center"},{title:l("finance.columns.status"),dataIndex:"status",slotName:"status",align:"center"},{title:l("finance.columns.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center"}]),Q=$(()=>[{label:l("finance.dict.deal_type.1"),value:1},{label:l("finance.dict.deal_type.2"),value:2},{label:l("finance.dict.deal_type.3"),value:3},{label:l("finance.dict.deal_type.4"),value:4}]),W=$(()=>[{label:l("finance.dict.status.1"),value:1},{label:l("finance.dict.status.2"),value:2},{label:l("finance.dict.status.3"),value:3}]),k=async(t={...g})=>{D(!0);try{const{data:o}=await Ze(t);q.value=o.items,w.current=t.current,w.pageSize=t.pageSize,w.total=o.paging.total}catch{}finally{D(!1),B.value.selectAll(!1)}};k();const N=()=>{k({...g,...s.value})},X=t=>{k({...g,...s.value,current:t})},Y=t=>{g.pageSize=t,k({...g,...s.value})},Z=(t,o)=>{I.value=t},ee=(t,o,i)=>{t?m.value.splice(i,0,o):m.value=y.value.filter(c=>c.dataIndex!==o.dataIndex)},P=(t,o,i,c=!1)=>{const r=c?z(t):t;return o>-1&&i>-1&&r.splice(o,1,r.splice(i,1,r[o]).pop()),r},ae=t=>{t&&De(()=>{const o=document.getElementById("tableSetting");new Ye(o,{onEnd(i){const{oldIndex:c,newIndex:r}=i;P(m.value,c,r),P(y.value,c,r)}})})};return Ce(()=>M.value,t=>{m.value=z(t),m.value.forEach((o,i)=>{o.checked=!0}),y.value=z(m.value)},{deep:!0,immediate:!0}),(t,o)=>{const i=ye,c=qe,r=Be,te=Ne,S=Pe,f=Fe,F=Le,ne=Re,V=Ue,oe=Ae,L=Ee,le=Te,se=Ge,ce=He,ie=we,C=Oe,re=ke,ue=je,de=Je,pe=Se,_e=$e,me=Ke,fe=Me,ve=Qe,ge=We,R=xe("permission");return p(),b("div",ea,[e(r,{class:"container-breadcrumb"},{default:a(()=>[e(c,null,{default:a(()=>[e(i)]),_:1}),e(c,null,{default:a(()=>[v(d(t.$t("menu.finance")),1)]),_:1}),e(c,null,{default:a(()=>[v(d(t.$t("menu.deal_record.list")),1)]),_:1})]),_:1}),e(ge,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:a(()=>[A((p(),E(V,null,{default:a(()=>[e(f,{flex:1},{default:a(()=>[e(oe,{model:s.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(V,{gutter:16},{default:a(()=>[e(f,{span:6},{default:a(()=>[e(S,{field:"name",label:t.$t("finance.form.user_id"),"label-col-props":{span:6}},{default:a(()=>[e(te,{modelValue:s.value.user_id,"onUpdate:modelValue":o[0]||(o[0]=n=>s.value.user_id=n),placeholder:t.$t("finance.form.user_id.placeholder"),precision:0,min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(f,{span:6},{default:a(()=>[e(S,{field:"type",label:t.$t("finance.form.type")},{default:a(()=>[e(F,{modelValue:s.value.type,"onUpdate:modelValue":o[1]||(o[1]=n=>s.value.type=n),placeholder:t.$t("finance.form.selectDefault"),options:h(Q),scrollbar:!1,"allow-clear":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"])]),_:1}),e(f,{span:6},{default:a(()=>[e(S,{field:"status",label:t.$t("finance.form.status")},{default:a(()=>[e(F,{modelValue:s.value.status,"onUpdate:modelValue":o[2]||(o[2]=n=>s.value.status=n),placeholder:t.$t("finance.form.selectDefault"),options:h(W),scrollbar:!1,"allow-clear":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"])]),_:1}),e(f,{span:6},{default:a(()=>[e(S,{field:"created_at",label:t.$t("finance.form.created_at")},{default:a(()=>[e(ne,{modelValue:s.value.created_at,"onUpdate:modelValue":o[3]||(o[3]=n=>s.value.created_at=n),style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(L,{style:{height:"32px"},direction:"vertical"}),e(f,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(ce,{direction:"vertical",size:18},{default:a(()=>[e(se,{type:"primary",onClick:N},{icon:a(()=>[e(le)]),default:a(()=>[v(" "+d(t.$t("finance.form.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})),[[R,["reseller","admin"]]]),A(e(L,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[R,["reseller","admin"]]]),e(V,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(f,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:a(()=>[e(C,{content:t.$t("actions.refresh")},{default:a(()=>[_("div",{class:"action-icon",onClick:N},[e(ie,{size:"18"})])]),_:1},8,["content"]),e(de,{onSelect:Z},{content:a(()=>[(p(!0),b(T,null,G(h(K),n=>(p(),E(ue,{key:n.value,value:n.value,class:ze({active:n.value===I.value})},{default:a(()=>[_("span",null,d(n.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(C,{content:t.$t("actions.density")},{default:a(()=>[_("div",aa,[e(re,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(C,{content:t.$t("actions.column_setting")},{default:a(()=>[e(fe,{trigger:"click",position:"bl",onPopupVisibleChange:ae},{content:a(()=>[_("div",na,[(p(!0),b(T,null,G(y.value,(n,be)=>(p(),b("div",{key:n.dataIndex,class:"setting"},[_("div",oa,[e(_e)]),_("div",null,[e(me,{modelValue:n.checked,"onUpdate:modelValue":x=>n.checked=x,onChange:x=>ee(x,n,be)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_("div",la,d(n.title==="#"?"\u5E8F\u5217\u53F7":n.title),1)]))),128))])]),default:a(()=>[_("div",ta,[e(pe,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(ve,{ref_key:"tableRef",ref:B,"row-key":"id",loading:h(O),pagination:w,columns:m.value,data:q.value,bordered:!1,size:I.value,"row-selection":j,onPageChange:X,onPageSizeChange:Y},{quota:a(({record:n})=>[v(d(n.quota>0?`$${h(H)(n.quota)}`:n.quota<0?`-$${h(H)(-n.quota)}`:"$0.00"),1)]),type:a(({record:n})=>[v(d(t.$t(`finance.dict.deal_type.${n.type?n.type:n.quota>0?1:2}`)),1)]),remark:a(({record:n})=>[v(d(n.remark||"-"),1)]),status:a(({record:n})=>[n.status===2?(p(),b("span",sa)):(p(),b("span",ca)),v(" "+d(t.$t(`finance.dict.status.${n.status}`)),1)]),_:1},8,["loading","pagination","columns","data","size","row-selection"])]),_:1})])}}});const Pa=Ie(ra,[["__scopeId","data-v-4a8ce803"]]);export{Pa as default};
