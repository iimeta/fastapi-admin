import{a as K,b as O,y as Z,_ as W}from"./index.9de64b69.js";/* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               */import{d as X,e as _,bF as Y,B as i,C,aH as e,aG as t,aL as f,aM as v,D as S,bu as ee,aD as c,u as s,aE as y,aJ as ae,aI as le,aZ as te,aK as oe,aF as ue,aS as re,b2 as se,b1 as de,bP as pe,aT as ie,bQ as ne,bR as me,bS as _e,bH as ce,bI as be,bT as fe,aU as ve,bi as ye,b5 as ge,bU as Ve,bV as qe,g as ke}from"./arco.088e2a49.js";import{u as we}from"./loading.6f488126.js";import{f as he}from"./vue.bd25b247.js";import{p as $e,d as De,a as n}from"./common.051a2527.js";import{d as Ue}from"./app.248f83ab.js";import{a as Ce}from"./model.36166e9e.js";import{q as Se}from"./group.7fd883fb.js";import{Q as p}from"./quota.dd3ce80a.js";import"./chart.0bfa65d3.js";const Fe={class:"container"},Be={class:"wrapper"},Ae={class:"submit-btn"},Le={name:"AppCreate"},Re=X({...Le,setup(He){const{loading:F,setLoading:m}=we(!1),{proxy:B}=ke(),A=he(),k=K(),L=O(),w=_([]);(async()=>{m(!0);try{const{data:a}=await Ce();w.value=a.items}catch{}finally{m(!1)}})();const h=_([]);(async()=>{m(!0);try{const{data:a}=await Se();h.value=a.items}catch{}finally{m(!1)}})();const $=_(),l=_({user_id:_(),name:"",models:[],is_limit_quota:!1,quota:_(),quota_expires_at:"",is_bind_group:!1,group:"",ip_whitelist:"",ip_blacklist:"",is_create_key:!0,remark:""}),R=async()=>{var o;if(!await((o=$.value)==null?void 0:o.validate())){m(!0);try{const{data:b}=await Ue(l.value);b.key?(navigator.clipboard.writeText(b.key),te.success("\u65B0\u5EFA\u6210\u529F, \u5BC6\u94A5\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")):B.$message.success("\u65B0\u5EFA\u6210\u529F"),A.push({name:"AppList"})}catch{}finally{m(!1)}}},H=a=>{l.value.quota=a};return(a,o)=>{const b=Z,g=oe,I=ue,D=re,r=se,T=de,Q=pe,V=ie,d=ne,G=me,M=_e,N=ce,E=be,q=fe,U=ve,P=ye,x=ge,z=Ve,j=qe,J=Y("permission");return i(),C("div",Fe,[e(I,{class:"container-breadcrumb"},{default:t(()=>[e(g,null,{default:t(()=>[e(b)]),_:1}),e(g,null,{default:t(()=>[f(v(a.$t("menu.app")),1)]),_:1}),e(g,null,{default:t(()=>[f(v(a.$t("menu.app.create")),1)]),_:1})]),_:1}),e(j,{loading:s(F),style:{width:"100%"}},{default:t(()=>[e(z,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:t(()=>[S("div",Be,[e(x,{ref_key:"formRef",ref:$,model:l.value,class:"form","label-col-props":{span:3},"wrapper-col-props":{span:21}},{default:t(()=>[ee((i(),c(r,{field:"user_id",label:a.$t("app.label.user_id"),rules:[{required:s(k).role==="reseller"||s(k).role==="admin",message:a.$t("app.error.user_id.required")}]},{default:t(()=>[e(D,{modelValue:l.value.user_id,"onUpdate:modelValue":o[0]||(o[0]=u=>l.value.user_id=u),placeholder:a.$t("app.placeholder.user_id"),precision:0,min:1},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])),[[J,["reseller","admin"]]]),e(r,{field:"name",label:a.$t("app.label.name"),rules:[{required:!0,message:a.$t("app.error.name.required")},{match:/^.{1,100}$/,message:a.$t("app.error.name.pattern")}]},{default:t(()=>[e(T,{modelValue:l.value.name,"onUpdate:modelValue":o[1]||(o[1]=u=>l.value.name=u),placeholder:a.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(r,{field:"models",label:a.$t("app.label.models")},{default:t(()=>[e(Q,{modelValue:l.value.models,"onUpdate:modelValue":o[2]||(o[2]=u=>l.value.models=u),placeholder:a.$t("app.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:w.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"])]),_:1},8,["label"]),e(r,{field:"is_limit_quota",label:a.$t("app.label.isLimitQuota")},{default:t(()=>[e(V,{modelValue:l.value.is_limit_quota,"onUpdate:modelValue":o[3]||(o[3]=u=>l.value.is_limit_quota=u)},null,8,["modelValue"])]),_:1},8,["label"]),l.value.is_limit_quota?(i(),c(r,{key:0,field:"quota",label:a.$t("app.label.quota"),rules:[{required:!0,message:a.$t("app.error.quota.required")}]},{default:t(()=>[e(D,{modelValue:l.value.quota,"onUpdate:modelValue":o[4]||(o[4]=u=>l.value.quota=u),placeholder:a.$t("app.placeholder.quota"),min:1e-6,max:9999999999999,parser:s($e),"allow-clear":""},{prefix:t(()=>[f(v(s(L).getCurrencySymbol),1)]),_:1},8,["modelValue","placeholder","min","parser"])]),_:1},8,["label","rules"])):y("",!0),l.value.is_limit_quota?(i(),c(r,{key:1},{default:t(()=>[e(G,{type:"button",onChange:H},{default:t(()=>[e(d,{value:10},{default:t(()=>[e(p,{"model-value":10})]),_:1}),e(d,{value:20},{default:t(()=>[e(p,{"model-value":20})]),_:1}),e(d,{value:50},{default:t(()=>[e(p,{"model-value":50})]),_:1}),e(d,{value:100},{default:t(()=>[e(p,{"model-value":100})]),_:1}),e(d,{value:200},{default:t(()=>[e(p,{"model-value":200})]),_:1}),e(d,{value:500},{default:t(()=>[e(p,{"model-value":500})]),_:1}),e(d,{value:1e3},{default:t(()=>[e(p,{"model-value":1e3})]),_:1}),e(d,{value:2e3},{default:t(()=>[e(p,{"model-value":2e3})]),_:1}),e(d,{value:5e3},{default:t(()=>[e(p,{"model-value":5e3})]),_:1}),e(d,{value:1e4},{default:t(()=>[e(p,{"model-value":1e4})]),_:1})]),_:1})]),_:1})):y("",!0),l.value.is_limit_quota?(i(),c(r,{key:2,field:"quota_expires_at",label:a.$t("app.label.quota_expires_at")},{default:t(()=>[e(M,{modelValue:l.value.quota_expires_at,"onUpdate:modelValue":o[5]||(o[5]=u=>l.value.quota_expires_at=u),placeholder:a.$t("app.placeholder.quota_expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":s(De),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>s(n)(l.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>s(n)(l.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>s(n)(l.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>s(n)(l.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>s(n)(l.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>s(n)(l.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>s(n)(l.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"])):y("",!0),e(r,{field:"is_bind_group",label:a.$t("app.label.is_bind_group")},{default:t(()=>[e(V,{modelValue:l.value.is_bind_group,"onUpdate:modelValue":o[6]||(o[6]=u=>l.value.is_bind_group=u)},null,8,["modelValue"])]),_:1},8,["label"]),l.value.is_bind_group?(i(),c(r,{key:3,field:"group",label:a.$t("app.label.group"),rules:[{required:!0,message:a.$t("app.error.group.required")}]},{default:t(()=>[e(E,{modelValue:l.value.group,"onUpdate:modelValue":o[7]||(o[7]=u=>l.value.group=u),placeholder:a.$t("app.placeholder.group"),scrollbar:!1,"allow-search":"","allow-clear":""},{default:t(()=>[(i(!0),C(ae,null,le(h.value,u=>(i(),c(N,{key:u.id,value:u.id,label:u.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):y("",!0),e(r,{field:"ip_whitelist",label:a.$t("app.label.ip_whitelist")},{default:t(()=>[e(q,{modelValue:l.value.ip_whitelist,"onUpdate:modelValue":o[8]||(o[8]=u=>l.value.ip_whitelist=u),placeholder:a.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(r,{field:"ip_blacklist",label:a.$t("app.label.ip_blacklist")},{default:t(()=>[e(q,{modelValue:l.value.ip_blacklist,"onUpdate:modelValue":o[9]||(o[9]=u=>l.value.ip_blacklist=u),placeholder:a.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(r,{field:"is_create_key",label:a.$t("app.label.is_create_key")},{default:t(()=>[e(V,{modelValue:l.value.is_create_key,"onUpdate:modelValue":o[10]||(o[10]=u=>l.value.is_create_key=u)},null,8,["modelValue"])]),_:1},8,["label"]),e(r,{field:"remark",label:a.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[e(q,{modelValue:l.value.remark,"onUpdate:modelValue":o[11]||(o[11]=u=>l.value.remark=u),placeholder:a.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(P,null,{default:t(()=>[S("div",Ae,[e(U,{type:"secondary",onClick:o[12]||(o[12]=u=>a.$router.push({name:"AppList"}))},{default:t(()=>[f(v(a.$t("button.cancel")),1)]),_:1}),e(U,{type:"primary",onClick:R},{default:t(()=>[f(v(a.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const ra=W(Re,[["__scopeId","data-v-879da3b0"]]);export{ra as default};
