import{c as ae,B as Oe,u as pe,_ as me,q as je,z as Ge,j as Je,A as Ke}from"./index.13181180.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css              */import{d as ve,e as h,w as te,B as a,C as _,aH as t,aG as e,u as s,aD as d,aL as y,aM as n,aE as ce,g as fe,bA as Qe,bB as Xe,ad as Ye,bC as Ze,bD as ke,bE as et,r as _e,c as Q,bF as tt,bu as X,aJ as Y,aI as Z,D as V,E as at,n as lt,as as ot,aK as st,aF as nt,bH as it,bI as dt,b2 as ut,bG as rt,aS as ct,b1 as _t,bJ as pt,bK as mt,b5 as vt,bL as ft,ab as kt,aU as bt,bi as yt,bj as gt,bl as ht,bm as wt,b4 as $t,bM as Ct,bO as Vt,aV as It,bU as xt}from"./arco.088e2a49.js";import{u as be}from"./loading.6f488126.js";import{f as Dt}from"./app.52fcafdd.js";import{c as ee,S as St}from"./sortable.esm.70bb3f9a.js";import{u as ye}from"./vue.bd25b247.js";/* empty css                *//* empty css                */import"./chart.0bfa65d3.js";function zt(S){return ae.post("/api/v1/task/video/page",S)}function Ft(S){return ae.get("/api/v1/task/video/detail",{params:S,paramsSerializer:B=>Oe.stringify(B)})}function Nt(S){return ae.post("/api/v1/task/video/copy/field",S)}const Lt={style:{margin:"10px 0 30px 10px"}},Ut={key:1},Bt={key:1},qt={key:1},At={key:1},Et={key:1},Pt={key:1},Tt={key:1},Rt={key:1},Wt={key:1},Ht={key:1},Mt={key:1},Ot={key:1},jt={key:1},Gt={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},Jt={key:1},Kt={key:1},Qt={key:1},Xt={key:1},Yt={key:1},Zt={key:1},ea={name:"TaskVideoDetail"},ta=ve({...ea,props:{id:{type:String,default:""}},setup(S){const B=S,{t:r}=pe(),{loading:v,setLoading:q}=be(!0),i=h({}),{copy:A,copied:p}=ye(),{proxy:P}=fe();(async(k={id:B.id})=>{q(!0);try{const{data:g}=await Ft(k);i.value=g}catch{}finally{q(!1)}})();const w=k=>{A(k)};te(p,()=>{p.value&&P.$message.success("\u590D\u5236\u6210\u529F")});const L=async(k,g)=>{const{data:m}=await Nt({id:k,field:g});A(m.value)},U=k=>k?k.startsWith("http://")||k.startsWith("https://")?k:window.location.origin+(k.startsWith("/")?k:`/${k}`):"";return(k,g)=>{const m=Qe,c=Xe,I=Ye,f=Ze,F=ke,T=et;return a(),_("div",Lt,[t(T,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:e(()=>[t(f,{label:s(r)("task.video.detail.label.trace_id"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Ut,[y(n(i.value.trace_id)+" ",1),t(I,{class:"copy-btn",onClick:g[0]||(g[0]=z=>w(i.value.trace_id))})]))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.creator"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Bt,[y(n(i.value.creator)+" ",1),t(I,{class:"copy-btn",onClick:g[1]||(g[1]=z=>L(i.value.id,"creator"))})]))]),_:1},8,["label"]),t(f,{label:s(r)("common.app_id")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",qt,n(i.value.app_id),1))]),_:1},8,["label"]),t(f,{label:s(r)("common.user_id")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",At,n(i.value.user_id),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.model")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Et,n(i.value.model),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.remixed_from_video_id")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Pt,n(i.value.remixed_from_video_id||"-"),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.video_id"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Tt,[y(n(i.value.video_id)+" ",1),t(I,{class:"copy-btn",onClick:g[2]||(g[2]=z=>w(i.value.video_id))})]))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.video_url"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Rt,[y(n(U(i.value.video_url)||"-")+" ",1),t(I,{class:"copy-btn",onClick:g[3]||(g[3]=z=>w(U(i.value.video_url)))})]))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.prompt"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Wt,n(i.value.prompt),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.width_height")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Ht,n(`${i.value.width} \xD7 ${i.value.height}`),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.seconds")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Mt,n(i.value.seconds),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.progress")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Ot,n(i.value.progress||0),1))]),_:1},8,["label"]),t(f,{label:s(r)("common.status")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",jt,[i.value.status==="completed"?(a(),d(F,{key:0,color:"green"},{default:e(()=>[y(n(k.$t(`task.dict.status.${i.value.status}`)),1)]),_:1})):i.value.status==="queued"?(a(),d(F,{key:1,color:"arcoblue"},{default:e(()=>[y(n(k.$t(`task.dict.status.${i.value.status}`)),1)]),_:1})):i.value.status==="in_progress"?(a(),d(F,{key:2,color:"orange"},{default:e(()=>[y(n(k.$t(`task.dict.status.${i.value.status}`)),1)]),_:1})):i.value.status==="failed"?(a(),d(F,{key:3,color:"red"},{default:e(()=>[y(n(k.$t(`task.dict.status.${i.value.status}`)),1)]),_:1})):(a(),d(F,{key:4,color:"gray"},{default:e(()=>[y(n(k.$t(`task.dict.status.${i.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.error"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Gt,n(i.value.error||"-"),1))]),_:1},8,["label"]),i.value.file_name?(a(),d(f,{key:0,label:s(r)("task.video.detail.label.file_name"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Jt,n(i.value.file_name),1))]),_:1},8,["label"])):ce("",!0),i.value.file_path?(a(),d(f,{key:1,label:s(r)("task.video.detail.label.file_path"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Kt,n(i.value.file_path),1))]),_:1},8,["label"])):ce("",!0),t(f,{label:s(r)("task.video.detail.label.completed_at")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Qt,n(i.value.completed_at||"-"),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.expires_at")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Xt,n(i.value.expires_at||"-"),1))]),_:1},8,["label"]),t(f,{label:s(r)("common.created_at")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Yt,n(i.value.created_at),1))]),_:1},8,["label"]),t(f,{label:s(r)("common.updated_at")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Zt,n(i.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const aa=me(ta,[["__scopeId","data-v-8a8b35e3"]]),la={class:"container"},oa={class:"action-icon"},sa={class:"action-icon"},na={id:"tableSetting"},ia={style:{"margin-right":"4px",cursor:"move"}},da={class:"title"},ua=["onClick"],ra=["onClick"],ca={name:"TaskVideoList"},_a=ve({...ca,setup(S){const{proxy:B}=fe(),r=localStorage.getItem("userRole"),v=_e({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),q=()=>({user_id:h(),app_id:h(),trace_id:"",video_id:"",video_url:"",status:h(),created_at:[]}),{loading:i,setLoading:A}=be(!0),{t:p}=pe(),P=h([]),b=h(q()),w=h([]),L=h([]),U=h("medium"),k=h(),g=h([]);r==="user"&&(async()=>{try{const{data:l}=await Dt();g.value=l.items}catch{}})();const c={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},I=_e({...c}),f=Q(()=>[{name:p("size.mini"),value:"mini"},{name:p("size.small"),value:"small"},{name:p("size.medium"),value:"medium"},{name:p("size.large"),value:"large"}]),F=Q(()=>[{title:p(r==="reseller"||r==="admin"?"task.columns.user_id":"task.columns.app_id"),dataIndex:r==="reseller"||r==="admin"?"user_id":"app_id",slotName:r==="reseller"||r==="admin"?"user_id":"app_id",align:"center",width:75},{title:p("task.columns.model"),dataIndex:"model",slotName:"model",align:"center"},{title:p("task.columns.video_id"),dataIndex:"video_id",slotName:"video_id",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.columns.width_height"),dataIndex:"width_height",slotName:"width_height",align:"center"},{title:p("task.columns.seconds"),dataIndex:"seconds",slotName:"seconds",align:"center"},{title:p("task.columns.video_url"),dataIndex:"video_url",slotName:"video_url",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.columns.status"),dataIndex:"status",slotName:"status",align:"center"},{title:p("task.columns.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:p("task.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),T=Q(()=>[{label:p("task.dict.status.queued"),value:"queued"},{label:p("task.dict.status.in_progress"),value:"in_progress"},{label:p("task.dict.status.completed"),value:"completed"},{label:p("task.dict.status.failed"),value:"failed"},{label:p("task.dict.status.expired"),value:"expired"}]);r==="admin"&&T.value.push({label:p("task.dict.status.deleted"),value:"deleted"});const z=async(l={...c})=>{A(!0);try{const{data:u}=await zt(l);P.value=u.items,I.current=l.current,I.pageSize=l.pageSize,I.total=u.paging.total}catch{}finally{A(!1)}},W=()=>{z({...c,...b.value})},ge=l=>{z({...c,...b.value,current:l})},he=l=>{c.pageSize=l,z({...c,...b.value})};z();const we=()=>{b.value=q(),W()},$e=(l,u)=>{U.value=l},Ce=(l,u,x)=>{l?w.value.splice(x,0,u):w.value=L.value.filter($=>$.dataIndex!==u.dataIndex)},le=(l,u,x,$=!1)=>{const D=$?ee(l):l;return u>-1&&x>-1&&D.splice(u,1,D.splice(x,1,D[u]).pop()),D},Ve=l=>{l&&lt(()=>{const u=document.getElementById("tableSetting");new St(u,{onEnd(x){const{oldIndex:$,newIndex:D}=x;le(w.value,$,D),le(L.value,$,D)}})})};te(()=>F.value,l=>{w.value=ee(l),w.value.forEach((u,x)=>{u.checked=!0}),L.value=ee(w.value)},{deep:!0,immediate:!0});const H=h(!1),oe=h(),Ie=l=>{H.value=!0,oe.value=l},xe=()=>{H.value=!1},{copy:De,copied:se}=ye(),ne=async l=>{De(l)};te(se,()=>{se.value&&B.$message.success("\u590D\u5236\u6210\u529F")});const ie=l=>l?l.startsWith("http://")||l.startsWith("https://")?l:window.location.origin+(l.startsWith("/")?l:`/${l}`):"";return(l,u)=>{const x=ot,$=st,D=nt,Se=it,de=dt,N=ut,C=rt,ze=ct,M=_t,Fe=pt,O=mt,Ne=vt,ue=ft,Le=kt,j=bt,re=je,Ue=yt,G=gt,Be=Ge,qe=ht,Ae=wt,Ee=Je,Pe=Ke,Te=$t,Re=Ct,E=ke,We=Vt,He=It,Me=xt,J=tt("permission");return a(),_("div",la,[t(D,{class:"container-breadcrumb"},{default:e(()=>[t($,null,{default:e(()=>[t(x)]),_:1}),t($,null,{default:e(()=>[y(n(l.$t("menu.task")),1)]),_:1}),t($,null,{default:e(()=>[y(n(l.$t("menu.task.video.list")),1)]),_:1})]),_:1}),t(Me,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:e(()=>[t(O,null,{default:e(()=>[t(C,{flex:1},{default:e(()=>[t(Ne,{model:b.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(O,{gutter:16},{default:e(()=>[X((a(),d(C,{span:8},{default:e(()=>[t(N,{field:"app_id",label:l.$t("task.form.app_id")},{default:e(()=>[t(de,{modelValue:b.value.app_id,"onUpdate:modelValue":u[0]||(u[0]=o=>b.value.app_id=o),placeholder:l.$t("task.form.selectDefault"),"allow-search":"","allow-clear":""},{default:e(()=>[(a(!0),_(Y,null,Z(g.value,o=>(a(),d(Se,{key:o.app_id,value:o.app_id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[J,["user"]]]),X((a(),d(C,{span:8},{default:e(()=>[t(N,{field:"user_id",label:l.$t("task.form.user_id")},{default:e(()=>[t(ze,{modelValue:b.value.user_id,"onUpdate:modelValue":u[1]||(u[1]=o=>b.value.user_id=o),placeholder:l.$t("task.form.user_id.placeholder"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[J,["reseller","admin"]]]),t(C,{span:8},{default:e(()=>[t(N,{field:"trace_id",label:l.$t("task.form.trace_id")},{default:e(()=>[t(M,{modelValue:b.value.trace_id,"onUpdate:modelValue":u[2]||(u[2]=o=>b.value.trace_id=o),placeholder:l.$t("task.form.trace_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(N,{field:"video_id",label:l.$t("task.form.video_id")},{default:e(()=>[t(M,{modelValue:b.value.video_id,"onUpdate:modelValue":u[3]||(u[3]=o=>b.value.video_id=o),placeholder:l.$t("task.form.video_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(N,{field:"video_url",label:l.$t("task.form.video_url")},{default:e(()=>[t(M,{modelValue:b.value.video_url,"onUpdate:modelValue":u[4]||(u[4]=o=>b.value.video_url=o),placeholder:l.$t("task.form.video_url.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(N,{field:"status",label:l.$t("task.form.status")},{default:e(()=>[t(de,{modelValue:b.value.status,"onUpdate:modelValue":u[5]||(u[5]=o=>b.value.status=o),options:s(T),placeholder:l.$t("task.form.selectDefault"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(N,{field:"created_at",label:l.$t("task.form.created_at")},{default:e(()=>[t(Fe,{modelValue:b.value.created_at,"onUpdate:modelValue":u[6]||(u[6]=o=>b.value.created_at=o),placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(ue,{style:{height:"84px"},direction:"vertical"}),t(C,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[t(Ue,{direction:"vertical",size:18},{default:e(()=>[t(j,{type:"primary",onClick:W},{icon:e(()=>[t(Le)]),default:e(()=>[y(" "+n(l.$t("task.form.search")),1)]),_:1}),t(j,{onClick:we},{icon:e(()=>[t(re)]),default:e(()=>[y(" "+n(l.$t("task.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),X(t(ue,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[J,["reseller","admin"]]]),t(O,{style:{"margin-bottom":"16px"}},{default:e(()=>[t(C,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:e(()=>[t(G,{content:l.$t("actions.refresh")},{default:e(()=>[V("div",{class:"action-icon",onClick:W},[t(re,{size:"18"})])]),_:1},8,["content"]),t(Ae,{onSelect:$e},{content:e(()=>[(a(!0),_(Y,null,Z(s(f),o=>(a(),d(qe,{key:o.value,value:o.value,class:at({active:o.value===U.value})},{default:e(()=>[V("span",null,n(o.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[t(G,{content:l.$t("actions.density")},{default:e(()=>[V("div",oa,[t(Be,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(G,{content:l.$t("actions.column_setting")},{default:e(()=>[t(Re,{trigger:"click",position:"bl",onPopupVisibleChange:Ve},{content:e(()=>[V("div",na,[(a(!0),_(Y,null,Z(L.value,(o,R)=>(a(),_("div",{key:o.dataIndex,class:"setting"},[V("div",ia,[t(Pe)]),V("div",null,[t(Te,{modelValue:o.checked,"onUpdate:modelValue":K=>o.checked=K,onChange:K=>Ce(K,o,R)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),V("div",da,n(o.title==="#"?"\u5E8F\u5217\u53F7":o.title),1)]))),128))])]),default:e(()=>[V("div",sa,[t(Ee,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(We,{ref_key:"tableRef",ref:k,"row-key":"id",loading:s(i),pagination:I,columns:w.value,data:P.value,bordered:!1,size:U.value,"row-selection":v,onPageChange:ge,onPageSizeChange:he},{video_id:e(({record:o})=>[V("span",{class:"copy-btn",onClick:R=>ne(o.video_id)},n(o.video_id||"-"),9,ua)]),width_height:e(({record:o})=>[y(n(`${o.width} \xD7 ${o.height}`),1)]),video_url:e(({record:o})=>[V("span",{class:"copy-btn",onClick:R=>ne(ie(o.video_url))},n(ie(o.video_url)||"-"),9,ra)]),status:e(({record:o})=>[o.status==="completed"?(a(),d(E,{key:0,color:"green"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="queued"?(a(),d(E,{key:1,color:"arcoblue"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="in_progress"?(a(),d(E,{key:2,color:"orange"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="failed"?(a(),d(E,{key:3,color:"red"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):(a(),d(E,{key:4,color:"gray"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024))]),operations:e(({record:o})=>[t(j,{type:"text",size:"small",onClick:R=>Ie(o.id)},{default:e(()=>[y(n(l.$t("task.columns.operations.view")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),t(He,{title:l.$t("menu.task.video.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:H.value,onCancel:xe},{default:e(()=>[t(aa,{id:oe.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const Aa=me(_a,[["__scopeId","data-v-c2388f48"]]);export{Aa as default};
