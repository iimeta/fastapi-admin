import{u as ce,_ as re,q as He,z as Me,j as Oe,A as je}from"./index.9eceab3a.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css              */import{d as _e,e as w,w as ae,B as t,C as r,aH as a,aG as e,u as o,aD as u,aL as m,aM as i,aE as Ge,g as pe,bA as Je,bB as Ke,ad as Qe,bC as We,bD as me,bE as Xe,r as de,c as W,bF as Ye,bu as X,aJ as Y,aI as Z,D as C,E as Ze,n as ea,as as aa,aK as ta,aF as la,bH as sa,bI as oa,b2 as na,bG as ia,aS as ua,b1 as da,bJ as ca,bK as ra,b5 as _a,bL as pa,ab as ma,aU as fa,bi as ba,bj as ka,bl as va,bm as ha,b4 as ya,bM as ga,bO as $a,aV as wa,bU as Ca}from"./arco.088e2a49.js";import{u as fe}from"./loading.6f488126.js";import{f as Va}from"./app.af8cc499.js";import{d as Ia,e as Da,g as za}from"./task.98166147.js";import{c as ee,S as xa}from"./sortable.esm.70bb3f9a.js";import{u as be}from"./vue.bd25b247.js";/* empty css                *//* empty css                */import"./chart.0bfa65d3.js";const Sa={style:{margin:"10px 0 30px 10px"}},Fa={key:1},Ba={key:1},La={key:1},Na={key:1},Ua={key:1},Aa={key:1},Ea={key:1},Pa={key:1},Ta={key:1},Ra={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},qa={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},Ha={key:1},Ma={key:1},Oa={key:1},ja={key:1},Ga={key:1},Ja={key:1},Ka={key:1},Qa={key:1},Wa={name:"TaskBatchDetail"},Xa=_e({...Wa,props:{id:{type:String,default:""}},setup(te){const T=te,{t:c}=ce(),{loading:b,setLoading:N}=fe(!0),n=w({}),{copy:U,copied:f}=be(),{proxy:E}=pe();(async(y={id:T.id})=>{N(!0);try{const{data:h}=await Ia(y);n.value=h}catch{}finally{N(!1)}})();const g=y=>{U(y)};ae(f,()=>{f.value&&E.$message.success("\u590D\u5236\u6210\u529F")});const B=async(y,h)=>{const{data:_}=await Da({id:y,field:h});U(_.value)};return(y,h)=>{const _=Je,v=Ke,$=Qe,p=We,x=me,R=Xe;return t(),r("div",Sa,[a(R,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:e(()=>[a(p,{label:o(c)("task.batch.detail.label.trace_id"),span:2},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Fa,[m(i(n.value.trace_id)+" ",1),a($,{class:"copy-btn",onClick:h[0]||(h[0]=S=>g(n.value.trace_id))})]))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.creator"),span:2},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ba,[m(i(n.value.creator)+" ",1),a($,{class:"copy-btn",onClick:h[1]||(h[1]=S=>B(n.value.id,"creator"))})]))]),_:1},8,["label"]),a(p,{label:o(c)("common.app_id")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",La,i(n.value.app_id),1))]),_:1},8,["label"]),a(p,{label:o(c)("common.user_id")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Na,i(n.value.user_id),1))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.model")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ua,i(n.value.model),1))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.batch_id"),span:2},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Aa,[m(i(n.value.batch_id)+" ",1),a($,{class:"copy-btn",onClick:h[2]||(h[2]=S=>g(n.value.batch_id))})]))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.input_file_id"),span:2},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ea,[m(i(n.value.input_file_id)+" ",1),a($,{class:"copy-btn",onClick:h[3]||(h[3]=S=>g(n.value.input_file_id))})]))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.output_file_id"),span:2},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Pa,[m(i(n.value.output_file_id)+" ",1),a($,{class:"copy-btn",onClick:h[4]||(h[4]=S=>g(n.value.output_file_id))})]))]),_:1},8,["label"]),n.value.error_file_id?(t(),u(p,{key:0,label:o(c)("task.batch.detail.label.error_file_id"),span:2},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ta,[m(i(n.value.error_file_id)+" ",1),a($,{class:"copy-btn",onClick:h[5]||(h[5]=S=>g(n.value.error_file_id))})]))]),_:1},8,["label"])):Ge("",!0),a(p,{label:o(c)("task.batch.detail.label.response_data"),span:2},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ra,i(n.value.response_data||"-"),1))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.error"),span:2},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",qa,i(n.value.error||"-"),1))]),_:1},8,["label"]),a(p,{label:o(c)("common.status")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ha,[n.value.status==="completed"?(t(),u(x,{key:0,color:"green"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="finalizing"?(t(),u(x,{key:1,color:"green"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="validating"?(t(),u(x,{key:2,color:"arcoblue"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="in_progress"?(t(),u(x,{key:3,color:"orange"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="failed"?(t(),u(x,{key:4,color:"red"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):(t(),u(x,{key:5,color:"gray"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.in_progress_at")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ma,i(n.value.in_progress_at||"-"),1))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.finalizing_at")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Oa,i(n.value.finalizing_at||"-"),1))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.completed_at")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",ja,i(n.value.completed_at||"-"),1))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.expires_at")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ga,i(n.value.expires_at||"-"),1))]),_:1},8,["label"]),a(p,{label:o(c)("task.batch.detail.label.cancelled_at")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ja,i(n.value.cancelled_at||n.value.cancelling_at||"-"),1))]),_:1},8,["label"]),a(p,{label:o(c)("common.created_at")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Ka,i(n.value.created_at),1))]),_:1},8,["label"]),a(p,{label:o(c)("common.updated_at")},{default:e(()=>[o(b)?(t(),u(v,{key:0,animation:!0},{default:e(()=>[a(_,{rows:1})]),_:1})):(t(),r("span",Qa,i(n.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const Ya=re(Xa,[["__scopeId","data-v-47f9fa2c"]]),Za={class:"container"},et={class:"action-icon"},at={class:"action-icon"},tt={id:"tableSetting"},lt={style:{"margin-right":"4px",cursor:"move"}},st={class:"title"},ot=["onClick"],nt=["onClick"],it=["onClick"],ut={name:"TaskBatchList"},dt=_e({...ut,setup(te){const{proxy:T}=pe(),c=localStorage.getItem("userRole"),b=de({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),N=()=>({user_id:w(),app_id:w(),trace_id:"",batch_id:"",file_id:"",status:w(),created_at:[]}),{loading:n,setLoading:U}=fe(!0),{t:f}=ce(),E=w([]),k=w(N()),g=w([]),B=w([]),y=w("medium"),h=w(),_=w([]);c==="user"&&(async()=>{try{const{data:l}=await Va();_.value=l.items}catch{}})();const $={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},p=de({...$}),x=W(()=>[{name:f("size.mini"),value:"mini"},{name:f("size.small"),value:"small"},{name:f("size.medium"),value:"medium"},{name:f("size.large"),value:"large"}]),R=W(()=>[{title:f(c==="reseller"||c==="admin"?"task.columns.user_id":"task.columns.app_id"),dataIndex:c==="reseller"||c==="admin"?"user_id":"app_id",slotName:c==="reseller"||c==="admin"?"user_id":"app_id",align:"center",width:75},{title:f("task.columns.model"),dataIndex:"model",slotName:"model",align:"center"},{title:f("task.columns.batch_id"),dataIndex:"batch_id",slotName:"batch_id",align:"center",ellipsis:!0,tooltip:!0},{title:f("task.columns.input_file_id"),dataIndex:"input_file_id",slotName:"input_file_id",align:"center",ellipsis:!0,tooltip:!0},{title:f("task.columns.output_file_id"),dataIndex:"output_file_id",slotName:"output_file_id",align:"center",ellipsis:!0,tooltip:!0},{title:f("task.columns.status"),dataIndex:"status",slotName:"status",align:"center"},{title:f("task.columns.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:f("task.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),S=W(()=>[{label:f("task.dict.status.queued"),value:"queued"},{label:f("task.dict.status.in_progress"),value:"in_progress"},{label:f("task.dict.status.completed"),value:"completed"},{label:f("task.dict.status.failed"),value:"failed"},{label:f("task.dict.status.expired"),value:"expired"}]);c==="admin"&&S.value.push({label:f("task.dict.status.deleted"),value:"deleted"});const P=async(l={...$})=>{U(!0);try{const{data:d}=await za(l);E.value=d.items,p.current=l.current,p.pageSize=l.pageSize,p.total=d.paging.total}catch{}finally{U(!1)}},q=()=>{P({...$,...k.value})},ke=l=>{P({...$,...k.value,current:l})},ve=l=>{$.pageSize=l,P({...$,...k.value})};P();const he=()=>{k.value=N(),q()},ye=(l,d)=>{y.value=l},ge=(l,d,D)=>{l?g.value.splice(D,0,d):g.value=B.value.filter(V=>V.dataIndex!==d.dataIndex)},le=(l,d,D,V=!1)=>{const z=V?ee(l):l;return d>-1&&D>-1&&z.splice(d,1,z.splice(D,1,z[d]).pop()),z},$e=l=>{l&&ea(()=>{const d=document.getElementById("tableSetting");new xa(d,{onEnd(D){const{oldIndex:V,newIndex:z}=D;le(g.value,V,z),le(B.value,V,z)}})})};ae(()=>R.value,l=>{g.value=ee(l),g.value.forEach((d,D)=>{d.checked=!0}),B.value=ee(g.value)},{deep:!0,immediate:!0});const H=w(!1),se=w(),we=l=>{H.value=!0,se.value=l},Ce=()=>{H.value=!1},{copy:Ve,copied:oe}=be(),M=async l=>{Ve(l)};return ae(oe,()=>{oe.value&&T.$message.success("\u590D\u5236\u6210\u529F")}),(l,d)=>{const D=aa,V=ta,z=la,Ie=sa,ne=oa,F=na,I=ia,De=ua,O=da,ze=ca,j=ra,xe=_a,ie=pa,Se=ma,G=fa,ue=He,Fe=ba,J=ka,Be=Me,Le=va,Ne=ha,Ue=Oe,Ae=je,Ee=ya,Pe=ga,L=me,Te=$a,Re=wa,qe=Ca,K=Ye("permission");return t(),r("div",Za,[a(z,{class:"container-breadcrumb"},{default:e(()=>[a(V,null,{default:e(()=>[a(D)]),_:1}),a(V,null,{default:e(()=>[m(i(l.$t("menu.task")),1)]),_:1}),a(V,null,{default:e(()=>[m(i(l.$t("menu.task.batch.list")),1)]),_:1})]),_:1}),a(qe,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:e(()=>[a(j,null,{default:e(()=>[a(I,{flex:1},{default:e(()=>[a(xe,{model:k.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[a(j,{gutter:16},{default:e(()=>[X((t(),u(I,{span:8},{default:e(()=>[a(F,{field:"app_id",label:l.$t("task.form.app_id")},{default:e(()=>[a(ne,{modelValue:k.value.app_id,"onUpdate:modelValue":d[0]||(d[0]=s=>k.value.app_id=s),placeholder:l.$t("task.form.selectDefault"),"allow-search":"","allow-clear":""},{default:e(()=>[(t(!0),r(Y,null,Z(_.value,s=>(t(),u(Ie,{key:s.app_id,value:s.app_id,label:s.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[K,["user"]]]),X((t(),u(I,{span:8},{default:e(()=>[a(F,{field:"user_id",label:l.$t("task.form.user_id")},{default:e(()=>[a(De,{modelValue:k.value.user_id,"onUpdate:modelValue":d[1]||(d[1]=s=>k.value.user_id=s),placeholder:l.$t("task.form.user_id.placeholder"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[K,["reseller","admin"]]]),a(I,{span:8},{default:e(()=>[a(F,{field:"trace_id",label:l.$t("task.form.trace_id")},{default:e(()=>[a(O,{modelValue:k.value.trace_id,"onUpdate:modelValue":d[2]||(d[2]=s=>k.value.trace_id=s),placeholder:l.$t("task.form.trace_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(I,{span:8},{default:e(()=>[a(F,{field:"batch_id",label:l.$t("task.form.batch_id")},{default:e(()=>[a(O,{modelValue:k.value.batch_id,"onUpdate:modelValue":d[3]||(d[3]=s=>k.value.batch_id=s),placeholder:l.$t("task.form.batch_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(I,{span:8},{default:e(()=>[a(F,{field:"file_id",label:l.$t("task.form.file_id")},{default:e(()=>[a(O,{modelValue:k.value.file_id,"onUpdate:modelValue":d[4]||(d[4]=s=>k.value.file_id=s),placeholder:l.$t("task.form.file_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(I,{span:8},{default:e(()=>[a(F,{field:"status",label:l.$t("task.form.status")},{default:e(()=>[a(ne,{modelValue:k.value.status,"onUpdate:modelValue":d[5]||(d[5]=s=>k.value.status=s),options:o(S),placeholder:l.$t("task.form.selectDefault"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),a(I,{span:8},{default:e(()=>[a(F,{field:"created_at",label:l.$t("task.form.created_at")},{default:e(()=>[a(ze,{modelValue:k.value.created_at,"onUpdate:modelValue":d[6]||(d[6]=s=>k.value.created_at=s),placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(ie,{style:{height:"84px"},direction:"vertical"}),a(I,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[a(Fe,{direction:"vertical",size:18},{default:e(()=>[a(G,{type:"primary",onClick:q},{icon:e(()=>[a(Se)]),default:e(()=>[m(" "+i(l.$t("task.form.search")),1)]),_:1}),a(G,{onClick:he},{icon:e(()=>[a(ue)]),default:e(()=>[m(" "+i(l.$t("task.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),X(a(ie,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[K,["reseller","admin"]]]),a(j,{style:{"margin-bottom":"16px"}},{default:e(()=>[a(I,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:e(()=>[a(J,{content:l.$t("actions.refresh")},{default:e(()=>[C("div",{class:"action-icon",onClick:q},[a(ue,{size:"18"})])]),_:1},8,["content"]),a(Ne,{onSelect:ye},{content:e(()=>[(t(!0),r(Y,null,Z(o(x),s=>(t(),u(Le,{key:s.value,value:s.value,class:Ze({active:s.value===y.value})},{default:e(()=>[C("span",null,i(s.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[a(J,{content:l.$t("actions.density")},{default:e(()=>[C("div",et,[a(Be,{size:"18"})])]),_:1},8,["content"])]),_:1}),a(J,{content:l.$t("actions.column_setting")},{default:e(()=>[a(Pe,{trigger:"click",position:"bl",onPopupVisibleChange:$e},{content:e(()=>[C("div",tt,[(t(!0),r(Y,null,Z(B.value,(s,A)=>(t(),r("div",{key:s.dataIndex,class:"setting"},[C("div",lt,[a(Ae)]),C("div",null,[a(Ee,{modelValue:s.checked,"onUpdate:modelValue":Q=>s.checked=Q,onChange:Q=>ge(Q,s,A)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),C("div",st,i(s.title==="#"?"\u5E8F\u5217\u53F7":s.title),1)]))),128))])]),default:e(()=>[C("div",at,[a(Ue,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),a(Te,{ref_key:"tableRef",ref:h,"row-key":"id",loading:o(n),pagination:p,columns:g.value,data:E.value,bordered:!1,size:y.value,"row-selection":b,onPageChange:ke,onPageSizeChange:ve},{batch_id:e(({record:s})=>[C("span",{class:"copy-btn",onClick:A=>M(s.batch_id)},i(s.batch_id||"-"),9,ot)]),input_file_id:e(({record:s})=>[C("span",{class:"copy-btn",onClick:A=>M(s.input_file_id)},i(s.input_file_id||"-"),9,nt)]),output_file_id:e(({record:s})=>[C("span",{class:"copy-btn",onClick:A=>M(s.output_file_id)},i(s.output_file_id||"-"),9,it)]),status:e(({record:s})=>[s.status==="completed"?(t(),u(L,{key:0,color:"green"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):s.status==="finalizing"?(t(),u(L,{key:1,color:"green"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):s.status==="validating"?(t(),u(L,{key:2,color:"arcoblue"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):s.status==="in_progress"?(t(),u(L,{key:3,color:"orange"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):s.status==="failed"?(t(),u(L,{key:4,color:"red"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):(t(),u(L,{key:5,color:"gray"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024))]),operations:e(({record:s})=>[a(G,{type:"text",size:"small",onClick:A=>we(s.id)},{default:e(()=>[m(i(l.$t("task.columns.operations.view")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),a(Re,{title:l.$t("menu.task.batch.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:H.value,onCancel:Ce},{default:e(()=>[a(Ya,{id:se.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const Ut=re(dt,[["__scopeId","data-v-126c652a"]]);export{Ut as default};
