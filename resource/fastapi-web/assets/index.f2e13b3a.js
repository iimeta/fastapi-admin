import{_ as I,A as x}from"./index.19b4a1ac.js";/* empty css               *//* empty css                */import{d as R,e as q,B as _,aD as h,aG as t,aH as a,aL as p,aM as b,b1 as W,b2 as N,bK as T,aU as U,b5 as M,C as L,aJ as X,aI as Y,F as z,aE as A,u as $,bR as k,bA as Z,bB as ee,aT as ae,aS as te,bS as le,bT as oe,bU as se,bi as j,bz as ne,bs as ue,aK as pe,aF as re,bL as ie,bM as de,bJ as _e,bN as me}from"./arco.4a860a7b.js";import{u as B}from"./loading.e639bbf4.js";import{e as K,f as ce}from"./app.714dbae3.js";/* empty css               *//* empty css               *//* empty css                */import{h as Q}from"./vue.2ee6e12c.js";/* empty css                *//* empty css               *//* empty css               *//* empty css              *//* empty css                *//* empty css              *//* empty css               *//* empty css               */import{q as fe}from"./model.89a8fa19.js";/* empty css                */import"./chart.e67bf0c7.js";import"./base.87fcf6e2.js";const be=R({__name:"base-info",emits:["changeStep"],setup(v,{emit:f}){const{setLoading:m}=B(!1),r=Q(),c=q(),d=q({id:"",name:"",remark:"",status:1});(async(n={id:r.query.id})=>{m(!0);try{const{data:i}=await K(n);d.value.id=i.id,d.value.name=i.name,d.value.remark=i.remark,d.value.status=i.status}catch{}finally{m(!1)}})();const e=async()=>{var i;await((i=c.value)==null?void 0:i.validate())||f("changeStep","forward",{...d.value})};return(n,i)=>{const V=W,S=N,l=T,o=U,g=M;return _(),h(g,{ref_key:"formRef",ref:c,model:d.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[a(S,{field:"name",label:n.$t("app.label.name"),rules:[{required:!0,message:n.$t("app.error.name.required")},{match:/^.{1,100}$/,message:n.$t("app.error.name.pattern")}]},{default:t(()=>[a(V,{modelValue:d.value.name,"onUpdate:modelValue":i[0]||(i[0]=s=>d.value.name=s),placeholder:n.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(S,{field:"remark",label:n.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[a(l,{modelValue:d.value.remark,"onUpdate:modelValue":i[1]||(i[1]=s=>d.value.remark=s),placeholder:n.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(S,null,{default:t(()=>[a(o,{type:"primary",onClick:e},{default:t(()=>[p(b(n.$t("app.button.next")),1)]),_:1})]),_:1})]),_:1},8,["model"])}}});const ve=I(be,[["__scopeId","data-v-424bd0c4"]]),ye=R({__name:"advanced",emits:["changeStep"],setup(v,{emit:f}){const{setLoading:m}=B(!0),r=Q(),c=q([]);(async()=>{m(!0);try{const{data:l}=await fe();c.value=l.items}catch{}finally{m(!1)}})();const w=q(),e=q({models:[],is_limit_quota:!1,quota:q(),quota_expires_at:"",ip_whitelist:"",ip_blacklist:""}),n=l=>{e.value.quota=l*5e5};(async(l={id:r.query.id})=>{var o,g;m(!0);try{const{data:s}=await K(l);e.value.models=s.models,e.value.is_limit_quota=s.is_limit_quota,e.value.quota=s.quota,e.value.quota_expires_at=s.quota_expires_at,e.value.ip_whitelist=((o=s==null?void 0:s.ip_whitelist)==null?void 0:o.join(`
`))||"",e.value.ip_blacklist=((g=s==null?void 0:s.ip_blacklist)==null?void 0:g.join(`
`))||""}catch{}finally{m(!1)}})();const V=async()=>{var o;await((o=w.value)==null?void 0:o.validate())||f("changeStep","submit",{...e.value})},S=()=>{f("changeStep","backward")};return(l,o)=>{const g=Z,s=ee,y=N,E=ae,G=te,C=le,J=oe,P=se,D=T,F=U,H=j,O=M;return _(),h(O,{ref_key:"formRef",ref:w,model:e.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[a(y,{field:"models",label:l.$t("app.label.models")},{default:t(()=>[a(s,{modelValue:e.value.models,"onUpdate:modelValue":o[0]||(o[0]=u=>e.value.models=u),placeholder:l.$t("app.placeholder.models"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:t(()=>[(_(!0),L(X,null,Y(c.value,u=>(_(),h(g,{key:u.id,value:u.id,label:u.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(y,{field:"is_limit_quota",label:l.$t("app.label.isLimitQuota")},{default:t(()=>[a(E,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":o[1]||(o[1]=u=>e.value.is_limit_quota=u)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(_(),h(y,{key:0,field:"quota",label:l.$t("app.label.quota"),rules:[{required:!0,message:l.$t("app.error.quota.required")}]},{default:t(()=>[a(G,{modelValue:e.value.quota,"onUpdate:modelValue":o[2]||(o[2]=u=>e.value.quota=u),placeholder:l.$t("app.placeholder.quota"),precision:0,min:0,max:9999999999999,style:{"margin-right":"10px"}},null,8,["modelValue","placeholder"]),z("div",null," $"+b(e.value.quota?parseFloat((e.value.quota/5e5).toFixed(6)):"0"),1)]),_:1},8,["label","rules"])):A("",!0),e.value.is_limit_quota?(_(),h(y,{key:1},{default:t(()=>[a(J,{type:"button",onChange:n},{default:t(()=>[a(C,{value:1},{default:t(()=>[p(" $1 ")]),_:1}),a(C,{value:5},{default:t(()=>[p(" $5 ")]),_:1}),a(C,{value:10},{default:t(()=>[p(" $10 ")]),_:1}),a(C,{value:20},{default:t(()=>[p(" $20 ")]),_:1}),a(C,{value:100},{default:t(()=>[p(" $100 ")]),_:1}),a(C,{value:500},{default:t(()=>[p(" $500 ")]),_:1}),a(C,{value:1e3},{default:t(()=>[p(" $1000 ")]),_:1})]),_:1},8,["onChange"])]),_:1})):A("",!0),e.value.is_limit_quota?(_(),h(y,{key:2,field:"quota_expires_at",label:l.$t("app.label.quota_expires_at")},{default:t(()=>[a(P,{modelValue:e.value.quota_expires_at,"onUpdate:modelValue":o[3]||(o[3]=u=>e.value.quota_expires_at=u),placeholder:l.$t("app.placeholder.quota_expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":u=>$(k)(u).isBefore($(k)()),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>$(k)().add(1,"day")},{label:"7",value:()=>$(k)().add(7,"day")},{label:"15",value:()=>$(k)().add(15,"day")},{label:"30",value:()=>$(k)().add(30,"day")},{label:"90",value:()=>$(k)().add(90,"day")},{label:"180",value:()=>$(k)().add(180,"day")},{label:"365",value:()=>$(k)().add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"])):A("",!0),a(y,{field:"ip_whitelist",label:l.$t("app.label.ip_whitelist")},{default:t(()=>[a(D,{modelValue:e.value.ip_whitelist,"onUpdate:modelValue":o[4]||(o[4]=u=>e.value.ip_whitelist=u),placeholder:l.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(y,{field:"ip_blacklist",label:l.$t("app.label.ip_blacklist")},{default:t(()=>[a(D,{modelValue:e.value.ip_blacklist,"onUpdate:modelValue":o[5]||(o[5]=u=>e.value.ip_blacklist=u),placeholder:l.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(y,null,{default:t(()=>[a(H,null,{default:t(()=>[a(F,{type:"secondary",onClick:S},{default:t(()=>[p(b(l.$t("model.button.prev")),1)]),_:1}),a(F,{type:"primary",onClick:V},{default:t(()=>[p(b(l.$t("model.button.next")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])}}});const $e=I(ye,[["__scopeId","data-v-d64349d2"]]);const he={},ke={class:"success-wrap"};function ge(v,f){const m=ne,r=U,c=j;return _(),L("div",ke,[a(m,{status:"success",title:v.$t("app.success.title"),subtitle:v.$t("app.success.update.subTitle")},null,8,["title","subtitle"]),a(c,{size:16},{default:t(()=>[a(r,{key:"finish",type:"secondary",onClick:f[0]||(f[0]=d=>v.$router.push({name:"AppList"}))},{default:t(()=>[p(b(v.$t("app.button.return")),1)]),_:1}),a(r,{key:"again",type:"primary",onClick:f[1]||(f[1]=d=>v.$router.push({name:"AppDetail",query:{id:`${v.$route.query.id}`}}))},{default:t(()=>[p(b(v.$t("app.button.view")),1)]),_:1})]),_:1})])}const qe=I(he,[["render",ge],["__scopeId","data-v-04d88f29"]]),we={class:"container"},Ve={class:"wrapper"},Se={name:"AppUpdate"},Ce=R({...Se,setup(v){const{loading:f,setLoading:m}=B(!1),r=q(1),c=q({}),d=async()=>{m(!0);try{await ce(c.value),r.value=3,c.value={}}catch{}finally{m(!1)}},w=(e,n)=>{if(typeof e=="number"){r.value=e;return}if(e==="forward"||e==="submit"){if(c.value={...c.value,...n},e==="submit"){d();return}r.value+=1}else e==="backward"&&(r.value-=1)};return(e,n)=>{const i=x,V=pe,S=re,l=ie,o=de,g=_e,s=me;return _(),L("div",we,[a(S,{class:"container-breadcrumb"},{default:t(()=>[a(V,null,{default:t(()=>[a(i)]),_:1}),a(V,null,{default:t(()=>[p(b(e.$t("menu.app")),1)]),_:1}),a(V,null,{default:t(()=>[p(b(e.$t("menu.app.update")),1)]),_:1})]),_:1}),a(s,{loading:$(f),style:{width:"100%"}},{default:t(()=>[a(g,{class:"general-card",bordered:!1},{default:t(()=>[z("div",Ve,[a(o,{current:r.value,"onUpdate:current":n[0]||(n[0]=y=>r.value=y),style:{width:"660px"},"line-less":"",class:"steps"},{default:t(()=>[a(l,{description:e.$t("app.subTitle.baseInfo")},{default:t(()=>[p(b(e.$t("app.title.baseInfo")),1)]),_:1},8,["description"]),a(l,{description:e.$t("app.subTitle.advanced")},{default:t(()=>[p(b(e.$t("app.title.advanced")),1)]),_:1},8,["description"]),a(l,{description:e.$t("app.subTitle.update.finish")},{default:t(()=>[p(b(e.$t("app.title.update.finish")),1)]),_:1},8,["description"])]),_:1},8,["current"]),(_(),h(ue,null,[r.value===1?(_(),h(ve,{key:0,onChangeStep:w})):r.value===2?(_(),h($e,{key:1,onChangeStep:w})):r.value===3?(_(),h(qe,{key:2,onChangeStep:w})):A("",!0)],1024))])]),_:1})]),_:1},8,["loading"])])}}});const We=I(Ce,[["__scopeId","data-v-55a5e2c0"]]);export{We as default};
