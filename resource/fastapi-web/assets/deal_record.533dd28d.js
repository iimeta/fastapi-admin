import{u as ge,G as he,s as ye,A as we,k as ke,B as Ie,_ as Se}from"./index.d4c38361.js";/* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css              */import{d as Ve,r as A,e as d,c as I,w as Ce,bF as xe,B as u,C as b,aH as e,aG as a,aL as g,aM as p,bu as F,aD as T,u as S,D as m,aJ as E,aI as G,E as ze,n as $e,aK as De,aF as Be,aS as Ne,b2 as Pe,bG as Le,bI as qe,bJ as Re,bK as Ue,b5 as Ae,bL as Fe,ab as Te,aU as Ee,bi as Ge,bj as Oe,bk as je,bl as He,b4 as Je,bM as Ke,bN as Me,bT as Qe}from"./arco.3f46b4ae.js";import{u as We}from"./loading.37fd256d.js";import{c as $,S as Xe}from"./sortable.esm.078712c4.js";import{b as Ye}from"./finance.430b9c74.js";import{Q as Ze}from"./quota.c249bcdc.js";import"./chart.2cea905d.js";import"./vue.dbcf9bc3.js";import"./common.cfd92899.js";const ea={class:"container"},aa={class:"action-icon"},ta={class:"action-icon"},na={id:"tableSetting"},oa={style:{"margin-right":"4px",cursor:"move"}},la={class:"title"},sa={key:0,class:"circle red"},ca={key:1,class:"circle"},ia={name:"DealRecordList"},ra=Ve({...ia,setup(da){const{loading:O,setLoading:D}=We(!0),{t:l}=ge(),j=A({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),H=()=>({user_id:d(),type:d(),status:d(),created_at:[]}),B=d([]),s=d(H()),_=d([]),h=d([]),V=d("medium"),N=d(),v={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},y=A({...v}),J=I(()=>[{name:l("size.mini"),value:"mini"},{name:l("size.small"),value:"small"},{name:l("size.medium"),value:"medium"},{name:l("size.large"),value:"large"}]),K=I(()=>[{title:l("common.user_id"),dataIndex:"user_id",slotName:"user_id",align:"center"},{title:l("common.quota"),dataIndex:"quota",slotName:"quota",align:"center"},{title:l("common.type"),dataIndex:"type",slotName:"type",align:"center"},{title:l("common.status"),dataIndex:"status",slotName:"status",align:"center"},{title:l("finance.columns.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center"}]),M=I(()=>[{label:l("finance.dict.deal_type.1"),value:1},{label:l("finance.dict.deal_type.2"),value:2},{label:l("finance.dict.deal_type.3"),value:3},{label:l("finance.dict.deal_type.4"),value:4}]),Q=I(()=>[{label:l("finance.dict.status.1"),value:1},{label:l("finance.dict.status.2"),value:2},{label:l("finance.dict.status.3"),value:3}]),w=async(t={...v})=>{D(!0);try{const{data:o}=await Ye(t);B.value=o.items,y.current=t.current,y.pageSize=t.pageSize,y.total=o.paging.total}catch{}finally{D(!1),N.value.selectAll(!1)}};w();const P=()=>{w({...v,...s.value})},W=t=>{w({...v,...s.value,current:t})},X=t=>{v.pageSize=t,w({...v,...s.value})},Y=(t,o)=>{V.value=t},Z=(t,o,i)=>{t?_.value.splice(i,0,o):_.value=h.value.filter(c=>c.dataIndex!==o.dataIndex)},L=(t,o,i,c=!1)=>{const r=c?$(t):t;return o>-1&&i>-1&&r.splice(o,1,r.splice(i,1,r[o]).pop()),r},ee=t=>{t&&$e(()=>{const o=document.getElementById("tableSetting");new Xe(o,{onEnd(i){const{oldIndex:c,newIndex:r}=i;L(_.value,c,r),L(h.value,c,r)}})})};return Ce(()=>K.value,t=>{_.value=$(t),_.value.forEach((o,i)=>{o.checked=!0}),h.value=$(_.value)},{deep:!0,immediate:!0}),(t,o)=>{const i=he,c=De,r=Be,ae=Ne,k=Pe,f=Le,q=qe,te=Re,C=Ue,ne=Ae,R=Fe,oe=Te,le=Ee,se=Ge,ce=ye,x=Oe,ie=we,re=je,de=He,ue=ke,pe=Ie,me=Je,_e=Ke,fe=Me,ve=Qe,U=xe("permission");return u(),b("div",ea,[e(r,{class:"container-breadcrumb"},{default:a(()=>[e(c,null,{default:a(()=>[e(i)]),_:1}),e(c,null,{default:a(()=>[g(p(t.$t("finance.menu")),1)]),_:1}),e(c,null,{default:a(()=>[g(p(t.$t("finance.menu.deal_record")),1)]),_:1})]),_:1}),e(ve,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:a(()=>[F((u(),T(C,null,{default:a(()=>[e(f,{flex:1},{default:a(()=>[e(ne,{model:s.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(C,{gutter:16},{default:a(()=>[e(f,{span:6},{default:a(()=>[e(k,{field:"name",label:t.$t("common.user_id"),"label-col-props":{span:6}},{default:a(()=>[e(ae,{modelValue:s.value.user_id,"onUpdate:modelValue":o[0]||(o[0]=n=>s.value.user_id=n),placeholder:t.$t("placeholder.user_id"),precision:0,min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(f,{span:6},{default:a(()=>[e(k,{field:"type",label:t.$t("common.type")},{default:a(()=>[e(q,{modelValue:s.value.type,"onUpdate:modelValue":o[1]||(o[1]=n=>s.value.type=n),placeholder:t.$t("common.all"),options:S(M),scrollbar:!1,"allow-clear":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"])]),_:1}),e(f,{span:6},{default:a(()=>[e(k,{field:"status",label:t.$t("common.status")},{default:a(()=>[e(q,{modelValue:s.value.status,"onUpdate:modelValue":o[2]||(o[2]=n=>s.value.status=n),placeholder:t.$t("common.all"),options:S(Q),scrollbar:!1,"allow-clear":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"])]),_:1}),e(f,{span:6},{default:a(()=>[e(k,{field:"created_at",label:t.$t("finance.form.created_at")},{default:a(()=>[e(te,{modelValue:s.value.created_at,"onUpdate:modelValue":o[3]||(o[3]=n=>s.value.created_at=n),style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(R,{style:{height:"32px"},direction:"vertical"}),e(f,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(se,{direction:"vertical",size:18},{default:a(()=>[e(le,{type:"primary",onClick:P},{icon:a(()=>[e(oe)]),default:a(()=>[g(" "+p(t.$t("button.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})),[[U,["reseller","admin"]]]),F(e(R,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[U,["reseller","admin"]]]),e(C,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(f,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:a(()=>[e(x,{content:t.$t("action.refresh")},{default:a(()=>[m("div",{class:"action-icon",onClick:P},[e(ce,{size:"18"})])]),_:1},8,["content"]),e(de,{onSelect:Y},{content:a(()=>[(u(!0),b(E,null,G(S(J),n=>(u(),T(re,{key:n.value,value:n.value,class:ze({active:n.value===V.value})},{default:a(()=>[m("span",null,p(n.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(x,{content:t.$t("action.density")},{default:a(()=>[m("div",aa,[e(ie,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(x,{content:t.$t("action.column_setting")},{default:a(()=>[e(_e,{trigger:"click",position:"bl",onPopupVisibleChange:ee},{content:a(()=>[m("div",na,[(u(!0),b(E,null,G(h.value,(n,be)=>(u(),b("div",{key:n.dataIndex,class:"setting"},[m("div",oa,[e(pe)]),m("div",null,[e(me,{modelValue:n.checked,"onUpdate:modelValue":z=>n.checked=z,onChange:z=>Z(z,n,be)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),m("div",la,p(n.title),1)]))),128))])]),default:a(()=>[m("div",ta,[e(ue,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(fe,{ref_key:"tableRef",ref:N,"row-key":"id",loading:S(O),pagination:y,columns:_.value,data:B.value,bordered:!1,size:V.value,"row-selection":j,onPageChange:W,onPageSizeChange:X},{quota:a(({record:n})=>[e(Ze,{"model-value":n.quota},null,8,["model-value"])]),type:a(({record:n})=>[g(p(t.$t(`finance.dict.deal_type.${n.type?n.type:n.quota>0?1:2}`)),1)]),remark:a(({record:n})=>[g(p(n.remark||"-"),1)]),status:a(({record:n})=>[n.status===2?(u(),b("span",sa)):(u(),b("span",ca)),g(" "+p(t.$t(`finance.dict.status.${n.status}`)),1)]),_:1},8,["loading","pagination","columns","data","size","row-selection"])]),_:1})])}}});const La=Se(ra,[["__scopeId","data-v-93cc0610"]]);export{La as default};
