import{B as Q,_ as j}from"./index.8581b340.js";/* empty css                *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css               */import{d as z,e as b,B as f,C as E,aH as a,aG as t,aL as r,aM as c,F as q,aD as h,u as p,aE as y,bT as n,aK as G,aF as P,b1 as K,b2 as O,bP as W,aT as J,aS as X,bQ as Y,bV as Z,bW as ee,bO as ae,aU as le,bi as te,b5 as oe,bI as ue,bR as se,g as re}from"./arco.a9260898.js";import{u as pe}from"./loading.1f346a94.js";import{h as ie,f as de}from"./vue.ad52ddbe.js";import{q as ne}from"./common.df364eef.js";import{g as me,q as _e}from"./app.436da350.js";import{b as ce}from"./model.a22eff04.js";import"./chart.d103b168.js";const be={class:"container"},fe={class:"wrapper"},ve={class:"submit-btn"},qe={name:"AppUpdate"},he=z({...qe,setup(ye){const{loading:V,setLoading:m}=pe(!1),{proxy:g}=re(),D=ie(),x=de(),$=b([]);(async()=>{m(!0);try{const{data:l}=await ce();$.value=l.items}catch{}finally{m(!1)}})();const w=b(),e=b({id:"",name:"",remark:"",status:1,models:[],is_limit_quota:!1,quota:b(),quota_expires_at:"",ip_whitelist:"",ip_blacklist:""}),C=async()=>{var o;if(!await((o=w.value)==null?void 0:o.validate())){m(!0);try{await me(e.value).then(()=>{g.$message.success("\u66F4\u65B0\u6210\u529F"),x.push({name:"AppList"})})}catch{}finally{m(!1)}}};(async(l={id:D.query.id})=>{var o,_;m(!0);try{const{data:u}=await _e(l);e.value.id=u.id,e.value.name=u.name,e.value.remark=u.remark,e.value.status=u.status,e.value.models=u.models,e.value.is_limit_quota=u.is_limit_quota,e.value.quota=u.quota,e.value.quota_expires_at=u.quota_expires_at,e.value.ip_whitelist=((o=u==null?void 0:u.ip_whitelist)==null?void 0:o.join(`
`))||"",e.value.ip_blacklist=((_=u==null?void 0:u.ip_blacklist)==null?void 0:_.join(`
`))||""}catch{}finally{m(!1)}})();const B=l=>{e.value.quota=l*5e5};return(l,o)=>{const _=Q,u=G,R=P,U=K,i=O,A=W,H=J,I=X,d=Y,T=Z,F=ee,v=ae,k=le,L=te,S=oe,N=ue,M=se;return f(),E("div",be,[a(R,{class:"container-breadcrumb"},{default:t(()=>[a(u,null,{default:t(()=>[a(_)]),_:1}),a(u,null,{default:t(()=>[r(c(l.$t("menu.app")),1)]),_:1}),a(u,null,{default:t(()=>[r(c(l.$t("menu.app.update")),1)]),_:1})]),_:1}),a(M,{loading:p(V),style:{width:"100%"}},{default:t(()=>[a(N,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:t(()=>[q("div",fe,[a(S,{ref_key:"formRef",ref:w,model:e.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:t(()=>[a(i,{field:"name",label:l.$t("app.label.name"),rules:[{required:!0,message:l.$t("app.error.name.required")},{match:/^.{1,100}$/,message:l.$t("app.error.name.pattern")}]},{default:t(()=>[a(U,{modelValue:e.value.name,"onUpdate:modelValue":o[0]||(o[0]=s=>e.value.name=s),placeholder:l.$t("app.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(i,{field:"models",label:l.$t("app.label.models")},{default:t(()=>[a(A,{modelValue:e.value.models,"onUpdate:modelValue":o[1]||(o[1]=s=>e.value.models=s),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:$.value,placeholder:l.$t("app.placeholder.models"),"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),a(i,{field:"is_limit_quota",label:l.$t("app.label.isLimitQuota")},{default:t(()=>[a(H,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":o[2]||(o[2]=s=>e.value.is_limit_quota=s)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(f(),h(i,{key:0,field:"quota",label:l.$t("app.label.quota"),rules:[{required:!0,message:l.$t("app.error.quota.required")}]},{default:t(()=>[a(I,{modelValue:e.value.quota,"onUpdate:modelValue":o[3]||(o[3]=s=>e.value.quota=s),placeholder:l.$t("app.placeholder.quota"),precision:0,min:0,max:9999999999999,style:{width:"492px","margin-right":"10px"}},null,8,["modelValue","placeholder"]),q("div",null," $"+c(e.value.quota?p(ne)(e.value.quota):"0"),1)]),_:1},8,["label","rules"])):y("",!0),e.value.is_limit_quota?(f(),h(i,{key:1},{default:t(()=>[a(T,{type:"button",onChange:B},{default:t(()=>[a(d,{value:1},{default:t(()=>[r(" $1 ")]),_:1}),a(d,{value:5},{default:t(()=>[r(" $5 ")]),_:1}),a(d,{value:10},{default:t(()=>[r(" $10 ")]),_:1}),a(d,{value:20},{default:t(()=>[r(" $20 ")]),_:1}),a(d,{value:50},{default:t(()=>[r(" $50 ")]),_:1}),a(d,{value:100},{default:t(()=>[r(" $100 ")]),_:1}),a(d,{value:200},{default:t(()=>[r(" $200 ")]),_:1}),a(d,{value:500},{default:t(()=>[r(" $500 ")]),_:1}),a(d,{value:1e3},{default:t(()=>[r(" $1000 ")]),_:1})]),_:1},8,["onChange"])]),_:1})):y("",!0),e.value.is_limit_quota?(f(),h(i,{key:2,field:"quota_expires_at",label:l.$t("app.label.quota_expires_at")},{default:t(()=>[a(F,{modelValue:e.value.quota_expires_at,"onUpdate:modelValue":o[4]||(o[4]=s=>e.value.quota_expires_at=s),placeholder:l.$t("app.placeholder.quota_expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":s=>p(n)(s).isBefore(p(n)().subtract(1,"day")),style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>p(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>p(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>p(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>p(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>p(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>p(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>p(n)(e.value.quota_expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"])):y("",!0),a(i,{field:"ip_whitelist",label:l.$t("app.label.ip_whitelist")},{default:t(()=>[a(v,{modelValue:e.value.ip_whitelist,"onUpdate:modelValue":o[5]||(o[5]=s=>e.value.ip_whitelist=s),placeholder:l.$t("app.placeholder.ip_whitelist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(i,{field:"ip_blacklist",label:l.$t("app.label.ip_blacklist")},{default:t(()=>[a(v,{modelValue:e.value.ip_blacklist,"onUpdate:modelValue":o[6]||(o[6]=s=>e.value.ip_blacklist=s),placeholder:l.$t("app.placeholder.ip_blacklist"),"auto-size":{minRows:5,maxRows:5}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(i,{field:"remark",label:l.$t("app.label.remark"),rules:[{required:!1}]},{default:t(()=>[a(v,{modelValue:e.value.remark,"onUpdate:modelValue":o[7]||(o[7]=s=>e.value.remark=s),placeholder:l.$t("app.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(L,null,{default:t(()=>[q("div",ve,[a(k,{type:"secondary",onClick:o[8]||(o[8]=s=>l.$router.push({name:"AppList"}))},{default:t(()=>[r(c(l.$t("button.cancel")),1)]),_:1}),a(k,{type:"primary",onClick:C},{default:t(()=>[r(c(l.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const ze=j(he,[["__scopeId","data-v-062e4691"]]);export{ze as default};
