import{u as ce,_ as re,s as He,A as Me,k as Oe,B as je}from"./index.734acf26.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css              */import{d as _e,e as w,w as te,B as a,C as r,aH as t,aG as e,u as o,aD as d,aL as m,aM as i,aE as Ge,g as pe,bA as Je,bB as Ke,ad as Qe,bC as We,bD as me,bE as Xe,r as ue,c as W,bF as Ye,bu as X,aJ as Y,aI as Z,D as C,E as Ze,n as et,as as tt,aK as at,aF as lt,bH as st,bI as ot,b2 as nt,bG as it,aS as dt,b1 as ut,bJ as ct,bK as rt,b5 as _t,bL as pt,ab as mt,aU as ft,bi as bt,bj as kt,bk as vt,bl as ht,b4 as yt,bM as gt,bO as $t,aV as wt,bU as Ct}from"./arco.73de4031.js";import{u as fe}from"./loading.0c20cf1b.js";import{f as Vt}from"./app.ba9166f5.js";import{d as It,e as Dt,g as xt}from"./task.0aa36374.js";import{c as ee,S as zt}from"./sortable.esm.7de80f5d.js";import{u as be}from"./vue.e54f3d1e.js";/* empty css                *//* empty css                */import"./chart.b5ad42b0.js";const St={style:{margin:"10px 0 30px 10px"}},Bt={key:1},Ft={key:1},Lt={key:1},Nt={key:1},Ut={key:1},At={key:1},Et={key:1},Pt={key:1},Tt={key:1},Rt={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},qt={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},Ht={key:1},Mt={key:1},Ot={key:1},jt={key:1},Gt={key:1},Jt={key:1},Kt={key:1},Qt={key:1},Wt={name:"TaskBatchDetail"},Xt=_e({...Wt,props:{id:{type:String,default:""}},setup(ae){const T=ae,{t:c}=ce(),{loading:b,setLoading:N}=fe(!0),n=w({}),{copy:U,copied:f}=be(),{proxy:E}=pe();(async(y={id:T.id})=>{N(!0);try{const{data:h}=await It(y);n.value=h}catch{}finally{N(!1)}})();const g=y=>{U(y)};te(f,()=>{f.value&&E.$message.success("\u590D\u5236\u6210\u529F")});const F=async(y,h)=>{const{data:_}=await Dt({id:y,field:h});U(_.value)};return(y,h)=>{const _=Je,v=Ke,$=Qe,p=We,z=me,R=Xe;return a(),r("div",St,[t(R,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:e(()=>[t(p,{label:o(c)("task.batch.detail.label.trace_id"),span:2},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Bt,[m(i(n.value.trace_id)+" ",1),t($,{class:"copy-btn",onClick:h[0]||(h[0]=S=>g(n.value.trace_id))})]))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.creator"),span:2},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Ft,[m(i(n.value.creator)+" ",1),t($,{class:"copy-btn",onClick:h[1]||(h[1]=S=>F(n.value.id,"creator"))})]))]),_:1},8,["label"]),t(p,{label:o(c)("common.app_id")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Lt,i(n.value.app_id),1))]),_:1},8,["label"]),t(p,{label:o(c)("common.user_id")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Nt,i(n.value.user_id),1))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.model")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Ut,i(n.value.model),1))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.batch_id"),span:2},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",At,[m(i(n.value.batch_id)+" ",1),t($,{class:"copy-btn",onClick:h[2]||(h[2]=S=>g(n.value.batch_id))})]))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.input_file_id"),span:2},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Et,[m(i(n.value.input_file_id)+" ",1),t($,{class:"copy-btn",onClick:h[3]||(h[3]=S=>g(n.value.input_file_id))})]))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.output_file_id"),span:2},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Pt,[m(i(n.value.output_file_id)+" ",1),t($,{class:"copy-btn",onClick:h[4]||(h[4]=S=>g(n.value.output_file_id))})]))]),_:1},8,["label"]),n.value.error_file_id?(a(),d(p,{key:0,label:o(c)("task.batch.detail.label.error_file_id"),span:2},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Tt,[m(i(n.value.error_file_id)+" ",1),t($,{class:"copy-btn",onClick:h[5]||(h[5]=S=>g(n.value.error_file_id))})]))]),_:1},8,["label"])):Ge("",!0),t(p,{label:o(c)("task.batch.detail.label.response_data"),span:2},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Rt,i(n.value.response_data||"-"),1))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.error"),span:2},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",qt,i(n.value.error||"-"),1))]),_:1},8,["label"]),t(p,{label:o(c)("common.status")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Ht,[n.value.status==="completed"?(a(),d(z,{key:0,color:"green"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="finalizing"?(a(),d(z,{key:1,color:"green"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="validating"?(a(),d(z,{key:2,color:"arcoblue"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="in_progress"?(a(),d(z,{key:3,color:"orange"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="failed"?(a(),d(z,{key:4,color:"red"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):(a(),d(z,{key:5,color:"gray"},{default:e(()=>[m(i(y.$t(`task.dict.status.${n.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.in_progress_at")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Mt,i(n.value.in_progress_at||"-"),1))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.finalizing_at")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Ot,i(n.value.finalizing_at||"-"),1))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.completed_at")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",jt,i(n.value.completed_at||"-"),1))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.expires_at")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Gt,i(n.value.expires_at||"-"),1))]),_:1},8,["label"]),t(p,{label:o(c)("task.batch.detail.label.cancelled_at")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Jt,i(n.value.cancelled_at||n.value.cancelling_at||"-"),1))]),_:1},8,["label"]),t(p,{label:o(c)("common.created_at")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Kt,i(n.value.created_at),1))]),_:1},8,["label"]),t(p,{label:o(c)("common.updated_at")},{default:e(()=>[o(b)?(a(),d(v,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(a(),r("span",Qt,i(n.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const Yt=re(Xt,[["__scopeId","data-v-58d5cf1c"]]),Zt={class:"container"},ea={class:"action-icon"},ta={class:"action-icon"},aa={id:"tableSetting"},la={style:{"margin-right":"4px",cursor:"move"}},sa={class:"title"},oa=["onClick"],na=["onClick"],ia=["onClick"],da={name:"TaskBatchList"},ua=_e({...da,setup(ae){const{proxy:T}=pe(),c=localStorage.getItem("userRole"),b=ue({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),N=()=>({user_id:w(),app_id:w(),trace_id:"",batch_id:"",file_id:"",status:w(),created_at:[]}),{loading:n,setLoading:U}=fe(!0),{t:f}=ce(),E=w([]),k=w(N()),g=w([]),F=w([]),y=w("medium"),h=w(),_=w([]);c==="user"&&(async()=>{try{const{data:l}=await Vt();_.value=l.items}catch{}})();const $={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},p=ue({...$}),z=W(()=>[{name:f("size.mini"),value:"mini"},{name:f("size.small"),value:"small"},{name:f("size.medium"),value:"medium"},{name:f("size.large"),value:"large"}]),R=W(()=>[{title:f(c==="reseller"||c==="admin"?"task.columns.user_id":"task.columns.app_id"),dataIndex:c==="reseller"||c==="admin"?"user_id":"app_id",slotName:c==="reseller"||c==="admin"?"user_id":"app_id",align:"center",width:75},{title:f("task.columns.model"),dataIndex:"model",slotName:"model",align:"center"},{title:f("task.columns.batch_id"),dataIndex:"batch_id",slotName:"batch_id",align:"center",ellipsis:!0,tooltip:!0},{title:f("task.columns.input_file_id"),dataIndex:"input_file_id",slotName:"input_file_id",align:"center",ellipsis:!0,tooltip:!0},{title:f("task.columns.output_file_id"),dataIndex:"output_file_id",slotName:"output_file_id",align:"center",ellipsis:!0,tooltip:!0},{title:f("task.columns.status"),dataIndex:"status",slotName:"status",align:"center"},{title:f("task.columns.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:f("task.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),S=W(()=>[{label:f("task.dict.status.queued"),value:"queued"},{label:f("task.dict.status.in_progress"),value:"in_progress"},{label:f("task.dict.status.completed"),value:"completed"},{label:f("task.dict.status.failed"),value:"failed"},{label:f("task.dict.status.expired"),value:"expired"}]);c==="admin"&&S.value.push({label:f("task.dict.status.deleted"),value:"deleted"});const P=async(l={...$})=>{U(!0);try{const{data:u}=await xt(l);E.value=u.items,p.current=l.current,p.pageSize=l.pageSize,p.total=u.paging.total}catch{}finally{U(!1)}},q=()=>{P({...$,...k.value})},ke=l=>{P({...$,...k.value,current:l})},ve=l=>{$.pageSize=l,P({...$,...k.value})};P();const he=()=>{k.value=N(),q()},ye=(l,u)=>{y.value=l},ge=(l,u,D)=>{l?g.value.splice(D,0,u):g.value=F.value.filter(V=>V.dataIndex!==u.dataIndex)},le=(l,u,D,V=!1)=>{const x=V?ee(l):l;return u>-1&&D>-1&&x.splice(u,1,x.splice(D,1,x[u]).pop()),x},$e=l=>{l&&et(()=>{const u=document.getElementById("tableSetting");new zt(u,{onEnd(D){const{oldIndex:V,newIndex:x}=D;le(g.value,V,x),le(F.value,V,x)}})})};te(()=>R.value,l=>{g.value=ee(l),g.value.forEach((u,D)=>{u.checked=!0}),F.value=ee(g.value)},{deep:!0,immediate:!0});const H=w(!1),se=w(),we=l=>{H.value=!0,se.value=l},Ce=()=>{H.value=!1},{copy:Ve,copied:oe}=be(),M=async l=>{Ve(l)};return te(oe,()=>{oe.value&&T.$message.success("\u590D\u5236\u6210\u529F")}),(l,u)=>{const D=tt,V=at,x=lt,Ie=st,ne=ot,B=nt,I=it,De=dt,O=ut,xe=ct,j=rt,ze=_t,ie=pt,Se=mt,G=ft,de=He,Be=bt,J=kt,Fe=Me,Le=vt,Ne=ht,Ue=Oe,Ae=je,Ee=yt,Pe=gt,L=me,Te=$t,Re=wt,qe=Ct,K=Ye("permission");return a(),r("div",Zt,[t(x,{class:"container-breadcrumb"},{default:e(()=>[t(V,null,{default:e(()=>[t(D)]),_:1}),t(V,null,{default:e(()=>[m(i(l.$t("menu.task")),1)]),_:1}),t(V,null,{default:e(()=>[m(i(l.$t("menu.task.batch.list")),1)]),_:1})]),_:1}),t(qe,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:e(()=>[t(j,null,{default:e(()=>[t(I,{flex:1},{default:e(()=>[t(ze,{model:k.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(j,{gutter:16},{default:e(()=>[X((a(),d(I,{span:8},{default:e(()=>[t(B,{field:"app_id",label:l.$t("task.form.app_id")},{default:e(()=>[t(ne,{modelValue:k.value.app_id,"onUpdate:modelValue":u[0]||(u[0]=s=>k.value.app_id=s),placeholder:l.$t("task.form.selectDefault"),"allow-search":"","allow-clear":""},{default:e(()=>[(a(!0),r(Y,null,Z(_.value,s=>(a(),d(Ie,{key:s.app_id,value:s.app_id,label:s.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[K,["user"]]]),X((a(),d(I,{span:8},{default:e(()=>[t(B,{field:"user_id",label:l.$t("task.form.user_id")},{default:e(()=>[t(De,{modelValue:k.value.user_id,"onUpdate:modelValue":u[1]||(u[1]=s=>k.value.user_id=s),placeholder:l.$t("task.form.user_id.placeholder"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[K,["reseller","admin"]]]),t(I,{span:8},{default:e(()=>[t(B,{field:"trace_id",label:l.$t("task.form.trace_id")},{default:e(()=>[t(O,{modelValue:k.value.trace_id,"onUpdate:modelValue":u[2]||(u[2]=s=>k.value.trace_id=s),placeholder:l.$t("task.form.trace_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(I,{span:8},{default:e(()=>[t(B,{field:"batch_id",label:l.$t("task.form.batch_id")},{default:e(()=>[t(O,{modelValue:k.value.batch_id,"onUpdate:modelValue":u[3]||(u[3]=s=>k.value.batch_id=s),placeholder:l.$t("task.form.batch_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(I,{span:8},{default:e(()=>[t(B,{field:"file_id",label:l.$t("task.form.file_id")},{default:e(()=>[t(O,{modelValue:k.value.file_id,"onUpdate:modelValue":u[4]||(u[4]=s=>k.value.file_id=s),placeholder:l.$t("task.form.file_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(I,{span:8},{default:e(()=>[t(B,{field:"status",label:l.$t("task.form.status")},{default:e(()=>[t(ne,{modelValue:k.value.status,"onUpdate:modelValue":u[5]||(u[5]=s=>k.value.status=s),options:o(S),placeholder:l.$t("task.form.selectDefault"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(I,{span:8},{default:e(()=>[t(B,{field:"created_at",label:l.$t("task.form.created_at")},{default:e(()=>[t(xe,{modelValue:k.value.created_at,"onUpdate:modelValue":u[6]||(u[6]=s=>k.value.created_at=s),placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(ie,{style:{height:"84px"},direction:"vertical"}),t(I,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[t(Be,{direction:"vertical",size:18},{default:e(()=>[t(G,{type:"primary",onClick:q},{icon:e(()=>[t(Se)]),default:e(()=>[m(" "+i(l.$t("task.form.search")),1)]),_:1}),t(G,{onClick:he},{icon:e(()=>[t(de)]),default:e(()=>[m(" "+i(l.$t("task.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),X(t(ie,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[K,["reseller","admin"]]]),t(j,{style:{"margin-bottom":"16px"}},{default:e(()=>[t(I,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:e(()=>[t(J,{content:l.$t("actions.refresh")},{default:e(()=>[C("div",{class:"action-icon",onClick:q},[t(de,{size:"18"})])]),_:1},8,["content"]),t(Ne,{onSelect:ye},{content:e(()=>[(a(!0),r(Y,null,Z(o(z),s=>(a(),d(Le,{key:s.value,value:s.value,class:Ze({active:s.value===y.value})},{default:e(()=>[C("span",null,i(s.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[t(J,{content:l.$t("actions.density")},{default:e(()=>[C("div",ea,[t(Fe,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(J,{content:l.$t("actions.column_setting")},{default:e(()=>[t(Pe,{trigger:"click",position:"bl",onPopupVisibleChange:$e},{content:e(()=>[C("div",aa,[(a(!0),r(Y,null,Z(F.value,(s,A)=>(a(),r("div",{key:s.dataIndex,class:"setting"},[C("div",la,[t(Ae)]),C("div",null,[t(Ee,{modelValue:s.checked,"onUpdate:modelValue":Q=>s.checked=Q,onChange:Q=>ge(Q,s,A)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),C("div",sa,i(s.title==="#"?"\u5E8F\u5217\u53F7":s.title),1)]))),128))])]),default:e(()=>[C("div",ta,[t(Ue,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(Te,{ref_key:"tableRef",ref:h,"row-key":"id",loading:o(n),pagination:p,columns:g.value,data:E.value,bordered:!1,size:y.value,"row-selection":b,onPageChange:ke,onPageSizeChange:ve},{batch_id:e(({record:s})=>[C("span",{class:"copy-btn",onClick:A=>M(s.batch_id)},i(s.batch_id||"-"),9,oa)]),input_file_id:e(({record:s})=>[C("span",{class:"copy-btn",onClick:A=>M(s.input_file_id)},i(s.input_file_id||"-"),9,na)]),output_file_id:e(({record:s})=>[C("span",{class:"copy-btn",onClick:A=>M(s.output_file_id)},i(s.output_file_id||"-"),9,ia)]),status:e(({record:s})=>[s.status==="completed"?(a(),d(L,{key:0,color:"green"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):s.status==="finalizing"?(a(),d(L,{key:1,color:"green"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):s.status==="validating"?(a(),d(L,{key:2,color:"arcoblue"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):s.status==="in_progress"?(a(),d(L,{key:3,color:"orange"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):s.status==="failed"?(a(),d(L,{key:4,color:"red"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024)):(a(),d(L,{key:5,color:"gray"},{default:e(()=>[m(i(l.$t(`task.dict.status.${s.status}`)),1)]),_:2},1024))]),operations:e(({record:s})=>[t(G,{type:"text",size:"small",onClick:A=>we(s.id)},{default:e(()=>[m(i(l.$t("task.columns.operations.view")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),t(Re,{title:l.$t("menu.task.batch.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:H.value,onCancel:Ce},{default:e(()=>[t(Yt,{id:se.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const Ua=re(ua,[["__scopeId","data-v-7d1e97bd"]]);export{Ua as default};
