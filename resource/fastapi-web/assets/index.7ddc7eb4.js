import{u as $e,_ as De,N as it,s as dt,A as ut,k as rt,B as mt}from"./index.b80693be.js";/* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              */import{d as we,e as g,B as o,C as p,aH as t,aG as e,u as C,aD as m,aM as i,aL as v,bA as pt,bB as ct,bC as _t,bD as Ae,bE as bt,r as he,c as te,w as ke,aZ as le,aJ as Y,aI as ee,aE as ye,bH as Ne,bI as Ue,b2 as Pe,bG as Be,b1 as qe,bK as Te,b5 as Fe,bL as Re,ab as Ee,aU as He,bi as je,bP as vt,bQ as ft,bU as gt,b7 as yt,bN as Oe,bT as Ge,D as F,E as ht,n as kt,a_ as Me,aK as $t,aF as wt,bj as Ct,bk as Vt,bl as xt,b4 as It,bM as St,aT as Lt,aV as zt}from"./arco.3f46b4ae.js";import{u as Ce}from"./loading.37fd256d.js";import{a as Mt,t as Dt,b as At,s as Nt,c as Ut}from"./model_agent.00299daa.js";import{c as ae,S as Pt}from"./sortable.esm.078712c4.js";import{q as We}from"./provider.09d70a12.js";import{b as Bt,q as qt}from"./model.4f5741d3.js";import{M as Tt}from"./models.51931ccd.js";/* empty css                *//* empty css                *//* empty css              */import{f as Ft,u as Rt}from"./vue.dbcf9bc3.js";import"./chart.2cea905d.js";const Et={style:{margin:"10px 0 30px 10px"}},Ht={key:1},jt={key:1},Ot={key:1},Gt={key:1},Wt={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},Jt={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},Kt={key:1},Qt={key:1},Zt={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},Xt={key:1},Yt={key:1},el={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},tl={key:1},ll={key:1},al={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},ol={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},nl={key:1},sl={key:1},il={name:"ModelAgentDetail"},dl=we({...il,props:{id:{type:String,default:""}},setup(oe){const B=oe;$e();const{loading:y,setLoading:c}=Ce(!0),u=g({});return(async(f={id:B.id})=>{c(!0);try{const{data:k}=await Mt(f);u.value=k}catch{}finally{c(!1)}})(),(f,k)=>{const _=pt,b=ct,h=_t,L=Ae,N=bt;return o(),p("div",Et,[t(N,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:e(()=>[t(h,{label:f.$t("common.provider")},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Ht,i(u.value.provider_name),1))]),_:1},8,["label"]),t(h,{label:f.$t("model.agent.label.name")},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",jt,i(u.value.name),1))]),_:1},8,["label"]),t(h,{label:f.$t("model.agent.label.base_url"),span:2},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Ot,i(u.value.base_url),1))]),_:1},8,["label"]),t(h,{label:f.$t("model.agent.label.path"),span:2},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Gt,i(u.value.path||"-"),1))]),_:1},8,["label"]),t(h,{label:f.$t("common.bind_group"),span:2},{default:e(()=>{var $,I;return[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Wt,i(((I=($=u.value)==null?void 0:$.group_names)==null?void 0:I.join(`
`))||"-"),1))]}),_:1},8,["label"]),t(h,{label:f.$t("common.bind_models"),span:2},{default:e(()=>{var $,I;return[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Jt,i(((I=($=u.value)==null?void 0:$.model_names)==null?void 0:I.join(`
`))||"-"),1))]}),_:1},8,["label"]),t(h,{label:f.$t("common.billing_methods"),span:2},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Kt,i(f.$t(`dict.billing_methods.${u.value.billing_methods||1}`)),1))]),_:1},8,["label"]),t(h,{label:f.$t("common.weight")},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Qt,i(u.value.weight||0),1))]),_:1},8,["label"]),t(h,{label:f.$t("model.agent.detail.fallback_models")},{default:e(()=>{var $,I;return[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Zt,i(((I=($=u.value)==null?void 0:$.fallback_model_names)==null?void 0:I.join(`
`))||"-"),1))]}),_:1},8,["label"]),t(h,{label:f.$t("model.agent.label.is_never_disable")},{default:e(()=>{var $;return[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Xt,i(f.$t(`dict.${(($=u.value)==null?void 0:$.is_never_disable)||!1}`)),1))]}),_:1},8,["label"]),t(h,{label:f.$t("model.agent.label.lb_strategy")},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",Yt,i(f.$t(`dict.lb_strategy.${u.value.lb_strategy||1}`)),1))]),_:1},8,["label"]),t(h,{label:f.$t("common.key"),span:2},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",el,i(u.value.key||"-"),1))]),_:1},8,["label"]),t(h,{label:f.$t("key.detail.is_auto_disabled")},{default:e(()=>{var $;return[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",tl,i(f.$t(`dict.${(($=u.value)==null?void 0:$.is_auto_disabled)||!1}`)),1))]}),_:1},8,["label"]),t(h,{label:f.$t("common.status")},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",ll,[u.value.status===1?(o(),m(L,{key:0,color:"green"},{default:e(()=>[v(i(f.$t(`dict.status.${u.value.status}`)),1)]),_:1})):(o(),m(L,{key:1,color:"red"},{default:e(()=>[v(i(f.$t(`dict.status.${u.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),t(h,{label:f.$t("key.detail.auto_disabled_reason"),span:2},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",al,i(u.value.auto_disabled_reason||"-"),1))]),_:1},8,["label"]),t(h,{label:f.$t("common.remark"),span:2},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",ol,i(u.value.remark||"-"),1))]),_:1},8,["label"]),t(h,{label:f.$t("common.created_at")},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",nl,i(u.value.created_at),1))]),_:1},8,["label"]),t(h,{label:f.$t("common.updated_at")},{default:e(()=>[C(y)?(o(),m(b,{key:0,animation:!0},{default:e(()=>[t(_,{rows:1})]),_:1})):(o(),p("span",sl,i(u.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}}),ul={class:"container"},rl=["title","onClick"],ml={key:0},pl={key:1},cl=["title","onClick"],_l={key:0},bl={key:1},vl={name:"Tests"},fl=we({...vl,props:{id:{type:String,default:""},action:{type:String,default:""}},setup(oe){const B=oe,{loading:y,setLoading:c}=Ce(!0),{t:u}=$e(),J=Ft(),f=he({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),k=()=>({provider_id:"",name:"",model:"",type:g(),status:g()}),_=g([]),b=g(k()),h=g([]),L=g([]),N=g("medium"),$=g([]),I=g(!0),q=g(!0),ne=g(),se=g(),V=g({model_agent_id:B.id,test_method:1}),j=te(()=>[{title:u("common.provider"),dataIndex:"provider_name",slotName:"provider_name",align:"center"},{title:u("common.model_name"),dataIndex:"name",slotName:"name",align:"center",ellipsis:!0,tooltip:!0},{title:u("common.model"),dataIndex:"model",slotName:"model",align:"center",ellipsis:!0,tooltip:!0},{title:u("common.model_type"),dataIndex:"type",slotName:"type",align:"center",ellipsis:!0,tooltip:!0},{title:u("common.result"),dataIndex:"result",slotName:"result",align:"center",width:80,filterable:{filters:[{text:u("dict.success.true"),value:"true"},{text:u("dict.success.false"),value:"false"}],filter:(a,r)=>{const x=a[0]==="true";return r.result===x}}},{title:u("model.agent.columns.total_time"),dataIndex:"total_time",slotName:"total_time",align:"center",width:110,filterable:{filters:[{text:"< 500",value:"<500"},{text:"> 500",value:">500"},{text:"< 1000",value:"<1000"},{text:"> 1000",value:">1000"},{text:"< 2000",value:"<2000"},{text:"> 2000",value:">2000"},{text:"< 3000",value:"<3000"},{text:"> 3000",value:">3000"},{text:"< 5000",value:"<5000"},{text:"> 5000",value:">5000"},{text:"< 10000",value:"<10000"},{text:"> 10000",value:">10000"},{text:"< 30000",value:"<30000"},{text:"> 30000",value:">30000"},{text:"< 60000",value:"<60000"},{text:"> 60000",value:">60000"},{text:"0-500",value:"0-500"},{text:"501-1000",value:"501-1000"},{text:"1001-3000",value:"1001-3000"},{text:"3001-5000",value:"3001-5000"},{text:"5001-10000",value:"5001-10000"},{text:"10001-30000",value:"10001-30000"},{text:"30001-60000",value:"30001-60000"}],filter:(a,r)=>{if(a[0].startsWith("<")){const x=parseFloat(a[0].substring(1));return r.total_time<x}if(a[0].startsWith(">")){const x=parseFloat(a[0].substring(1));return r.total_time>x}if(a[0].includes("-")){const[x,P]=a[0].split("-").map(Number);return r.total_time>=x&&r.total_time<=P}return r.total_time>parseFloat(a[0])}}},{title:u("common.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:120}]),R=te(()=>[{label:u("dict.model_type.1"),value:1},{label:u("dict.model_type.2"),value:2},{label:u("dict.model_type.3"),value:3},{label:u("dict.model_type.4"),value:4},{label:u("dict.model_type.5"),value:5},{label:u("dict.model_type.6"),value:6},{label:u("dict.model_type.7"),value:7},{label:u("dict.model_type.8"),value:8},{label:u("dict.model_type.100"),value:100},{label:u("dict.model_type.101"),value:101},{label:u("dict.model_type.102"),value:102},{label:u("dict.model_type.103"),value:103},{label:u("dict.model_type.10000"),value:1e4}]),ie=async(a={id:B.id,action:B.action})=>{c(!0);try{const{data:r}=await Bt(a);_.value=r.items,r.items.length>0?q.value=!1:q.value=!0}catch{}finally{c(!1),ne.value.selectAll(!1)}};ie();const pe=()=>{ie({id:B.id,action:B.action,...b.value})};ke(()=>j.value,a=>{h.value=ae(a),h.value.forEach((r,x)=>{r.checked=!0}),L.value=ae(h.value)},{deep:!0,immediate:!0});const de=g([]);(async()=>{c(!0);try{const{data:a}=await We();de.value=a.items}catch{}finally{c(!1)}})();const K=async a=>{var x;if(!await((x=se.value)==null?void 0:x.validate())){a.testing=!0,a.trace_id="",V.value.model_id=a.id;const P=Date.now();try{const{data:w}=await Dt(V.value);a.trace_id=w.trace_id,a.result=w.result,a.total_time=w.total_time,a.error=w.error,w.error&&le.error({content:w.error,duration:5*1e3})}catch(w){a.result=!1,a.total_time=Date.now()-P,a.error=w}finally{a.testing=!1}}},ue=a=>{const r=new Map([[2,"LogImageList"],[5,"LogAudioList"],[6,"LogAudioList"],[8,"LogVideoList"],[1e4,"LogGeneralList"]]);return J.resolve({name:r.get(a.type)||"LogTextList",query:{trace_id:a.trace_id}}).href},ce=a=>{$.value=a,I.value=!a.length},re=()=>{if($.value.length>0)for(let a=0;a<$.value.length;a+=1)for(let r=0;r<_.value.length;r+=1)$.value[a]===_.value[r].id&&K(_.value[r]);else for(let a=0;a<_.value.length;a+=1)K(_.value[a])},{copy:xe,copied:Q}=Rt(),_e=async a=>{a&&xe(a)};return ke(Q,()=>{Q.value&&le.success(u("success.copy"))}),(a,r)=>{const x=Ne,P=Ue,w=Pe,z=Be,O=qe,E=Te,G=Fe,H=Re,be=Ee,Z=He,l=je,d=vt,M=ft,D=gt,S=Ae,me=yt,X=Oe,T=Ge;return o(),p("div",ul,[t(T,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"0px"}},{default:e(()=>[t(E,null,{default:e(()=>[t(z,{flex:1},{default:e(()=>[t(G,{model:b.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(E,{gutter:16},{default:e(()=>[t(z,{span:6},{default:e(()=>[t(w,{field:"provider_id",label:a.$t("common.provider"),"label-col-props":{span:6}},{default:e(()=>[t(P,{modelValue:b.value.provider_id,"onUpdate:modelValue":r[0]||(r[0]=s=>b.value.provider_id=s),placeholder:a.$t("common.all"),scrollbar:!1,"allow-search":"","allow-clear":""},{default:e(()=>[(o(!0),p(Y,null,ee(de.value,s=>(o(),m(x,{key:s.id,value:s.id,label:s.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(z,{span:6},{default:e(()=>[t(w,{field:"name",label:a.$t("model.agent.label.model_name"),"label-col-props":{span:4},"wrapper-col-props":{span:20}},{default:e(()=>[t(O,{modelValue:b.value.name,"onUpdate:modelValue":r[1]||(r[1]=s=>b.value.name=s),placeholder:a.$t("model.form.placeholder.name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(z,{span:6},{default:e(()=>[t(w,{field:"model",label:a.$t("common.model"),"label-col-props":{span:4},"wrapper-col-props":{span:20}},{default:e(()=>[t(O,{modelValue:b.value.model,"onUpdate:modelValue":r[2]||(r[2]=s=>b.value.model=s),placeholder:a.$t("model.form.placeholder.model"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(z,{span:6},{default:e(()=>[t(w,{field:"type",label:a.$t("common.type"),"label-col-props":{span:4},"wrapper-col-props":{span:20}},{default:e(()=>[t(P,{modelValue:b.value.type,"onUpdate:modelValue":r[3]||(r[3]=s=>b.value.type=s),placeholder:a.$t("common.all"),options:C(R),scrollbar:!1,"allow-search":"","allow-clear":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(H,{style:{height:"32px"},direction:"vertical"}),t(z,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[t(l,{direction:"vertical",size:18},{default:e(()=>[t(Z,{type:"primary",onClick:pe},{icon:e(()=>[t(be)]),default:e(()=>[v(" "+i(a.$t("button.search")),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(H,{style:{"margin-top":"0"}}),t(G,{ref_key:"testModelFormRef",ref:se,model:V.value,"label-col-props":{span:4},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(E,{gutter:16},{default:e(()=>[t(z,{span:8},{default:e(()=>[t(w,{field:"test_method",label:a.$t("model.agent.label.test_models.test_method"),"label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:e(()=>[t(M,{modelValue:V.value.test_method,"onUpdate:modelValue":r[4]||(r[4]=s=>V.value.test_method=s)},{default:e(()=>[t(d,{value:1},{default:e(()=>[v(i(a.$t("model.agent.dict.test_method.1")),1)]),_:1}),t(d,{value:2},{default:e(()=>[v(i(a.$t("model.agent.dict.test_method.2")),1)]),_:1}),t(d,{value:3},{default:e(()=>[v(i(a.$t("model.agent.dict.test_method.3")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),V.value.test_method===3?(o(),m(z,{key:0,span:7},{default:e(()=>[t(w,{field:"base_url",label:a.$t("model.agent.label.test_models.base_url"),rules:[{required:!0,message:a.$t("model.agent.error.required.test_models.base_url")}],"label-col-props":{span:8},"wrapper-col-props":{span:16}},{default:e(()=>[t(O,{modelValue:V.value.base_url,"onUpdate:modelValue":r[5]||(r[5]=s=>V.value.base_url=s),placeholder:a.$t("model.agent.placeholder.test_models.base_url"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])]),_:1})):ye("",!0),V.value.test_method!==2?(o(),m(z,{key:1,span:V.value.test_method===1?14:7},{default:e(()=>[t(w,{field:"key",label:a.$t("model.agent.label.test_models.key"),rules:[{required:!0,message:a.$t("model.agent.placeholder.test_models.key")}],"label-col-props":{span:V.value.test_method!==3?3:7},"wrapper-col-props":{span:V.value.test_method!==3?21:17}},{default:e(()=>[t(O,{modelValue:V.value.key,"onUpdate:modelValue":r[6]||(r[6]=s=>V.value.key=s),placeholder:a.$t("model.agent.placeholder.test_models.key"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules","label-col-props","wrapper-col-props"])]),_:1},8,["span"])):ye("",!0),t(z,{span:V.value.test_method!==2?2:16,style:{"text-align":"right"}},{default:e(()=>[t(Z,{type:"primary",disabled:q.value,onClick:re},{default:e(()=>[v(i(a.$t("button.batch.test")),1)]),_:1},8,["disabled"])]),_:1},8,["span"])]),_:1})]),_:1},8,["model"]),t(X,{ref_key:"tableRef",ref:ne,"row-key":"id",loading:C(y),pagination:!1,columns:h.value,data:_.value,bordered:!1,size:N.value,scroll:{y:"480px"},scrollbar:!1,"row-selection":f,onSelectionChange:ce},{type:e(({record:s})=>[v(i(a.$t(`dict.model_type.${s.type}`)),1)]),result:e(({record:s})=>[s.testing?(o(),m(D,{key:0})):(o(),p("span",{key:1,title:s.error,onClick:W=>_e(s.error)},[s.result!=null?(o(),p("span",ml,[s.result?(o(),m(S,{key:0,color:"green"},{default:e(()=>[v(i(a.$t(`dict.success.${s.result}`)),1)]),_:2},1024)):(o(),m(S,{key:1,color:"red"},{default:e(()=>[v(i(a.$t(`dict.success.${s.result}`)),1)]),_:2},1024))])):(o(),p("span",pl," - "))],8,rl))]),total_time:e(({record:s})=>[s.testing?(o(),m(D,{key:0})):(o(),p("span",{key:1,title:s.error,onClick:W=>_e(s.error)},[s.total_time?(o(),p("span",_l,[s.total_time>6e4?(o(),m(S,{key:0,color:"red"},{default:e(()=>[v(i(s.total_time),1)]),_:2},1024)):s.total_time>3e4?(o(),m(S,{key:1,color:"orangered"},{default:e(()=>[v(i(s.total_time),1)]),_:2},1024)):s.total_time>1e4?(o(),m(S,{key:2,color:"orange"},{default:e(()=>[v(i(s.total_time),1)]),_:2},1024)):s.total_time>5e3?(o(),m(S,{key:3,color:"gold"},{default:e(()=>[v(i(s.total_time),1)]),_:2},1024)):(o(),m(S,{key:4,color:"green"},{default:e(()=>[v(i(s.total_time||"-"),1)]),_:2},1024))])):(o(),p("span",bl," - "))],8,cl))]),operations:e(({record:s})=>[t(Z,{type:"text",size:"small",disabled:s.testing,onClick:W=>K(s)},{default:e(()=>[v(i(a.$t("button.test")),1)]),_:2},1032,["disabled","onClick"]),V.value.test_method!==2?(o(),m(me,{key:0,href:ue(s),disabled:!s.trace_id||s.trace_id==="",target:"_blank"},{default:e(()=>[v(i(a.$t("button.detail")),1)]),_:2},1032,["href","disabled"])):ye("",!0)]),_:1},8,["loading","columns","data","size","row-selection"])]),_:1})])}}});const gl=De(fl,[["__scopeId","data-v-7bff8095"]]),yl={class:"container"},hl={class:"action-icon"},kl={class:"action-icon"},$l={id:"tableSetting"},wl={style:{"margin-right":"4px",cursor:"move"}},Cl={class:"title"},Vl={key:0},xl={key:1},Il={name:"ModelAgentList"},Sl=we({...Il,setup(oe){const{loading:B,setLoading:y}=Ce(!0),{t:c}=$e(),u=he({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),J=()=>({provider_id:"",name:"",base_url:"",models:[],status:g(),remark:""}),f=g([]),k=g(J()),_=g([]),b=g([]),h=g("medium"),L=g([]),N=g(!0),$=g(),I={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},q=he({...I}),ne=te(()=>[{name:c("size.mini"),value:"mini"},{name:c("size.small"),value:"small"},{name:c("size.medium"),value:"medium"},{name:c("size.large"),value:"large"}]),se=te(()=>[{title:c("common.provider"),dataIndex:"provider_name",slotName:"provider_name",align:"center",width:120},{title:c("model.agent.label.name"),dataIndex:"name",slotName:"name",align:"center",ellipsis:!0,tooltip:!0},{title:c("common.bind_group"),dataIndex:"group_names",slotName:"group_names",align:"center",ellipsis:!0,tooltip:!0},{title:c("common.bind_models"),dataIndex:"model_names",slotName:"model_names",align:"center",ellipsis:!0,tooltip:!0},{title:c("common.weight"),dataIndex:"weight",slotName:"weight",align:"center"},{title:c("common.lb_strategy"),dataIndex:"lb_strategy",slotName:"lb_strategy",align:"center"},{title:c("common.remark"),dataIndex:"remark",slotName:"remark",align:"center",ellipsis:!0,tooltip:!0},{title:c("common.status"),dataIndex:"status",slotName:"status",align:"center",width:65},{title:c("common.updated_at"),dataIndex:"updated_at",slotName:"updated_at",align:"center",width:132},{title:c("common.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:200}]),V=te(()=>[{label:c("dict.status.1"),value:1},{label:c("dict.status.2"),value:2}]),j=async(l={...I})=>{y(!0);try{const{data:d}=await At(l);f.value=d.items,q.current=l.current,q.pageSize=l.pageSize,q.total=d.paging.total}catch{}finally{y(!1),$.value.selectAll(!1)}};j();const R=()=>{j({...I,...k.value})},ie=l=>{j({...I,...k.value,current:l})},pe=l=>{I.pageSize=l,j({...I,...k.value})},de=()=>{k.value=J(),R()},Ve=(l,d)=>{h.value=l},K=(l,d,M)=>{l?_.value.splice(M,0,d):_.value=b.value.filter(D=>D.dataIndex!==d.dataIndex)},ue=(l,d,M,D=!1)=>{const S=D?ae(l):l;return d>-1&&M>-1&&S.splice(d,1,S.splice(M,1,S[d]).pop()),S},ce=l=>{l&&kt(()=>{const d=document.getElementById("tableSetting");new Pt(d,{onEnd(M){const{oldIndex:D,newIndex:S}=M;ue(_.value,D,S),ue(b.value,D,S)}})})};ke(()=>se.value,l=>{_.value=ae(l),_.value.forEach((d,M)=>{d.checked=!0}),b.value=ae(_.value)},{deep:!0,immediate:!0});const re=g([]);(async()=>{try{const{data:l}=await We();re.value=l.items}catch{}})();const Q=g([]);(async()=>{try{const{data:l}=await qt();Q.value=l.items}catch{}})();const a=async l=>{y(!0);try{await Nt(l),le.success(c("success.operate")),R()}catch{}finally{y(!1)}},r=l=>{L.value=l,N.value=!l.length},x=l=>{if(L.value.length===0)le.info(c("placeholder.operation.data"));else{let d=c("placeholder.batch.operation",{count:L.value.length});switch(l.action){case"status":l.value===1?d=c("placeholder.batch.operation.enable",{count:L.value.length}):d=c("placeholder.batch.operation.disable",{count:L.value.length});break;case"delete":d=c("placeholder.batch.operation.delete",{count:L.value.length});break}Me.warning({title:c("modal.warning.title"),titleAlign:"center",content:d,okText:c("button.ok"),cancelText:c("button.cancel"),hideCancel:!1,onOk:()=>{y(!0),l.ids=L.value,Ut(l).then(M=>{y(!1),le.success(c("success.operate")),R(),$.value.selectAll(!1)})}})}},P=g(!1),w=g(),z=l=>{P.value=!0,w.value=l},O=()=>{P.value=!1},E=g(!1),G=g(!1),H=g(),be=l=>{E.value=!0,w.value=l,H.value="agent"},Z=l=>{G.value=!0,w.value=l,H.value="agent"};return(l,d)=>{const M=it,D=$t,S=wt,me=Ne,X=Ue,T=Pe,s=Be,W=qe,ve=Te,Je=Fe,Ie=Re,Ke=Ee,U=He,Se=dt,Le=je,fe=Ct,Qe=ut,Ze=Vt,Xe=xt,Ye=rt,et=mt,tt=It,lt=St,at=Lt,ot=Oe,nt=zt,ze=Me,st=Ge;return o(),p("div",yl,[t(S,{class:"container-breadcrumb"},{default:e(()=>[t(D,null,{default:e(()=>[t(M)]),_:1}),t(D,null,{default:e(()=>[v(i(l.$t("model.agent.menu")),1)]),_:1})]),_:1}),t(st,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:e(()=>[t(ve,null,{default:e(()=>[t(s,{flex:1},{default:e(()=>[t(Je,{model:k.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(ve,{gutter:16},{default:e(()=>[t(s,{span:8},{default:e(()=>[t(T,{field:"provider_id",label:l.$t("common.provider")},{default:e(()=>[t(X,{modelValue:k.value.provider_id,"onUpdate:modelValue":d[0]||(d[0]=n=>k.value.provider_id=n),placeholder:l.$t("common.all"),scrollbar:!1,"allow-search":"","allow-clear":""},{default:e(()=>[(o(!0),p(Y,null,ee(re.value,n=>(o(),m(me,{key:n.id,value:n.id,label:n.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(s,{span:8},{default:e(()=>[t(T,{field:"name",label:l.$t("model.agent.label.name")},{default:e(()=>[t(W,{modelValue:k.value.name,"onUpdate:modelValue":d[1]||(d[1]=n=>k.value.name=n),placeholder:l.$t("model.agent.placeholder.name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(s,{span:8},{default:e(()=>[t(T,{field:"base_url",label:l.$t("model.agent.label.base_url")},{default:e(()=>[t(W,{modelValue:k.value.base_url,"onUpdate:modelValue":d[2]||(d[2]=n=>k.value.base_url=n),placeholder:l.$t("model.agent.error.required.base_url"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(s,{span:8},{default:e(()=>[t(T,{field:"models",label:l.$t("common.bind_models")},{default:e(()=>[t(X,{modelValue:k.value.models,"onUpdate:modelValue":d[3]||(d[3]=n=>k.value.models=n),placeholder:l.$t("common.all"),"max-tag-count":2,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:e(()=>[(o(!0),p(Y,null,ee(Q.value,n=>(o(),m(me,{key:n.id,value:n.id,label:n.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(s,{span:8},{default:e(()=>[t(T,{field:"status",label:l.$t("common.status")},{default:e(()=>[t(X,{modelValue:k.value.status,"onUpdate:modelValue":d[4]||(d[4]=n=>k.value.status=n),placeholder:l.$t("common.all"),options:C(V),scrollbar:!1,"allow-clear":""},null,8,["modelValue","placeholder","options"])]),_:1},8,["label"])]),_:1}),t(s,{span:8},{default:e(()=>[t(T,{field:"remark",label:l.$t("common.remark")},{default:e(()=>[t(W,{modelValue:k.value.remark,"onUpdate:modelValue":d[5]||(d[5]=n=>k.value.remark=n),placeholder:l.$t("placeholder.remark"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(Ie,{style:{height:"84px"},direction:"vertical"}),t(s,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[t(Le,{direction:"vertical",size:18},{default:e(()=>[t(U,{type:"primary",onClick:R},{icon:e(()=>[t(Ke)]),default:e(()=>[v(" "+i(l.$t("button.search")),1)]),_:1}),t(U,{onClick:de},{icon:e(()=>[t(Se)]),default:e(()=>[v(" "+i(l.$t("button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(Ie,{style:{"margin-top":"0","margin-bottom":"16px"}}),t(ve,{style:{"margin-bottom":"16px"}},{default:e(()=>[t(s,{span:12},{default:e(()=>[t(Le,null,{default:e(()=>[t(U,{type:"primary",onClick:d[6]||(d[6]=n=>l.$router.push({name:"ModelAgentCreate"}))},{default:e(()=>[v(i(l.$t("button.create")),1)]),_:1}),t(U,{type:"primary",status:"success",disabled:N.value,title:N.value?l.$t("placeholder.operation.data"):"",onClick:d[7]||(d[7]=n=>x({action:"status",value:1}))},{default:e(()=>[v(i(l.$t("button.enable")),1)]),_:1},8,["disabled","title"]),t(U,{type:"primary",status:"danger",disabled:N.value,title:N.value?l.$t("placeholder.operation.data"):"",onClick:d[8]||(d[8]=n=>x({action:"status",value:2}))},{default:e(()=>[v(i(l.$t("button.disable")),1)]),_:1},8,["disabled","title"]),t(U,{type:"primary",status:"danger",disabled:N.value,title:N.value?l.$t("placeholder.operation.data"):"",onClick:d[9]||(d[9]=n=>x({action:"delete"}))},{default:e(()=>[v(i(l.$t("button.delete")),1)]),_:1},8,["disabled","title"])]),_:1})]),_:1}),t(s,{span:12,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:e(()=>[t(fe,{content:l.$t("action.refresh")},{default:e(()=>[F("div",{class:"action-icon",onClick:R},[t(Se,{size:"18"})])]),_:1},8,["content"]),t(Xe,{onSelect:Ve},{content:e(()=>[(o(!0),p(Y,null,ee(C(ne),n=>(o(),m(Ze,{key:n.value,value:n.value,class:ht({active:n.value===h.value})},{default:e(()=>[F("span",null,i(n.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[t(fe,{content:l.$t("action.density")},{default:e(()=>[F("div",hl,[t(Qe,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(fe,{content:l.$t("action.column_setting")},{default:e(()=>[t(lt,{trigger:"click",position:"bl",onPopupVisibleChange:ce},{content:e(()=>[F("div",$l,[(o(!0),p(Y,null,ee(b.value,(n,A)=>(o(),p("div",{key:n.dataIndex,class:"setting"},[F("div",wl,[t(et)]),F("div",null,[t(tt,{modelValue:n.checked,"onUpdate:modelValue":ge=>n.checked=ge,onChange:ge=>K(ge,n,A)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),F("div",Cl,i(n.title),1)]))),128))])]),default:e(()=>[F("div",kl,[t(Ye,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(ot,{ref_key:"tableRef",ref:$,"row-key":"id",loading:C(B),pagination:q,columns:_.value,data:f.value,bordered:!1,size:h.value,"row-selection":u,onPageChange:ie,onPageSizeChange:pe,onSelectionChange:r},{group_names:e(({record:n})=>{var A;return[v(i(((A=n==null?void 0:n.group_names)==null?void 0:A.join(","))||"-"),1)]}),model_names:e(({record:n})=>[n.model_names?(o(),p("span",Vl,[t(U,{type:"text",size:"small",onClick:A=>be(n.id)},{default:e(()=>[v(i(l.$t("button.view")),1)]),_:2},1032,["onClick"])])):(o(),p("span",xl,i("-")))]),weight:e(({record:n})=>[v(i(n.weight||0),1)]),lb_strategy:e(({record:n})=>[v(i(l.$t(`dict.lb_strategy.${n.lb_strategy||1}`)),1)]),remark:e(({record:n})=>[v(i(n.remark||"-"),1)]),status:e(({record:n})=>[t(at,{modelValue:n.status,"onUpdate:modelValue":A=>n.status=A,"checked-value":1,"unchecked-value":2,onChange:A=>a({id:n.id,status:n.status})},null,8,["modelValue","onUpdate:modelValue","onChange"])]),operations:e(({record:n})=>[t(U,{type:"text",size:"small",onClick:A=>z(n.id)},{default:e(()=>[v(i(l.$t("button.detail")),1)]),_:2},1032,["onClick"]),t(U,{type:"text",size:"small",onClick:A=>l.$router.push({name:"ModelAgentUpdate",query:{id:n.id}})},{default:e(()=>[v(i(l.$t("button.update")),1)]),_:2},1032,["onClick"]),t(U,{type:"text",size:"small",onClick:A=>l.$router.push({name:"ModelKeyList",query:{agent_id:n.id}})},{default:e(()=>[v(i(l.$t("button.key")),1)]),_:2},1032,["onClick"]),t(U,{type:"text",size:"small",onClick:A=>Z(n.id)},{default:e(()=>[v(i(l.$t("button.test")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),t(nt,{title:l.$t("model.agent.menu.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:P.value,onCancel:O},{default:e(()=>[t(dl,{id:w.value},null,8,["id"])]),_:1},8,["title","visible"]),t(ze,{visible:E.value,"onUpdate:visible":d[10]||(d[10]=n=>E.value=n),title:l.$t("common.bind_models"),"modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"1080px","ok-text":l.$t("button.close")},{default:e(()=>[t(Tt,{id:w.value,action:H.value},null,8,["id","action"])]),_:1},8,["visible","title","ok-text"]),t(ze,{visible:G.value,"onUpdate:visible":d[11]||(d[11]=n=>G.value=n),title:l.$t("model.agent.title.test_models"),"modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"1288px","ok-text":l.$t("button.close"),footer:!1,"hide-title":""},{default:e(()=>[t(gl,{id:w.value,action:H.value},null,8,["id","action"])]),_:1},8,["visible","title","ok-text"])]),_:1})])}}});const ea=De(Sl,[["__scopeId","data-v-b5dbc52d"]]);export{ea as default};
