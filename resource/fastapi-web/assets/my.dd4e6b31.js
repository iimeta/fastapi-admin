import{u as ye,J as ke,s as xe,A as Ce,k as we,B as Ee,_ as De}from"./index.a6a5b9a4.js";/* empty css                *//* empty css                *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css               */import{d as Ie,r as q,e as s,c as H,w as Be,B as l,C as u,aH as e,aG as a,aL as g,aM as i,aJ as B,aI as z,aD as O,F as _,u as J,D as ze,n as Se,aK as Ve,aF as Ae,b1 as Fe,b2 as $e,bM as Me,bK as Ne,bL as Le,bN as Ue,b5 as Pe,bO as Re,ab as Te,aU as Ge,bl as qe,bu as He,bw as Oe,bx as Je,b4 as Ke,bv as je,bQ as Qe,a_ as We,bR as Xe}from"./arco.98c6b47e.js";import{u as Ye}from"./loading.145cbdec.js";import{b as Ze}from"./group.6e6f8681.js";import{c as S,S as et}from"./sortable.esm.9b1f3954.js";import{M as tt}from"./models.85dfadc3.js";import{q as at}from"./model.ccffd283.js";import"./chart.30821537.js";import"./vue.a64f92cf.js";import"./corp.6501cad1.js";const ot={class:"container"},nt={class:"action-icon"},lt={class:"action-icon"},st={id:"tableSetting"},ut={style:{"margin-right":"4px",cursor:"move"}},it={class:"title"},ct={key:0,title:"\u9ED8\u8BA4\u5206\u7EC4"},rt={key:1},dt={key:0},mt={key:1},pt={key:0,class:"circle red"},_t={key:1,class:"circle"},gt={name:"MyGroup"},ft=Ie({...gt,setup(vt){const{loading:K,setLoading:V}=Ye(!0),j=q({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),A=s([]);(async()=>{try{const{data:o}=await at();A.value=o.items}catch{}})();const Q=()=>({name:"",models:[],model_agents:[],status:s(),remark:"",expires_at:[]}),{t:c}=ye(),F=s([]),r=s(Q()),f=s([]),h=s([]),x=s("medium"),$=s(),b={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},y=q({...b}),W=H(()=>[{name:c("size.mini"),value:"mini"},{name:c("size.small"),value:"small"},{name:c("size.medium"),value:"medium"},{name:c("size.large"),value:"large"}]),X=H(()=>[{title:c("group.columns.name"),dataIndex:"name",slotName:"name",align:"center",width:168},{title:c("group.columns.discount"),dataIndex:"discount",slotName:"discount",align:"center",width:128},{title:c("group.columns.models"),dataIndex:"model_names",slotName:"model_names",align:"center",width:128},{title:c("group.columns.expires_at"),dataIndex:"expires_at",slotName:"expires_at",align:"center",width:178},{title:c("group.columns.remark"),dataIndex:"remark",slotName:"remark",align:"center"},{title:c("group.columns.status"),dataIndex:"status",slotName:"status",align:"center",width:75}]),k=async(o={...b})=>{V(!0);try{const{data:n}=await Ze(o);F.value=n.items,y.current=o.current,y.pageSize=o.pageSize,y.total=n.paging.total}catch{}finally{V(!1),$.value.selectAll(!1)}},M=()=>{k({...b,...r.value})},Y=o=>{k({...b,...r.value,current:o})},Z=o=>{b.pageSize=o,k({...b,...r.value})};k();const ee=(o,n)=>{x.value=o},te=(o,n,d)=>{o?f.value.splice(d,0,n):f.value=h.value.filter(m=>m.dataIndex!==n.dataIndex)},N=(o,n,d,m=!1)=>{const p=m?S(o):o;return n>-1&&d>-1&&p.splice(n,1,p.splice(d,1,p[n]).pop()),p},ae=o=>{o&&Se(()=>{const n=document.getElementById("tableSetting");new et(n,{onEnd(d){const{oldIndex:m,newIndex:p}=d;N(f.value,m,p),N(h.value,m,p)}})})};Be(()=>X.value,o=>{f.value=S(o),f.value.forEach((n,d)=>{n.checked=!0}),h.value=S(f.value)},{deep:!0,immediate:!0});const C=s(!1),L=s(),U=s(),oe=o=>{C.value=!0,L.value=o,U.value="group"};return(o,n)=>{const d=ke,m=Ve,p=Ae,P=Fe,w=$e,v=Me,ne=Ne,le=Le,E=Ue,se=Pe,R=Re,ue=Te,T=Ge,ie=qe,ce=xe,D=He,re=Ce,de=Oe,me=Je,pe=we,_e=Ee,ge=Ke,fe=je,ve=Qe,be=We,he=Xe;return l(),u("div",ot,[e(p,{class:"container-breadcrumb"},{default:a(()=>[e(m,null,{default:a(()=>[e(d)]),_:1}),e(m,null,{default:a(()=>[g(i(o.$t("menu.my.group")),1)]),_:1})]),_:1}),e(he,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:a(()=>[e(E,null,{default:a(()=>[e(v,{flex:1},{default:a(()=>[e(se,{model:r.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(E,{gutter:16},{default:a(()=>[e(v,{span:8},{default:a(()=>[e(w,{field:"name",label:o.$t("group.form.name")},{default:a(()=>[e(P,{modelValue:r.value.name,"onUpdate:modelValue":n[0]||(n[0]=t=>r.value.name=t),placeholder:o.$t("group.form.name.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(v,{span:8},{default:a(()=>[e(w,{field:"models",label:o.$t("group.form.models")},{default:a(()=>[e(le,{modelValue:r.value.models,"onUpdate:modelValue":n[1]||(n[1]=t=>r.value.models=t),placeholder:o.$t("group.form.selectDefault"),"max-tag-count":2,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:a(()=>[(l(!0),u(B,null,z(A.value,t=>(l(),O(ne,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(v,{span:8},{default:a(()=>[e(w,{field:"remark",label:o.$t("group.form.remark")},{default:a(()=>[e(P,{modelValue:r.value.remark,"onUpdate:modelValue":n[2]||(n[2]=t=>r.value.remark=t),placeholder:o.$t("group.form.remark.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(R,{style:{height:"42px"},direction:"vertical"}),e(v,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(ie,{direction:"vertical",size:18},{default:a(()=>[e(T,{type:"primary",onClick:M},{icon:a(()=>[e(ue)]),default:a(()=>[g(" "+i(o.$t("group.form.search")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(R,{style:{"margin-top":"0"}}),e(E,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(v,{span:22},{default:a(()=>[g(" \u8BF4\u660E: \u5206\u7EC4\u540D\u79F0\u52A0\u7C97\u7684\u4E3A\u9ED8\u8BA4\u5206\u7EC4, \u9ED8\u8BA4\u6392\u5728\u5217\u8868\u9996\u4F4D, \u5F53\u5E94\u7528\u6216\u5BC6\u94A5\u4E0D\u7ED1\u5B9A\u5206\u7EC4\u65F6, \u8C03\u7528\u6A21\u578B\u5C06\u6309\u5206\u7EC4\u5217\u8868\u987A\u5E8F\u4F9D\u6B21\u67E5\u627E, \u63A8\u8350\u5C06\u5E94\u7528\u6216\u5BC6\u94A5\u7ED1\u5B9A\u5206\u7EC4\u4F7F\u7528 ")]),_:1}),e(v,{span:2,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:a(()=>[e(D,{content:o.$t("actions.refresh")},{default:a(()=>[_("div",{class:"action-icon",onClick:M},[e(ce,{size:"18"})])]),_:1},8,["content"]),e(me,{onSelect:ee},{content:a(()=>[(l(!0),u(B,null,z(J(W),t=>(l(),O(de,{key:t.value,value:t.value,class:ze({active:t.value===x.value})},{default:a(()=>[_("span",null,i(t.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(D,{content:o.$t("actions.density")},{default:a(()=>[_("div",nt,[e(re,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(D,{content:o.$t("actions.column_setting")},{default:a(()=>[e(fe,{trigger:"click",position:"bl",onPopupVisibleChange:ae},{content:a(()=>[_("div",st,[(l(!0),u(B,null,z(h.value,(t,G)=>(l(),u("div",{key:t.dataIndex,class:"setting"},[_("div",ut,[e(_e)]),_("div",null,[e(ge,{modelValue:t.checked,"onUpdate:modelValue":I=>t.checked=I,onChange:I=>te(I,t,G)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_("div",it,i(t.title==="#"?"\u5E8F\u5217\u53F7":t.title),1)]))),128))])]),default:a(()=>[_("div",lt,[e(pe,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(ve,{ref_key:"tableRef",ref:$,"row-key":"id",loading:J(K),pagination:y,columns:f.value,data:F.value,bordered:!1,size:x.value,"row-selection":j,onPageChange:Y,onPageSizeChange:Z},{name:a(({record:t})=>[t.is_default?(l(),u("span",ct,[_("b",null,i(t.name),1)])):(l(),u("span",rt,i(t.name),1))]),discount:a(({record:t})=>[g(i(Number((t.discount*100).toFixed(2)))+"% ",1)]),model_names:a(({record:t})=>[t.model_names?(l(),u("span",dt,[e(T,{type:"text",size:"small",onClick:G=>oe(t.id)},{default:a(()=>[g(" \u67E5\u770B ")]),_:2},1032,["onClick"])])):(l(),u("span",mt,i("-")))]),expires_at:a(({record:t})=>[g(i(t.expires_at||"-"),1)]),remark:a(({record:t})=>[g(i(t.remark||"-"),1)]),status:a(({record:t})=>[t.status===2?(l(),u("span",pt)):(l(),u("span",_t)),g(" "+i(o.$t(`dict.status.${t.status}`)),1)]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),e(be,{visible:C.value,"onUpdate:visible":n[3]||(n[3]=t=>C.value=t),title:o.$t("common.models"),"modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"920px","ok-text":"\u5173\u95ED"},{default:a(()=>[e(tt,{id:L.value,action:U.value},null,8,["id","action"])]),_:1},8,["visible","title"])]),_:1})])}}});const Ht=De(ft,[["__scopeId","data-v-debb7f04"]]);export{Ht as default};
