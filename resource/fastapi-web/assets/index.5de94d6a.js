import{u as Z,z as x,_ as ee}from"./index.35e1896c.js";/* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css                */import{d as le,e as p,B as v,C as V,aH as e,aG as r,aL as s,aM as _,D,aJ as R,aI as F,aD as L,bn as ae,bo as oe,u as te,aK as re,aF as de,bJ as ne,bF as se,bG as ue,b2 as me,b1 as ie,aS as pe,bO as _e,bP as ce,aT as be,a5 as ve,aU as ge,a4 as fe,bQ as ye,bi as he,b5 as Ve,bN as ke,bR as $e,g as we}from"./arco.cbac690a.js";import{u as Ue}from"./loading.b56ef223.js";import{f as Ce}from"./vue.4014b72a.js";import{d as Me}from"./agent.cd58af2e.js";import{q as Be}from"./provider.1c49920f.js";import{b as Ie}from"./model.48ba2ee7.js";import"./chart.e521dee8.js";const qe={class:"container"},De={class:"wrapper"},Re={class:"submit-btn"},Fe={name:"ModelAgentCreate"},Le=le({...Fe,setup(Se){const{loading:S,setLoading:u}=Ue(!1),{proxy:A}=we(),P=Ce(),{t:m}=Z(),c=p([]),k=new Map;(async()=>{u(!0);try{const{data:a}=await Be();c.value=a.items;for(let o=0;o<c.value.length;o+=1)k.set(c.value[o].id,c.value[o])}catch{}finally{u(!1)}})();const i=p(m("key.placeholder.key")),T=async()=>{switch(k.get(l.value.provider_id).code){case"Baidu":i.value=m("key.placeholder.key.baidu");break;case"Xfyun":i.value=m("key.placeholder.key.xfyun");break;case"DeepSeek-Baidu":i.value=m("key.placeholder.key.deepseek.baidu");break;case"VolcEngine":i.value=m("key.placeholder.key.volcengine");break;default:i.value=m("key.placeholder.key")}},$=p([]);(async()=>{u(!0);try{const{data:a}=await Ie();$.value=a.items}catch{}finally{u(!1)}})();const w=p(),l=p({provider_id:"",name:"",base_url:"",path:"",weight:p(20),remark:"",models:[],is_enable_model_replace:!1,replace_models:[],target_models:[],is_never_disable:!1,lb_strategy:"1",key:"",is_agents_only:!0,is_never_disable_key:!1}),E=async()=>{var o;if(!await((o=w.value)==null?void 0:o.validate())){u(!0);try{await Me(l.value).then(()=>{A.$message.success("\u65B0\u5EFA\u6210\u529F"),P.push({name:"ModelAgentList"})})}catch{}finally{u(!1)}}},N=()=>{l.value.is_enable_model_replace?U():(l.value.replace_models=[],l.value.target_models=[])},U=()=>{l.value.replace_models.push(""),l.value.target_models.push("")},z=a=>{l.value.replace_models.length>1&&(l.value.replace_models.splice(a,1),l.value.target_models.splice(a,1))};return(a,o)=>{const C=x,h=re,O=de,M=ne,G=se,J=ue,d=me,b=ie,K=pe,B=_e,H=ce,g=be,Q=ve,f=ge,X=fe,I=ye,q=he,j=Ve,W=ke,Y=$e;return v(),V("div",qe,[e(O,{class:"container-breadcrumb"},{default:r(()=>[e(h,null,{default:r(()=>[e(C)]),_:1}),e(h,null,{default:r(()=>[s(_(a.$t("menu.agent")),1)]),_:1}),e(h,null,{default:r(()=>[s(_(a.$t("menu.model.agent.create")),1)]),_:1})]),_:1}),e(Y,{loading:te(S),style:{width:"100%"}},{default:r(()=>[e(W,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:r(()=>[D("div",De,[e(j,{ref_key:"formRef",ref:w,model:l.value,class:"form","label-col-props":{span:5},"wrapper-col-props":{span:18}},{default:r(()=>[e(M,{orientation:"left"},{default:r(()=>[s(_(a.$t("common.title.baseInfo")),1)]),_:1}),e(d,{field:"provider_id",label:a.$t("model.agent.label.provider"),rules:[{required:!0,message:a.$t("model.agent.error.provider.required")}]},{default:r(()=>[e(J,{modelValue:l.value.provider_id,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value.provider_id=t),placeholder:a.$t("model.agent.placeholder.provider"),scrollbar:!1,"allow-search":"",onChange:T},{default:r(()=>[(v(!0),V(R,null,F(c.value,t=>(v(),L(G,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(d,{field:"name",label:a.$t("model.agent.label.name"),rules:[{required:!0,message:a.$t("model.agent.error.name.required")},{match:/^.{1,100}$/,message:a.$t("model.agent.error.name.pattern")}]},{default:r(()=>[e(b,{modelValue:l.value.name,"onUpdate:modelValue":o[1]||(o[1]=t=>l.value.name=t),placeholder:a.$t("model.agent.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(d,{field:"base_url",label:a.$t("model.agent.label.baseUrl"),rules:[{required:!0,message:a.$t("model.agent.error.baseUrl.required")}]},{default:r(()=>[e(b,{modelValue:l.value.base_url,"onUpdate:modelValue":o[2]||(o[2]=t=>l.value.base_url=t),placeholder:a.$t("model.agent.placeholder.baseUrl")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(d,{field:"path",label:a.$t("model.agent.label.path")},{default:r(()=>[e(b,{modelValue:l.value.path,"onUpdate:modelValue":o[3]||(o[3]=t=>l.value.path=t),placeholder:a.$t("model.agent.placeholder.path")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(d,{field:"weight",label:a.$t("model.agent.label.weight")},{default:r(()=>[e(K,{modelValue:l.value.weight,"onUpdate:modelValue":o[4]||(o[4]=t=>l.value.weight=t),placeholder:a.$t("model.agent.placeholder.weight"),precision:0,min:1,max:100},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(d,{field:"remark",label:a.$t("model.agent.label.remark")},{default:r(()=>[e(B,{modelValue:l.value.remark,"onUpdate:modelValue":o[5]||(o[5]=t=>l.value.remark=t),placeholder:a.$t("model.agent.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(M,{orientation:"left"},{default:r(()=>[s(_(a.$t("common.title.advanced")),1)]),_:1}),e(d,{field:"models",label:a.$t("model.agent.label.models")},{default:r(()=>[e(H,{modelValue:l.value.models,"onUpdate:modelValue":o[6]||(o[6]=t=>l.value.models=t),placeholder:a.$t("model.agent.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:$.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"])]),_:1},8,["label"]),e(d,{field:"is_enable_model_replace",label:a.$t("model.agent.label.is_enable_model_replace")},{default:r(()=>[e(g,{modelValue:l.value.is_enable_model_replace,"onUpdate:modelValue":o[7]||(o[7]=t=>l.value.is_enable_model_replace=t),onChange:N},null,8,["modelValue"])]),_:1},8,["label"]),(v(!0),V(R,null,F(l.value.replace_models,(t,n)=>ae((v(),L(d,{key:n,field:`replace_models[${n}]`&&`target_models[${n}]`,label:`${n+1}. `+a.$t("model.agent.label.replace_models"),rules:[{required:!0,message:a.$t("model.agent.error.replace_models.required")}]},{default:r(()=>[e(b,{modelValue:l.value.replace_models[n],"onUpdate:modelValue":y=>l.value.replace_models[n]=y,placeholder:a.$t("model.agent.placeholder.replace_models"),style:{width:"218px","margin-right":"5px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),e(b,{modelValue:l.value.target_models[n],"onUpdate:modelValue":y=>l.value.target_models[n]=y,placeholder:a.$t("model.agent.placeholder.target_models"),style:{width:"218px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),e(f,{type:"primary",shape:"circle",style:{margin:"0 10px 0 10px"},onClick:U},{default:r(()=>[e(Q)]),_:1}),e(f,{type:"secondary",shape:"circle",onClick:y=>z(n)},{default:r(()=>[e(X)]),_:2},1032,["onClick"])]),_:2},1032,["field","label","rules"])),[[oe,l.value.is_enable_model_replace]])),128)),e(d,{field:"is_never_disable",label:a.$t("model.agent.label.is_never_disable")},{default:r(()=>[e(g,{modelValue:l.value.is_never_disable,"onUpdate:modelValue":o[8]||(o[8]=t=>l.value.is_never_disable=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{field:"lb_strategy",label:a.$t("model.agent.label.lb_strategy")},{default:r(()=>[e(q,{size:"large"},{default:r(()=>[e(I,{modelValue:l.value.lb_strategy,"onUpdate:modelValue":o[9]||(o[9]=t=>l.value.lb_strategy=t),value:"1","default-checked":!0},{default:r(()=>[s(" \u8F6E\u8BE2 ")]),_:1},8,["modelValue"]),e(I,{modelValue:l.value.lb_strategy,"onUpdate:modelValue":o[10]||(o[10]=t=>l.value.lb_strategy=t),value:"2"},{default:r(()=>[s("\u6743\u91CD")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"]),e(d,{field:"key",label:a.$t("model.agent.label.key")},{default:r(()=>[e(B,{modelValue:l.value.key,"onUpdate:modelValue":o[11]||(o[11]=t=>l.value.key=t),placeholder:i.value,"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(d,{field:"is_agents_only",label:a.$t("model.agent.label.isAgentsOnly")},{default:r(()=>[e(g,{modelValue:l.value.is_agents_only,"onUpdate:modelValue":o[12]||(o[12]=t=>l.value.is_agents_only=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(d,{field:"is_never_disable_key",label:a.$t("model.agent.label.is_never_disable_key")},{default:r(()=>[e(g,{modelValue:l.value.is_never_disable_key,"onUpdate:modelValue":o[13]||(o[13]=t=>l.value.is_never_disable_key=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(q,null,{default:r(()=>[D("div",Re,[e(f,{type:"secondary",onClick:o[14]||(o[14]=t=>a.$router.push({name:"ModelAgentList"}))},{default:r(()=>[s(_(a.$t("button.cancel")),1)]),_:1}),e(f,{type:"primary",onClick:E},{default:r(()=>[s(_(a.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const ol=ee(Le,[["__scopeId","data-v-9370947b"]]);export{ol as default};
