import{N as z,_ as H}from"./index.94d25243.js";/* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as J,e as v,B as n,C as V,aH as o,aG as r,aL as s,aM as u,F,aJ as q,aI as w,aD as m,aE as g,u as K,aK as Q,aF as j,bF as A,bG as P,b2 as W,b1 as X,bQ as Y,bi as Z,bO as x,aU as ee,b5 as le,bN as ae,bR as te,g as oe}from"./arco.1da04b1e.js";import{f as re}from"./vue.e32cf078.js";import{u as se}from"./loading.a94ed815.js";import{c as ue}from"./notice.b6009d3c.js";import{q as ne}from"./notice_template.cc1359d6.js";import{q as de}from"./admin_user.a0c62af4.js";import{q as ie}from"./admin_reseller.43185fad.js";import{V as ce}from"./vditor.62b9e20a.js";import"./chart.4f3c6f92.js";/* empty css                */const pe={class:"container"},me={class:"wrapper"},fe={class:"submit-btn"},ve={name:"NoticeCreate"},be=J({...ve,setup(ye){const{proxy:B}=oe(),{loading:T,setLoading:i}=se(!1),R=re(),U=v(),a=v({title:"",content:"",category:"",scope:"1",users:[],resellers:[],channels:["email"],is_popup:!1,priority:v(),expires_at:"",scheduled_time:"",remark:"",status:1}),b=v([]),C=new Map;(async()=>{i(!0);try{const{data:e}=await ne({scenes:["notice"]});b.value=e.items;for(let t=0;t<b.value.length;t+=1)C.set(b.value[t].id,b.value[t])}catch{}finally{i(!1)}})();const D=()=>{const e=C.get(a.value.template);e&&(a.value.title=e.title,a.value.content=e.content,a.value.channels=e.channels)},h=v([]);(async()=>{i(!0);try{const{data:e}=await de();h.value=e.items}catch{}finally{i(!1)}})();const L=v([]);(async()=>{i(!0);try{const{data:e}=await ie();L.value=e.items}catch{}finally{i(!1)}})();const $=async e=>{var y;if(!await((y=U.value)==null?void 0:y.validate())){i(!0);try{a.value.status=e,await ue(a.value).then(()=>{let c="\u64CD\u4F5C\u6210\u529F";e===1?c="\u53D1\u5E03\u6210\u529F":e===2&&(c="\u4FDD\u5B58\u6210\u529F"),B.$message.success(c),R.push({name:"NoticeList"})})}catch{}finally{i(!1)}}};return(e,t)=>{const y=z,c=Q,I=j,d=A,_=P,p=W,S=X,f=Y,N=Z,E=x,k=ee,M=le,G=ae,O=te;return n(),V("div",pe,[o(I,{class:"container-breadcrumb"},{default:r(()=>[o(c,null,{default:r(()=>[o(y)]),_:1}),o(c,null,{default:r(()=>[s(u(e.$t("menu.notice")),1)]),_:1}),o(c,null,{default:r(()=>[s(u(e.$t("menu.notice.create")),1)]),_:1})]),_:1}),o(O,{loading:K(T),style:{width:"100%"}},{default:r(()=>[o(G,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:r(()=>[F("div",me,[o(M,{ref_key:"formRef",ref:U,model:a.value,class:"form","label-col-props":{span:3},"wrapper-col-props":{span:18}},{default:r(()=>[o(p,{label:e.$t("notice.label.template")},{default:r(()=>[o(_,{modelValue:a.value.template,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.template=l),placeholder:e.$t("notice.placeholder.template"),scrollbar:!1,"allow-search":"",onChange:D},{default:r(()=>[(n(!0),V(q,null,w(b.value,l=>(n(),m(d,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(p,{field:"title",label:e.$t("notice.label.title"),rules:[{required:!0,message:e.$t("notice.error.title.required")}]},{default:r(()=>[o(S,{modelValue:a.value.title,"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.title=l),placeholder:e.$t("notice.placeholder.title"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(p,{field:"category",label:e.$t("notice.label.category"),rules:[{required:!0,message:e.$t("notice.error.category.required")}]},{default:r(()=>[o(_,{modelValue:a.value.category,"onUpdate:modelValue":t[2]||(t[2]=l=>a.value.category=l),placeholder:e.$t("notice.placeholder.category"),scrollbar:!1,"allow-search":""},{default:r(()=>[o(d,{value:"service"},{default:r(()=>[s(u(e.$t("notice.dict.category.service")),1)]),_:1}),o(d,{value:"activity"},{default:r(()=>[s(u(e.$t("notice.dict.category.activity")),1)]),_:1}),o(d,{value:"safety"},{default:r(()=>[s(u(e.$t("notice.dict.category.safety")),1)]),_:1}),o(d,{value:"maint"},{default:r(()=>[s(u(e.$t("notice.dict.category.maint")),1)]),_:1}),o(d,{value:"product"},{default:r(()=>[s(u(e.$t("notice.dict.category.product")),1)]),_:1}),o(d,{value:"fault"},{default:r(()=>[s(u(e.$t("notice.dict.category.fault")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(p,{field:"scope",label:e.$t("notice.label.scope"),rules:[{required:!0,message:e.$t("notice.error.scope.required")}]},{default:r(()=>[o(N,{size:"large"},{default:r(()=>[o(f,{modelValue:a.value.scope,"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.scope=l),value:"1"},{default:r(()=>[s(u(e.$t("notice.dict.scope.1")),1)]),_:1},8,["modelValue"]),o(f,{modelValue:a.value.scope,"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.scope=l),value:"2"},{default:r(()=>[s(u(e.$t("notice.dict.scope.2")),1)]),_:1},8,["modelValue"]),o(f,{modelValue:a.value.scope,"onUpdate:modelValue":t[5]||(t[5]=l=>a.value.scope=l),value:"3"},{default:r(()=>[s(u(e.$t("notice.dict.scope.3")),1)]),_:1},8,["modelValue"]),o(f,{modelValue:a.value.scope,"onUpdate:modelValue":t[6]||(t[6]=l=>a.value.scope=l),value:"4"},{default:r(()=>[s(u(e.$t("notice.dict.scope.4")),1)]),_:1},8,["modelValue"]),o(f,{modelValue:a.value.scope,"onUpdate:modelValue":t[7]||(t[7]=l=>a.value.scope=l),value:"5"},{default:r(()=>[s(u(e.$t("notice.dict.scope.5")),1)]),_:1},8,["modelValue"]),o(f,{modelValue:a.value.scope,"onUpdate:modelValue":t[8]||(t[8]=l=>a.value.scope=l),value:"6"},{default:r(()=>[s(u(e.$t("notice.dict.scope.6")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"]),a.value.scope==="4"||a.value.scope==="6"?(n(),m(p,{key:0,field:"users",label:e.$t("notice.label.users"),rules:[{required:!0,message:e.$t("notice.error.users.required")}]},{default:r(()=>[o(_,{modelValue:a.value.users,"onUpdate:modelValue":t[9]||(t[9]=l=>a.value.users=l),placeholder:e.$t("notice.placeholder.users"),scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:r(()=>[(n(!0),V(q,null,w(h.value,l=>(n(),m(d,{key:l.user_id,value:l.user_id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):g("",!0),a.value.scope==="5"||a.value.scope==="6"?(n(),m(p,{key:1,field:"resellers",label:e.$t("notice.label.resellers"),rules:[{required:!0,message:e.$t("notice.error.resellers.required")}]},{default:r(()=>[o(_,{modelValue:a.value.resellers,"onUpdate:modelValue":t[10]||(t[10]=l=>a.value.resellers=l),placeholder:e.$t("notice.placeholder.resellers"),scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:r(()=>[(n(!0),V(q,null,w(L.value,l=>(n(),m(d,{key:l.user_id,value:l.user_id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):g("",!0),o(p,{field:"content",label:e.$t("notice.label.content"),rules:[{required:!0,message:e.$t("notice.error.content.required")}]},{default:r(()=>[o(ce,{modelValue:a.value.content,"onUpdate:modelValue":t[11]||(t[11]=l=>a.value.content=l),style:{flex:"1"}},null,8,["modelValue"])]),_:1},8,["label","rules"]),o(p,{field:"remark",label:e.$t("notice.label.remark")},{default:r(()=>[o(E,{modelValue:a.value.remark,"onUpdate:modelValue":t[12]||(t[12]=l=>a.value.remark=l),placeholder:e.$t("notice.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(N,null,{default:r(()=>[F("div",fe,[o(k,{type:"secondary",onClick:t[13]||(t[13]=l=>$(2))},{default:r(()=>[s(u(e.$t("button.draft")),1)]),_:1}),a.value.scheduled_time?g("",!0):(n(),m(k,{key:0,type:"primary",onClick:t[14]||(t[14]=l=>$(1))},{default:r(()=>[s(u(e.$t("button.publish")),1)]),_:1})),a.value.scheduled_time?(n(),m(k,{key:1,type:"primary",onClick:t[15]||(t[15]=l=>$(3))},{default:r(()=>[s(u(e.$t("button.scheduled")),1)]),_:1})):g("",!0)])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const He=H(be,[["__scopeId","data-v-4919c851"]]);export{He as default};
