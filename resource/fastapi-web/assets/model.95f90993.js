import{u as Ie,C as Ve,o as ze,x as Se,I as De,y as qe,_ as Ae}from"./index.dc70f908.js";/* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css                *//* empty css               *//* empty css              *//* empty css                */import{c as F,S as Le}from"./sortable.esm.2109e0e3.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              */import{d as Me,r as Q,e as _,c as S,w as Te,B as c,C as f,aH as t,aG as l,aL as u,aM as s,u as D,aJ as q,aI as A,aD as N,F as g,D as Be,n as Fe,aK as Ne,aF as Pe,bC as Ue,b2 as Ke,bA as Ee,b1 as Oe,bB as je,bD as xe,bE as Ge,b5 as Re,bF as He,ab as Je,aU as Qe,bi as We,a5 as Xe,bj as Ye,bl as Ze,bm as et,b4 as tt,bG as at,bH as lt,bI as ot,bJ as nt}from"./arco.aed15247.js";import{h as st}from"./vue.0cc5b64a.js";import{u as it}from"./loading.b5911e1d.js";import{s as ut,q as ct,a as dt}from"./key.b6046ac2.js";import{q as rt}from"./model.4c1fb15d.js";import{e as mt}from"./agent.4d9ba6a8.js";import"./chart.9aa6eafa.js";import"./base.87fcf6e2.js";const pt={class:"container"},_t={class:"action-icon"},yt={class:"action-icon"},ft={id:"tableSetting"},gt={style:{"margin-right":"4px",cursor:"move"}},vt={class:"title"},kt={key:0,class:"circle red"},bt={key:1,class:"circle"},ht={name:"KeyList"},$t=Me({...ht,setup(wt){const P=st(),W=Q({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),U=_([]);(async()=>{try{const{data:e}=await rt();U.value=e.items}catch{}})();const K=_([]);(async()=>{try{const{data:e}=await mt();K.value=e.items}catch{}})();const X=async e=>{b(!0);try{await ut(e),V()}catch{}finally{b(!1)}},E=()=>({type:2,corp:"",key:"",models:[],model_agents:[],quota:_(),status:_(),created_at:[]}),{loading:Y,setLoading:b}=it(!0),{t:i}=Ie(),O=_([]),n=_(E()),v=_([]),w=_([]),L=_("medium"),h={current:1,pageSize:10,showTotal:!0,showPageSize:!0},C=Q({...h}),Z=S(()=>[{name:i("searchTable.size.mini"),value:"mini"},{name:i("searchTable.size.small"),value:"small"},{name:i("searchTable.size.medium"),value:"medium"},{name:i("searchTable.size.large"),value:"large"}]),ee=S(()=>[{title:i("key.columns.corp"),dataIndex:"corp",slotName:"corp",align:"center",width:110},{title:i("key.columns.key"),dataIndex:"key",slotName:"key",align:"center",ellipsis:!0,tooltip:!0},{title:i("key.columns.models"),dataIndex:"model_names",slotName:"model_names",align:"center",ellipsis:!0,tooltip:!0},{title:i("key.columns.quota"),dataIndex:"quota",slotName:"quota",align:"center",width:80},{title:i("key.columns.status"),dataIndex:"status",slotName:"status",align:"center",width:80},{title:i("key.columns.updated_at"),dataIndex:"updated_at",slotName:"updated_at",align:"center",width:170},{title:i("key.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:220}]),te=S(()=>[{label:i("key.dict.corp.OpenAI"),value:"OpenAI"},{label:i("key.dict.corp.Midjourney"),value:"Midjourney"},{label:i("key.dict.corp.GLM"),value:"GLM"}]),ae=S(()=>[{label:i("key.dict.status.1"),value:1},{label:i("key.dict.status.2"),value:2}]),j=new Array(0);P.query.agent_id&&(j[0]=P.query.agent_id);const I=async(e={...h,type:2,model_agents:j})=>{b(!0);try{const{data:o}=await ct(e);O.value=o.items,C.current=e.current,C.pageSize=e.pageSize,C.total=o.paging.total}catch{}finally{b(!1)}},V=()=>{I({...h,...n.value})},le=e=>{I({...h,...n.value,current:e})},oe=e=>{h.pageSize=e,I({...h,...n.value})};I();const ne=()=>{n.value=E()},se=async e=>{b(!0);try{e.status=e.status===1?2:1,await dt(e),V()}catch{}finally{b(!1)}},ie=(e,o)=>{L.value=e},ue=(e,o,m)=>{e?v.value.splice(m,0,o):v.value=w.value.filter(d=>d.dataIndex!==o.dataIndex)},x=(e,o,m,d=!1)=>{const p=d?F(e):e;return o>-1&&m>-1&&p.splice(o,1,p.splice(m,1,p[o]).pop()),p},ce=e=>{e&&Fe(()=>{const o=document.getElementById("tableSetting");new Le(o,{onEnd(m){const{oldIndex:d,newIndex:p}=m;x(v.value,d,p),x(w.value,d,p)}})})};return Te(()=>ee.value,e=>{v.value=F(e),v.value.forEach((o,m)=>{o.checked=!0}),w.value=F(v.value)},{deep:!0,immediate:!0}),(e,o)=>{const m=Ve,d=Ne,p=Pe,z=Ue,$=Ke,r=Ee,de=Oe,G=je,re=xe,M=Ge,me=Re,R=He,pe=Je,k=Qe,H=ze,J=We,_e=Xe,T=Ye,ye=Se,fe=Ze,ge=et,ve=De,ke=qe,be=tt,he=at,$e=lt,we=ot,Ce=nt;return c(),f("div",pt,[t(p,{class:"container-breadcrumb"},{default:l(()=>[t(d,null,{default:l(()=>[t(m)]),_:1}),t(d,null,{default:l(()=>[u(s(e.$t("menu.key")),1)]),_:1}),t(d,null,{default:l(()=>[u(s(e.$t("menu.key.model.list")),1)]),_:1})]),_:1}),t(Ce,{class:"general-card",title:e.$t("menu.key.model.list"),bordered:!1},{default:l(()=>[t(M,null,{default:l(()=>[t(r,{flex:1},{default:l(()=>[t(me,{model:n.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:l(()=>[t(M,{gutter:16},{default:l(()=>[t(r,{span:8},{default:l(()=>[t($,{field:"corp",label:e.$t("key.form.corp")},{default:l(()=>[t(z,{modelValue:n.value.corp,"onUpdate:modelValue":o[0]||(o[0]=a=>n.value.corp=a),options:D(te),placeholder:e.$t("key.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(r,{span:8},{default:l(()=>[t($,{field:"key",label:e.$t("key.form.key")},{default:l(()=>[t(de,{modelValue:n.value.key,"onUpdate:modelValue":o[1]||(o[1]=a=>n.value.key=a),placeholder:e.$t("key.form.key.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(r,{span:8},{default:l(()=>[t($,{field:"models",label:e.$t("key.form.models")},{default:l(()=>[t(z,{modelValue:n.value.models,"onUpdate:modelValue":o[2]||(o[2]=a=>n.value.models=a),placeholder:e.$t("key.form.selectDefault"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:l(()=>[(c(!0),f(q,null,A(U.value,a=>(c(),N(G,{key:a.id,value:a.id,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(r,{span:8},{default:l(()=>[t($,{field:"model_agents",label:e.$t("key.form.modelAgents")},{default:l(()=>[t(z,{modelValue:n.value.model_agents,"onUpdate:modelValue":o[3]||(o[3]=a=>n.value.model_agents=a),placeholder:e.$t("key.form.selectDefault"),"max-tag-count":3,multiple:"","allow-search":"","allow-clear":""},{default:l(()=>[(c(!0),f(q,null,A(K.value,a=>(c(),N(G,{key:a.id,value:a.id,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(r,{span:8},{default:l(()=>[t($,{field:"status",label:e.$t("key.form.status")},{default:l(()=>[t(z,{modelValue:n.value.status,"onUpdate:modelValue":o[4]||(o[4]=a=>n.value.status=a),options:D(ae),placeholder:e.$t("key.form.selectDefault"),"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(r,{span:8},{default:l(()=>[t($,{field:"created_at",label:e.$t("key.form.created_at")},{default:l(()=>[t(re,{modelValue:n.value.created_at,"onUpdate:modelValue":o[5]||(o[5]=a=>n.value.created_at=a),style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(R,{style:{height:"84px"},direction:"vertical"}),t(r,{flex:"86px",style:{"text-align":"right"}},{default:l(()=>[t(J,{direction:"vertical",size:18},{default:l(()=>[t(k,{type:"primary",onClick:V},{icon:l(()=>[t(pe)]),default:l(()=>[u(" "+s(e.$t("key.form.search")),1)]),_:1}),t(k,{onClick:ne},{icon:l(()=>[t(H)]),default:l(()=>[u(" "+s(e.$t("key.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(R,{style:{"margin-top":"0"}}),t(M,{style:{"margin-bottom":"16px"}},{default:l(()=>[t(r,{span:12},{default:l(()=>[t(J,null,{default:l(()=>[t(k,{type:"primary",onClick:o[6]||(o[6]=a=>e.$router.push({name:"KeyCreate"}))},{icon:l(()=>[t(_e)]),default:l(()=>[u(" "+s(e.$t("key.operation.create")),1)]),_:1})]),_:1})]),_:1}),t(r,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:l(()=>[t(T,{content:e.$t("searchTable.actions.refresh")},{default:l(()=>[g("div",{class:"action-icon",onClick:V},[t(H,{size:"18"})])]),_:1},8,["content"]),t(ge,{onSelect:ie},{content:l(()=>[(c(!0),f(q,null,A(D(Z),a=>(c(),N(fe,{key:a.value,value:a.value,class:Be({active:a.value===L.value})},{default:l(()=>[g("span",null,s(a.name),1)]),_:2},1032,["value","class"]))),128))]),default:l(()=>[t(T,{content:e.$t("searchTable.actions.density")},{default:l(()=>[g("div",_t,[t(ye,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(T,{content:e.$t("searchTable.actions.columnSetting")},{default:l(()=>[t(he,{trigger:"click",position:"bl",onPopupVisibleChange:ce},{content:l(()=>[g("div",ft,[(c(!0),f(q,null,A(w.value,(a,y)=>(c(),f("div",{key:a.dataIndex,class:"setting"},[g("div",gt,[t(ke)]),g("div",null,[t(be,{modelValue:a.checked,"onUpdate:modelValue":B=>a.checked=B,onChange:B=>ue(B,a,y)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),g("div",vt,s(a.title==="#"?"\u5E8F\u5217\u53F7":a.title),1)]))),128))])]),default:l(()=>[g("div",yt,[t(ve,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(we,{"row-key":"id",loading:D(Y),pagination:C,columns:v.value,data:O.value,bordered:!1,size:L.value,"row-selection":W,onPageChange:le,onPageSizeChange:oe},{type:l(({record:a})=>[u(s(e.$t(`key.dict.type.${a.type}`)),1)]),corp:l(({record:a})=>[u(s(e.$t(`key.dict.corp.${a.corp}`)),1)]),model_names:l(({record:a})=>{var y;return[u(s(((y=a==null?void 0:a.model_names)==null?void 0:y.join(","))||"-"),1)]}),dataFormat:l(({record:a})=>[u(s(e.$t(`key.dict.data_format.${a.data_format}`)),1)]),quota:l(({record:a})=>[u(s((a==null?void 0:a.quota)||"-"),1)]),status:l(({record:a})=>[a.status===2?(c(),f("span",kt)):(c(),f("span",bt)),u(" "+s(e.$t(`key.dict.status.${a.status}`)),1)]),operations:l(({record:a})=>[t(k,{type:"text",size:"small",onClick:y=>e.$router.push({name:"KeyDetail",query:{id:`${a.id}`}})},{default:l(()=>[u(s(e.$t("key.columns.operations.view")),1)]),_:2},1032,["onClick"]),t(k,{type:"text",size:"small",onClick:y=>e.$router.push({name:"KeyUpdate",query:{id:`${a.id}`}})},{default:l(()=>[u(s(e.$t("key.columns.operations.update")),1)]),_:2},1032,["onClick"]),t(k,{type:"text",size:"small",onClick:y=>se({id:`${a.id}`,status:Number(`${a.status}`)})},{default:l(()=>[u(s(e.$t(`key.columns.operations.status.${a.status}`)),1)]),_:2},1032,["onClick"]),t($e,{content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417?",onOk:y=>X({id:`${a.id}`})},{default:l(()=>[t(k,{type:"text",size:"small"},{default:l(()=>[u(s(e.$t("key.columns.operations.delete")),1)]),_:1})]),_:2},1032,["onOk"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"])]),_:1},8,["title"])])}}});const Wt=Ae($t,[["__scopeId","data-v-e284454d"]]);export{Wt as default};
