import{u as z,O as G,_ as J}from"./index.07f86835.js";/* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               */import{d as K,e as f,B as n,C as y,aH as o,aG as s,aL as r,aM as u,D as B,aJ as k,aI as U,aD as p,aE as V,u as Q,aZ as Z,aK as j,aF as A,bH as P,bI as W,b2 as X,b1 as Y,bQ as x,bi as ee,bT as le,aU as ae,b5 as te,bU as oe,bV as se}from"./arco.73de4031.js";import{f as re}from"./vue.e54f3d1e.js";import{u as ue}from"./loading.0c20cf1b.js";import{c as ne}from"./notice.e9891a77.js";import{q as de}from"./notice_template.b6b04342.js";import{q as ie}from"./admin_user.25fdeb9e.js";import{q as ce}from"./admin_reseller.cbc309cf.js";import{V as pe}from"./vditor.da03d318.js";import"./chart.b5ad42b0.js";/* empty css                */const me={class:"container"},fe={class:"wrapper"},ve={class:"submit-btn"},be={name:"NoticeCreate"},_e=K({...be,setup(ye){const{t:g}=z(),{loading:I,setLoading:w}=ue(!1),R=re(),L=f(),a=f({title:"",content:"",category:"",scope:"1",users:[],resellers:[],channels:["email"],is_popup:!1,priority:f(),expires_at:"",scheduled_time:"",remark:"",status:1}),v=f([]),C=new Map;(async()=>{try{const{data:e}=await de({scenes:["notice"]});v.value=e.items;for(let t=0;t<v.value.length;t+=1)C.set(v.value[t].id,v.value[t])}catch{}})();const F=()=>{const e=C.get(a.value.template);e&&(a.value.title=e.title,a.value.content=e.content,a.value.channels=e.channels)},q=f([]);(async()=>{try{const{data:e}=await ie();q.value=e.items}catch{}})();const N=f([]);(async()=>{try{const{data:e}=await ce();N.value=e.items}catch{}})();const $=async e=>{var b;if(!await((b=L.value)==null?void 0:b.validate())){w(!0);try{a.value.status=e,await ne(a.value).then(()=>{let i=g("success.operate");e===1?i=g("success.publish"):e===2&&(i=g("success.save")),Z.success(i),R.push({name:"NoticeList"})})}catch{}finally{w(!1)}}};return(e,t)=>{const b=G,i=j,D=A,d=P,_=W,c=X,M=Y,m=x,T=ee,S=le,h=ae,E=te,H=oe,O=se;return n(),y("div",me,[o(D,{class:"container-breadcrumb"},{default:s(()=>[o(i,null,{default:s(()=>[o(b)]),_:1}),o(i,null,{default:s(()=>[r(u(e.$t("notice.menu")),1)]),_:1}),o(i,null,{default:s(()=>[r(u(e.$t("notice.menu.create")),1)]),_:1})]),_:1}),o(O,{loading:Q(I),style:{width:"100%"}},{default:s(()=>[o(H,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:s(()=>[B("div",fe,[o(E,{ref_key:"formRef",ref:L,model:a.value,class:"form","label-col-props":{span:3},"wrapper-col-props":{span:18}},{default:s(()=>[o(c,{label:e.$t("notice.label.template")},{default:s(()=>[o(_,{modelValue:a.value.template,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.template=l),placeholder:e.$t("notice.placeholder.template"),scrollbar:!1,"allow-search":"",onChange:F},{default:s(()=>[(n(!0),y(k,null,U(v.value,l=>(n(),p(d,{key:l.id,value:l.id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(c,{field:"title",label:e.$t("notice.label.title"),rules:[{required:!0,message:e.$t("notice.placeholder.title")}]},{default:s(()=>[o(M,{modelValue:a.value.title,"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.title=l),placeholder:e.$t("notice.placeholder.title"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(c,{field:"category",label:e.$t("notice.label.category"),rules:[{required:!0,message:e.$t("notice.placeholder.category")}]},{default:s(()=>[o(_,{modelValue:a.value.category,"onUpdate:modelValue":t[2]||(t[2]=l=>a.value.category=l),placeholder:e.$t("notice.placeholder.category"),scrollbar:!1,"allow-search":""},{default:s(()=>[o(d,{value:"service"},{default:s(()=>[r(u(e.$t("notice.dict.category.service")),1)]),_:1}),o(d,{value:"activity"},{default:s(()=>[r(u(e.$t("notice.dict.category.activity")),1)]),_:1}),o(d,{value:"safety"},{default:s(()=>[r(u(e.$t("notice.dict.category.safety")),1)]),_:1}),o(d,{value:"maint"},{default:s(()=>[r(u(e.$t("notice.dict.category.maint")),1)]),_:1}),o(d,{value:"product"},{default:s(()=>[r(u(e.$t("notice.dict.category.product")),1)]),_:1}),o(d,{value:"fault"},{default:s(()=>[r(u(e.$t("notice.dict.category.fault")),1)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),o(c,{field:"scope",label:e.$t("notice.label.scope"),rules:[{required:!0,message:e.$t("notice.placeholder.scope")}]},{default:s(()=>[o(T,{size:"large"},{default:s(()=>[o(m,{modelValue:a.value.scope,"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.scope=l),value:"1"},{default:s(()=>[r(u(e.$t("notice.dict.scope.1")),1)]),_:1},8,["modelValue"]),o(m,{modelValue:a.value.scope,"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.scope=l),value:"2"},{default:s(()=>[r(u(e.$t("notice.dict.scope.2")),1)]),_:1},8,["modelValue"]),o(m,{modelValue:a.value.scope,"onUpdate:modelValue":t[5]||(t[5]=l=>a.value.scope=l),value:"3"},{default:s(()=>[r(u(e.$t("notice.dict.scope.3")),1)]),_:1},8,["modelValue"]),o(m,{modelValue:a.value.scope,"onUpdate:modelValue":t[6]||(t[6]=l=>a.value.scope=l),value:"4"},{default:s(()=>[r(u(e.$t("notice.dict.scope.4")),1)]),_:1},8,["modelValue"]),o(m,{modelValue:a.value.scope,"onUpdate:modelValue":t[7]||(t[7]=l=>a.value.scope=l),value:"5"},{default:s(()=>[r(u(e.$t("notice.dict.scope.5")),1)]),_:1},8,["modelValue"]),o(m,{modelValue:a.value.scope,"onUpdate:modelValue":t[8]||(t[8]=l=>a.value.scope=l),value:"6"},{default:s(()=>[r(u(e.$t("notice.dict.scope.6")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"]),a.value.scope==="4"||a.value.scope==="6"?(n(),p(c,{key:0,field:"users",label:e.$t("common.user"),rules:[{required:!0,message:e.$t("notice.placeholder.users")}]},{default:s(()=>[o(_,{modelValue:a.value.users,"onUpdate:modelValue":t[9]||(t[9]=l=>a.value.users=l),placeholder:e.$t("notice.placeholder.users"),scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:s(()=>[(n(!0),y(k,null,U(q.value,l=>(n(),p(d,{key:l.user_id,value:l.user_id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):V("",!0),a.value.scope==="5"||a.value.scope==="6"?(n(),p(c,{key:1,field:"resellers",label:e.$t("common.reseller"),rules:[{required:!0,message:e.$t("notice.placeholder.resellers")}]},{default:s(()=>[o(_,{modelValue:a.value.resellers,"onUpdate:modelValue":t[10]||(t[10]=l=>a.value.resellers=l),placeholder:e.$t("notice.placeholder.resellers"),scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:s(()=>[(n(!0),y(k,null,U(N.value,l=>(n(),p(d,{key:l.user_id,value:l.user_id,label:l.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):V("",!0),o(c,{field:"content",label:e.$t("notice.label.content"),rules:[{required:!0,message:e.$t("notice.placeholder.content")}]},{default:s(()=>[o(pe,{modelValue:a.value.content,"onUpdate:modelValue":t[11]||(t[11]=l=>a.value.content=l),style:{flex:"1"}},null,8,["modelValue"])]),_:1},8,["label","rules"]),o(c,{field:"remark",label:e.$t("common.remark")},{default:s(()=>[o(S,{modelValue:a.value.remark,"onUpdate:modelValue":t[12]||(t[12]=l=>a.value.remark=l),placeholder:e.$t("placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(T,null,{default:s(()=>[B("div",ve,[o(h,{type:"secondary",onClick:t[13]||(t[13]=l=>$(2))},{default:s(()=>[r(u(e.$t("button.draft")),1)]),_:1}),a.value.scheduled_time?V("",!0):(n(),p(h,{key:0,type:"primary",onClick:t[14]||(t[14]=l=>$(1))},{default:s(()=>[r(u(e.$t("button.publish")),1)]),_:1})),a.value.scheduled_time?(n(),p(h,{key:1,type:"primary",onClick:t[15]||(t[15]=l=>$(3))},{default:s(()=>[r(u(e.$t("button.scheduled")),1)]),_:1})):V("",!0)])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const Ge=J(_e,[["__scopeId","data-v-5997c824"]]);export{Ge as default};
