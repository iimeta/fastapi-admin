import{u as x,L as ee,_ as le}from"./index.3ddc5c8a.js";/* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                */import{d as ae,e as m,B as i,C as h,aH as l,aG as r,aL as n,aM as c,D as A,aJ as k,aI as $,aD as w,bu as oe,bv as te,u as re,aK as de,aF as se,bL as ne,bH as ue,bI as me,b2 as ie,b1 as pe,aS as _e,bT as ce,bP as be,aT as ge,a5 as ve,aU as fe,a4 as ye,bQ as he,bi as Ve,b5 as ke,bU as $e,bV as we,g as Ue}from"./arco.088e2a49.js";import{u as Ce}from"./loading.6f488126.js";import{f as Ie}from"./vue.bd25b247.js";import{e as Le}from"./model_agent.b21d2d05.js";import{q as Me}from"./provider.f2c64ba7.js";import{q as qe}from"./group.e92ed278.js";import{a as Be}from"./model.b619f321.js";import"./chart.0bfa65d3.js";const De={class:"container"},Re={class:"wrapper"},Se={class:"submit-btn"},Fe={name:"ModelAgentCreate"},Te=ae({...Fe,setup(Ae){const{loading:P,setLoading:u}=Ce(!1),{proxy:E}=Ue(),G=Ie(),{t:p}=x(),b=m([]),U=new Map;(async()=>{u(!0);try{const{data:e}=await Me();b.value=e.items;for(let o=0;o<b.value.length;o+=1)U.set(b.value[o].id,b.value[o])}catch{}finally{u(!1)}})();const _=m(p("key.placeholder.key")),N=async()=>{switch(U.get(a.value.provider_id).code){case"Baidu":_.value=p("key.placeholder.key.baidu");break;case"Xfyun":_.value=p("key.placeholder.key.xfyun");break;case"DeepSeek-Baidu":_.value=p("key.placeholder.key.deepseek.baidu");break;case"VolcEngine":_.value=p("key.placeholder.key.volcengine");break;default:_.value=p("key.placeholder.key")}},C=m([]);(async()=>{try{const{data:e}=await qe();C.value=e.items}catch{}finally{u(!1)}})();const I=m([]);(async()=>{u(!0);try{const{data:e}=await Be();I.value=e.items}catch{}finally{u(!1)}})();const L=m(),a=m({provider_id:"",name:"",base_url:"",path:"",weight:m(20),remark:"",groups:[],models:[],is_enable_model_replace:!1,replace_models:[],target_models:[],is_never_disable:!1,lb_strategy:"1",key:"",is_agents_only:!0,is_never_disable_key:!1}),z=async()=>{var o;if(!await((o=L.value)==null?void 0:o.validate())){u(!0);try{await Le(a.value).then(()=>{E.$message.success("\u65B0\u5EFA\u6210\u529F"),G.push({name:"ModelAgentList"})})}catch{}finally{u(!1)}}},H=()=>{a.value.is_enable_model_replace?M():(a.value.replace_models=[],a.value.target_models=[])},M=()=>{a.value.replace_models.push(""),a.value.target_models.push("")},K=e=>{a.value.replace_models.length>1&&(a.value.replace_models.splice(e,1),a.value.target_models.splice(e,1))};return(e,o)=>{const q=ee,V=de,O=se,B=ne,D=ue,R=me,d=ie,g=pe,J=_e,S=ce,Q=be,v=ge,X=ve,f=fe,j=ye,F=he,T=Ve,W=ke,Y=$e,Z=we;return i(),h("div",De,[l(O,{class:"container-breadcrumb"},{default:r(()=>[l(V,null,{default:r(()=>[l(q)]),_:1}),l(V,null,{default:r(()=>[n(c(e.$t("menu.model.agent")),1)]),_:1}),l(V,null,{default:r(()=>[n(c(e.$t("menu.model.agent.create")),1)]),_:1})]),_:1}),l(Z,{loading:re(P),style:{width:"100%"}},{default:r(()=>[l(Y,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:r(()=>[A("div",Re,[l(W,{ref_key:"formRef",ref:L,model:a.value,class:"form","label-col-props":{span:4}},{default:r(()=>[l(B,{orientation:"left"},{default:r(()=>[n(c(e.$t("common.title.baseInfo")),1)]),_:1}),l(d,{field:"provider_id",label:e.$t("model.agent.label.provider"),rules:[{required:!0,message:e.$t("model.agent.error.provider.required")}]},{default:r(()=>[l(R,{modelValue:a.value.provider_id,"onUpdate:modelValue":o[0]||(o[0]=t=>a.value.provider_id=t),placeholder:e.$t("model.agent.placeholder.provider"),scrollbar:!1,"allow-search":"",onChange:N},{default:r(()=>[(i(!0),h(k,null,$(b.value,t=>(i(),w(D,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),l(d,{field:"name",label:e.$t("model.agent.label.name"),rules:[{required:!0,message:e.$t("model.agent.error.name.required")},{match:/^.{1,100}$/,message:e.$t("model.agent.error.name.pattern")}]},{default:r(()=>[l(g,{modelValue:a.value.name,"onUpdate:modelValue":o[1]||(o[1]=t=>a.value.name=t),placeholder:e.$t("model.agent.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),l(d,{field:"base_url",label:e.$t("model.agent.label.baseUrl"),rules:[{required:!0,message:e.$t("model.agent.error.baseUrl.required")}]},{default:r(()=>[l(g,{modelValue:a.value.base_url,"onUpdate:modelValue":o[2]||(o[2]=t=>a.value.base_url=t),placeholder:e.$t("model.agent.placeholder.baseUrl")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),l(d,{field:"path",label:e.$t("model.agent.label.path")},{default:r(()=>[l(g,{modelValue:a.value.path,"onUpdate:modelValue":o[3]||(o[3]=t=>a.value.path=t),placeholder:e.$t("model.agent.placeholder.path")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,{field:"weight",label:e.$t("model.agent.label.weight")},{default:r(()=>[l(J,{modelValue:a.value.weight,"onUpdate:modelValue":o[4]||(o[4]=t=>a.value.weight=t),placeholder:e.$t("model.agent.placeholder.weight"),precision:0,min:1,max:100},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,{field:"remark",label:e.$t("model.agent.label.remark")},{default:r(()=>[l(S,{modelValue:a.value.remark,"onUpdate:modelValue":o[5]||(o[5]=t=>a.value.remark=t),placeholder:e.$t("model.agent.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(B,{orientation:"left"},{default:r(()=>[n(c(e.$t("common.title.advanced")),1)]),_:1}),l(d,{field:"groups",label:e.$t("model.agent.label.groups")},{default:r(()=>[l(R,{modelValue:a.value.groups,"onUpdate:modelValue":o[6]||(o[6]=t=>a.value.groups=t),placeholder:e.$t("model.agent.placeholder.groups"),"max-tag-count":5,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:r(()=>[(i(!0),h(k,null,$(C.value,t=>(i(),w(D,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,{field:"models",label:e.$t("model.agent.label.models")},{default:r(()=>[l(Q,{modelValue:a.value.models,"onUpdate:modelValue":o[7]||(o[7]=t=>a.value.models=t),placeholder:e.$t("model.agent.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:I.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"])]),_:1},8,["label"]),l(d,{field:"is_enable_model_replace",label:e.$t("model.agent.label.is_enable_model_replace")},{default:r(()=>[l(v,{modelValue:a.value.is_enable_model_replace,"onUpdate:modelValue":o[8]||(o[8]=t=>a.value.is_enable_model_replace=t),onChange:H},null,8,["modelValue"])]),_:1},8,["label"]),(i(!0),h(k,null,$(a.value.replace_models,(t,s)=>oe((i(),w(d,{key:s,field:`replace_models[${s}]`&&`target_models[${s}]`,label:`${s+1}. `+e.$t("model.agent.label.replace_models"),rules:[{required:!0,message:e.$t("model.agent.error.replace_models.required")}]},{default:r(()=>[l(g,{modelValue:a.value.replace_models[s],"onUpdate:modelValue":y=>a.value.replace_models[s]=y,placeholder:e.$t("model.agent.placeholder.replace_models"),style:{width:"42%","margin-right":"5px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),l(g,{modelValue:a.value.target_models[s],"onUpdate:modelValue":y=>a.value.target_models[s]=y,placeholder:e.$t("model.agent.placeholder.target_models"),style:{width:"42%"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),l(f,{type:"primary",shape:"circle",style:{margin:"0 10px 0 10px"},onClick:M},{default:r(()=>[l(X)]),_:1}),l(f,{type:"secondary",shape:"circle",onClick:y=>K(s)},{default:r(()=>[l(j)]),_:2},1032,["onClick"])]),_:2},1032,["field","label","rules"])),[[te,a.value.is_enable_model_replace]])),128)),l(d,{field:"is_never_disable",label:e.$t("model.agent.label.is_never_disable")},{default:r(()=>[l(v,{modelValue:a.value.is_never_disable,"onUpdate:modelValue":o[9]||(o[9]=t=>a.value.is_never_disable=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(d,{field:"lb_strategy",label:e.$t("model.agent.label.lb_strategy")},{default:r(()=>[l(T,{size:"large"},{default:r(()=>[l(F,{modelValue:a.value.lb_strategy,"onUpdate:modelValue":o[10]||(o[10]=t=>a.value.lb_strategy=t),value:"1","default-checked":!0},{default:r(()=>[n(" \u8F6E\u8BE2 ")]),_:1},8,["modelValue"]),l(F,{modelValue:a.value.lb_strategy,"onUpdate:modelValue":o[11]||(o[11]=t=>a.value.lb_strategy=t),value:"2"},{default:r(()=>[n("\u6743\u91CD")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"]),l(d,{field:"key",label:e.$t("model.agent.label.key")},{default:r(()=>[l(S,{modelValue:a.value.key,"onUpdate:modelValue":o[12]||(o[12]=t=>a.value.key=t),placeholder:_.value,"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,{field:"is_agents_only",label:e.$t("model.agent.label.isAgentsOnly")},{default:r(()=>[l(v,{modelValue:a.value.is_agents_only,"onUpdate:modelValue":o[13]||(o[13]=t=>a.value.is_agents_only=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(d,{field:"is_never_disable_key",label:e.$t("model.agent.label.is_never_disable_key")},{default:r(()=>[l(v,{modelValue:a.value.is_never_disable_key,"onUpdate:modelValue":o[14]||(o[14]=t=>a.value.is_never_disable_key=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(T,null,{default:r(()=>[A("div",Se,[l(f,{type:"secondary",onClick:o[15]||(o[15]=t=>e.$router.push({name:"ModelAgentList"}))},{default:r(()=>[n(c(e.$t("button.cancel")),1)]),_:1}),l(f,{type:"primary",onClick:z},{default:r(()=>[n(c(e.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const sl=le(Te,[["__scopeId","data-v-67d2abb6"]]);export{sl as default};
