import{u as ye,H as ke,s as we,A as xe,k as Ie,B as Ce,_ as ze}from"./index.7b3e11e1.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              */import{d as Se,r as R,e as i,c as q,w as Ve,B as l,C as c,aH as a,aG as o,aL as g,aM as s,aJ as V,aI as $,aD as O,D as _,u as j,E as $e,n as De,aK as Be,aF as Le,b1 as Ne,b2 as Me,bG as Ue,bH as Pe,bI as Ae,bK as Fe,b5 as Ee,bL as Ge,ab as He,aU as Te,bi as Re,bj as qe,bk as Oe,bl as je,b4 as Ke,bM as Je,bO as Qe,a_ as We,bU as Xe}from"./arco.73de4031.js";import{u as Ye}from"./loading.0c20cf1b.js";import{b as Ze}from"./group.eeb9a1d4.js";import{c as D,S as ea}from"./sortable.esm.7de80f5d.js";import{M as aa}from"./models.3e7611fe.js";import{q as ta}from"./model.4c831915.js";import"./chart.b5ad42b0.js";import"./vue.e54f3d1e.js";import"./provider.545df5fd.js";const oa={class:"container"},na={class:"action-icon"},la={class:"action-icon"},sa={id:"tableSetting"},ia={style:{"margin-right":"4px",cursor:"move"}},ca={class:"title"},ra=["title"],da={key:1},ua={key:0},ma={key:1},pa={key:0,class:"circle red"},_a={key:1,class:"circle"},ga={name:"MyGroup"},fa=Se({...ga,setup(va){const{loading:K,setLoading:B}=Ye(!0),{t:r}=ye(),J=R({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),Q=()=>({name:"",models:[],model_agents:[],status:i(),remark:"",expires_at:[]}),L=i([]),d=i(Q()),f=i([]),h=i([]),w=i("medium"),N=i(),b={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},y=R({...b}),W=q(()=>[{name:r("size.mini"),value:"mini"},{name:r("size.small"),value:"small"},{name:r("size.medium"),value:"medium"},{name:r("size.large"),value:"large"}]),X=q(()=>[{title:r("group.label.name"),dataIndex:"name",slotName:"name",align:"center",width:168},{title:r("common.discount"),dataIndex:"discount",slotName:"discount",align:"center",width:128},{title:r("common.models"),dataIndex:"model_names",slotName:"model_names",align:"center",width:128},{title:r("common.expires_at"),dataIndex:"expires_at",slotName:"expires_at",align:"center",width:178},{title:r("group.label.remark"),dataIndex:"remark",slotName:"remark",align:"center"},{title:r("common.status"),dataIndex:"status",slotName:"status",align:"center",width:75}]),k=async(e={...b})=>{B(!0);try{const{data:n}=await Ze(e);L.value=n.items,y.current=e.current,y.pageSize=e.pageSize,y.total=n.paging.total}catch{}finally{B(!1),N.value.selectAll(!1)}};k();const M=()=>{k({...b,...d.value})},Y=e=>{k({...b,...d.value,current:e})},Z=e=>{b.pageSize=e,k({...b,...d.value})},ee=(e,n)=>{w.value=e},ae=(e,n,u)=>{e?f.value.splice(u,0,n):f.value=h.value.filter(m=>m.dataIndex!==n.dataIndex)},U=(e,n,u,m=!1)=>{const p=m?D(e):e;return n>-1&&u>-1&&p.splice(n,1,p.splice(u,1,p[n]).pop()),p},te=e=>{e&&De(()=>{const n=document.getElementById("tableSetting");new ea(n,{onEnd(u){const{oldIndex:m,newIndex:p}=u;U(f.value,m,p),U(h.value,m,p)}})})};Ve(()=>X.value,e=>{f.value=D(e),f.value.forEach((n,u)=>{n.checked=!0}),h.value=D(f.value)},{deep:!0,immediate:!0});const P=i([]);(async()=>{try{const{data:e}=await ta();P.value=e.items}catch{}})();const x=i(!1),A=i(),F=i(),oe=e=>{x.value=!0,A.value=e,F.value="group"};return(e,n)=>{const u=ke,m=Be,p=Le,E=Ne,I=Me,v=Ue,ne=Pe,le=Ae,C=Fe,se=Ee,G=Ge,ie=He,H=Te,ce=Re,re=we,z=qe,de=xe,ue=Oe,me=je,pe=Ie,_e=Ce,ge=Ke,fe=Je,ve=Qe,be=We,he=Xe;return l(),c("div",oa,[a(p,{class:"container-breadcrumb"},{default:o(()=>[a(m,null,{default:o(()=>[a(u)]),_:1}),a(m,null,{default:o(()=>[g(s(e.$t("group.menu.my")),1)]),_:1})]),_:1}),a(he,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:o(()=>[a(C,null,{default:o(()=>[a(v,{flex:1},{default:o(()=>[a(se,{model:d.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:o(()=>[a(C,{gutter:16},{default:o(()=>[a(v,{span:8},{default:o(()=>[a(I,{field:"name",label:e.$t("group.label.name")},{default:o(()=>[a(E,{modelValue:d.value.name,"onUpdate:modelValue":n[0]||(n[0]=t=>d.value.name=t),placeholder:e.$t("group.placeholder.name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(v,{span:8},{default:o(()=>[a(I,{field:"models",label:e.$t("common.models")},{default:o(()=>[a(le,{modelValue:d.value.models,"onUpdate:modelValue":n[1]||(n[1]=t=>d.value.models=t),placeholder:e.$t("common.all"),"max-tag-count":2,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:o(()=>[(l(!0),c(V,null,$(P.value,t=>(l(),O(ne,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(v,{span:8},{default:o(()=>[a(I,{field:"remark",label:e.$t("group.label.remark")},{default:o(()=>[a(E,{modelValue:d.value.remark,"onUpdate:modelValue":n[2]||(n[2]=t=>d.value.remark=t),placeholder:e.$t("group.placeholder.remark"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(G,{style:{height:"32px"},direction:"vertical"}),a(v,{flex:"86px",style:{"text-align":"right"}},{default:o(()=>[a(ce,{direction:"vertical",size:18},{default:o(()=>[a(H,{type:"primary",onClick:M},{icon:o(()=>[a(ie)]),default:o(()=>[g(" "+s(e.$t("button.search")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(G,{style:{"margin-top":"0"}}),a(C,{style:{"margin-bottom":"16px"}},{default:o(()=>[a(v,{span:22},{default:o(()=>[g(s(e.$t("group.desc")),1)]),_:1}),a(v,{span:2,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:o(()=>[a(z,{content:e.$t("action.refresh")},{default:o(()=>[_("div",{class:"action-icon",onClick:M},[a(re,{size:"18"})])]),_:1},8,["content"]),a(me,{onSelect:ee},{content:o(()=>[(l(!0),c(V,null,$(j(W),t=>(l(),O(ue,{key:t.value,value:t.value,class:$e({active:t.value===w.value})},{default:o(()=>[_("span",null,s(t.name),1)]),_:2},1032,["value","class"]))),128))]),default:o(()=>[a(z,{content:e.$t("action.density")},{default:o(()=>[_("div",na,[a(de,{size:"18"})])]),_:1},8,["content"])]),_:1}),a(z,{content:e.$t("action.column_setting")},{default:o(()=>[a(fe,{trigger:"click",position:"bl",onPopupVisibleChange:te},{content:o(()=>[_("div",sa,[(l(!0),c(V,null,$(h.value,(t,T)=>(l(),c("div",{key:t.dataIndex,class:"setting"},[_("div",ia,[a(_e)]),_("div",null,[a(ge,{modelValue:t.checked,"onUpdate:modelValue":S=>t.checked=S,onChange:S=>ae(S,t,T)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_("div",ca,s(t.title),1)]))),128))])]),default:o(()=>[_("div",la,[a(pe,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),a(ve,{ref_key:"tableRef",ref:N,"row-key":"id",loading:j(K),pagination:y,columns:f.value,data:L.value,bordered:!1,size:w.value,"row-selection":J,onPageChange:Y,onPageSizeChange:Z},{name:o(({record:t})=>[t.is_default?(l(),c("span",{key:0,title:e.$t("group.detail.is_default")},[_("b",null,s(t.name),1)],8,ra)):(l(),c("span",da,s(t.name),1))]),discount:o(({record:t})=>[g(s(Number((t.discount*100).toFixed(2)))+"% ",1)]),model_names:o(({record:t})=>[t.model_names?(l(),c("span",ua,[a(H,{type:"text",size:"small",onClick:T=>oe(t.id)},{default:o(()=>[g(s(e.$t("button.view")),1)]),_:2},1032,["onClick"])])):(l(),c("span",ma,s("-")))]),expires_at:o(({record:t})=>[g(s(t.expires_at||"-"),1)]),remark:o(({record:t})=>[g(s(t.remark||"-"),1)]),status:o(({record:t})=>[t.status===2?(l(),c("span",pa)):(l(),c("span",_a)),g(" "+s(e.$t(`dict.status.${t.status}`)),1)]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),a(be,{visible:x.value,"onUpdate:visible":n[3]||(n[3]=t=>x.value=t),title:e.$t("common.models"),"modal-style":{padding:"25px 15px 20px 15px"},"unmount-on-close":"","hide-cancel":"",simple:"",width:"1080px","ok-text":e.$t("button.close")},{default:o(()=>[a(aa,{id:A.value,action:F.value},null,8,["id","action"])]),_:1},8,["visible","title","ok-text"])]),_:1})])}}});const Ta=ze(fa,[["__scopeId","data-v-4a3defdf"]]);export{Ta as default};
