import{u as _e,_ as pe,q as Me,z as Oe,j as je,A as Ge}from"./index.b1b911cb.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css              */import{d as me,e as g,w as ee,B as a,C as _,aH as t,aG as e,u as s,aD as d,aL as y,aM as n,aE as re,g as ve,bA as Je,bB as Ke,ad as Qe,bC as Xe,bD as fe,bE as Ye,r as ce,c as K,bF as Ze,bu as Q,aJ as X,aI as Y,D as V,E as et,n as tt,as as at,aK as lt,aF as ot,bH as st,bI as nt,b2 as it,bG as dt,aS as ut,b1 as rt,bJ as ct,bK as _t,b5 as pt,bL as mt,ab as vt,aU as ft,bi as bt,bj as kt,bl as yt,bm as ht,b4 as gt,bM as wt,bO as $t,aV as Ct,bU as Vt}from"./arco.088e2a49.js";import{u as be}from"./loading.6f488126.js";import{f as It}from"./app.4ab0ffd7.js";import{q as Dt,v as xt,a as St}from"./task.4760ddc2.js";import{c as Z,S as zt}from"./sortable.esm.70bb3f9a.js";import{u as ke}from"./vue.bd25b247.js";/* empty css                *//* empty css                */import"./chart.0bfa65d3.js";const Ft={style:{margin:"10px 0 30px 10px"}},Nt={key:1},Lt={key:1},Ut={key:1},Bt={key:1},qt={key:1},At={key:1},Et={key:1},Pt={key:1},Tt={key:1},Rt={key:1},Wt={key:1},Ht={key:1},Mt={key:1},Ot={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},jt={key:1},Gt={key:1},Jt={key:1},Kt={key:1},Qt={key:1},Xt={key:1},Yt={name:"TaskVideoDetail"},Zt=me({...Yt,props:{id:{type:String,default:""}},setup(te){const T=te,{t:r}=_e(),{loading:v,setLoading:U}=be(!0),i=g({}),{copy:B,copied:p}=ke(),{proxy:A}=ve();(async(b={id:T.id})=>{U(!0);try{const{data:h}=await Dt(b);i.value=h}catch{}finally{U(!1)}})();const w=b=>{B(b)};ee(p,()=>{p.value&&A.$message.success("\u590D\u5236\u6210\u529F")});const N=async(b,h)=>{const{data:m}=await xt({id:b,field:h});B(m.value)},L=b=>b?b.startsWith("http://")||b.startsWith("https://")?b:window.location.origin+(b.startsWith("/")?b:`/${b}`):"";return(b,h)=>{const m=Je,c=Ke,I=Qe,f=Xe,z=fe,E=Ye;return a(),_("div",Ft,[t(E,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:e(()=>[t(f,{label:s(r)("task.video.detail.label.trace_id"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Nt,[y(n(i.value.trace_id)+" ",1),t(I,{class:"copy-btn",onClick:h[0]||(h[0]=S=>w(i.value.trace_id))})]))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.creator"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Lt,[y(n(i.value.creator)+" ",1),t(I,{class:"copy-btn",onClick:h[1]||(h[1]=S=>N(i.value.id,"creator"))})]))]),_:1},8,["label"]),t(f,{label:s(r)("common.app_id")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Ut,n(i.value.app_id),1))]),_:1},8,["label"]),t(f,{label:s(r)("common.user_id")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Bt,n(i.value.user_id),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.model")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",qt,n(i.value.model),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.remixed_from_video_id")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",At,n(i.value.remixed_from_video_id||"-"),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.video_id"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Et,[y(n(i.value.video_id)+" ",1),t(I,{class:"copy-btn",onClick:h[2]||(h[2]=S=>w(i.value.video_id))})]))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.video_url"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Pt,[y(n(L(i.value.video_url)||"-")+" ",1),t(I,{class:"copy-btn",onClick:h[3]||(h[3]=S=>w(L(i.value.video_url)))})]))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.prompt"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Tt,n(i.value.prompt),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.width_height")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Rt,n(`${i.value.width} \xD7 ${i.value.height}`),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.seconds")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Wt,n(i.value.seconds),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.progress")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Ht,n(i.value.progress||0),1))]),_:1},8,["label"]),t(f,{label:s(r)("common.status")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Mt,[i.value.status==="completed"?(a(),d(z,{key:0,color:"green"},{default:e(()=>[y(n(b.$t(`task.dict.status.${i.value.status}`)),1)]),_:1})):i.value.status==="queued"?(a(),d(z,{key:1,color:"arcoblue"},{default:e(()=>[y(n(b.$t(`task.dict.status.${i.value.status}`)),1)]),_:1})):i.value.status==="in_progress"?(a(),d(z,{key:2,color:"orange"},{default:e(()=>[y(n(b.$t(`task.dict.status.${i.value.status}`)),1)]),_:1})):i.value.status==="failed"?(a(),d(z,{key:3,color:"red"},{default:e(()=>[y(n(b.$t(`task.dict.status.${i.value.status}`)),1)]),_:1})):(a(),d(z,{key:4,color:"gray"},{default:e(()=>[y(n(b.$t(`task.dict.status.${i.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.error"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Ot,n(i.value.error||"-"),1))]),_:1},8,["label"]),i.value.file_name?(a(),d(f,{key:0,label:s(r)("task.video.detail.label.file_name"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",jt,n(i.value.file_name),1))]),_:1},8,["label"])):re("",!0),i.value.file_path?(a(),d(f,{key:1,label:s(r)("task.video.detail.label.file_path"),span:2},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Gt,n(i.value.file_path),1))]),_:1},8,["label"])):re("",!0),t(f,{label:s(r)("task.video.detail.label.completed_at")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Jt,n(i.value.completed_at||"-"),1))]),_:1},8,["label"]),t(f,{label:s(r)("task.video.detail.label.expires_at")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Kt,n(i.value.expires_at||"-"),1))]),_:1},8,["label"]),t(f,{label:s(r)("common.created_at")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Qt,n(i.value.created_at),1))]),_:1},8,["label"]),t(f,{label:s(r)("common.updated_at")},{default:e(()=>[s(v)?(a(),d(c,{key:0,animation:!0},{default:e(()=>[t(m,{rows:1})]),_:1})):(a(),_("span",Xt,n(i.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const ea=pe(Zt,[["__scopeId","data-v-4216be8b"]]),ta={class:"container"},aa={class:"action-icon"},la={class:"action-icon"},oa={id:"tableSetting"},sa={style:{"margin-right":"4px",cursor:"move"}},na={class:"title"},ia=["onClick"],da=["onClick"],ua={name:"TaskVideoList"},ra=me({...ua,setup(te){const{proxy:T}=ve(),r=localStorage.getItem("userRole"),v=ce({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),U=()=>({user_id:g(),app_id:g(),trace_id:"",video_id:"",video_url:"",status:g(),created_at:[]}),{loading:i,setLoading:B}=be(!0),{t:p}=_e(),A=g([]),k=g(U()),w=g([]),N=g([]),L=g("medium"),b=g(),h=g([]);r==="user"&&(async()=>{try{const{data:l}=await It();h.value=l.items}catch{}})();const c={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},I=ce({...c}),f=K(()=>[{name:p("size.mini"),value:"mini"},{name:p("size.small"),value:"small"},{name:p("size.medium"),value:"medium"},{name:p("size.large"),value:"large"}]),z=K(()=>[{title:p(r==="reseller"||r==="admin"?"task.columns.user_id":"task.columns.app_id"),dataIndex:r==="reseller"||r==="admin"?"user_id":"app_id",slotName:r==="reseller"||r==="admin"?"user_id":"app_id",align:"center",width:75},{title:p("task.columns.model"),dataIndex:"model",slotName:"model",align:"center"},{title:p("task.columns.video_id"),dataIndex:"video_id",slotName:"video_id",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.columns.width_height"),dataIndex:"width_height",slotName:"width_height",align:"center"},{title:p("task.columns.seconds"),dataIndex:"seconds",slotName:"seconds",align:"center"},{title:p("task.columns.video_url"),dataIndex:"video_url",slotName:"video_url",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.columns.status"),dataIndex:"status",slotName:"status",align:"center"},{title:p("task.columns.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:p("task.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),E=K(()=>[{label:p("task.dict.status.queued"),value:"queued"},{label:p("task.dict.status.in_progress"),value:"in_progress"},{label:p("task.dict.status.completed"),value:"completed"},{label:p("task.dict.status.failed"),value:"failed"},{label:p("task.dict.status.expired"),value:"expired"}]);r==="admin"&&E.value.push({label:p("task.dict.status.deleted"),value:"deleted"});const S=async(l={...c})=>{B(!0);try{const{data:u}=await St(l);A.value=u.items,I.current=l.current,I.pageSize=l.pageSize,I.total=u.paging.total}catch{}finally{B(!1)}},R=()=>{S({...c,...k.value})},ye=l=>{S({...c,...k.value,current:l})},he=l=>{c.pageSize=l,S({...c,...k.value})};S();const ge=()=>{k.value=U(),R()},we=(l,u)=>{L.value=l},$e=(l,u,D)=>{l?w.value.splice(D,0,u):w.value=N.value.filter($=>$.dataIndex!==u.dataIndex)},ae=(l,u,D,$=!1)=>{const x=$?Z(l):l;return u>-1&&D>-1&&x.splice(u,1,x.splice(D,1,x[u]).pop()),x},Ce=l=>{l&&tt(()=>{const u=document.getElementById("tableSetting");new zt(u,{onEnd(D){const{oldIndex:$,newIndex:x}=D;ae(w.value,$,x),ae(N.value,$,x)}})})};ee(()=>z.value,l=>{w.value=Z(l),w.value.forEach((u,D)=>{u.checked=!0}),N.value=Z(w.value)},{deep:!0,immediate:!0});const W=g(!1),le=g(),Ve=l=>{W.value=!0,le.value=l},Ie=()=>{W.value=!1},{copy:De,copied:oe}=ke(),se=async l=>{De(l)};ee(oe,()=>{oe.value&&T.$message.success("\u590D\u5236\u6210\u529F")});const ne=l=>l?l.startsWith("http://")||l.startsWith("https://")?l:window.location.origin+(l.startsWith("/")?l:`/${l}`):"";return(l,u)=>{const D=at,$=lt,x=ot,xe=st,ie=nt,F=it,C=dt,Se=ut,H=rt,ze=ct,M=_t,Fe=pt,de=mt,Ne=vt,O=ft,ue=Me,Le=bt,j=kt,Ue=Oe,Be=yt,qe=ht,Ae=je,Ee=Ge,Pe=gt,Te=wt,q=fe,Re=$t,We=Ct,He=Vt,G=Ze("permission");return a(),_("div",ta,[t(x,{class:"container-breadcrumb"},{default:e(()=>[t($,null,{default:e(()=>[t(D)]),_:1}),t($,null,{default:e(()=>[y(n(l.$t("menu.task")),1)]),_:1}),t($,null,{default:e(()=>[y(n(l.$t("menu.task.video.list")),1)]),_:1})]),_:1}),t(He,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:e(()=>[t(M,null,{default:e(()=>[t(C,{flex:1},{default:e(()=>[t(Fe,{model:k.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[t(M,{gutter:16},{default:e(()=>[Q((a(),d(C,{span:8},{default:e(()=>[t(F,{field:"app_id",label:l.$t("task.form.app_id")},{default:e(()=>[t(ie,{modelValue:k.value.app_id,"onUpdate:modelValue":u[0]||(u[0]=o=>k.value.app_id=o),placeholder:l.$t("task.form.selectDefault"),"allow-search":"","allow-clear":""},{default:e(()=>[(a(!0),_(X,null,Y(h.value,o=>(a(),d(xe,{key:o.app_id,value:o.app_id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[G,["user"]]]),Q((a(),d(C,{span:8},{default:e(()=>[t(F,{field:"user_id",label:l.$t("task.form.user_id")},{default:e(()=>[t(Se,{modelValue:k.value.user_id,"onUpdate:modelValue":u[1]||(u[1]=o=>k.value.user_id=o),placeholder:l.$t("task.form.user_id.placeholder"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[G,["reseller","admin"]]]),t(C,{span:8},{default:e(()=>[t(F,{field:"trace_id",label:l.$t("task.form.trace_id")},{default:e(()=>[t(H,{modelValue:k.value.trace_id,"onUpdate:modelValue":u[2]||(u[2]=o=>k.value.trace_id=o),placeholder:l.$t("task.form.trace_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(F,{field:"video_id",label:l.$t("task.form.video_id")},{default:e(()=>[t(H,{modelValue:k.value.video_id,"onUpdate:modelValue":u[3]||(u[3]=o=>k.value.video_id=o),placeholder:l.$t("task.form.video_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(F,{field:"video_url",label:l.$t("task.form.video_url")},{default:e(()=>[t(H,{modelValue:k.value.video_url,"onUpdate:modelValue":u[4]||(u[4]=o=>k.value.video_url=o),placeholder:l.$t("task.form.video_url.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(F,{field:"status",label:l.$t("task.form.status")},{default:e(()=>[t(ie,{modelValue:k.value.status,"onUpdate:modelValue":u[5]||(u[5]=o=>k.value.status=o),options:s(E),placeholder:l.$t("task.form.selectDefault"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),t(C,{span:8},{default:e(()=>[t(F,{field:"created_at",label:l.$t("task.form.created_at")},{default:e(()=>[t(ze,{modelValue:k.value.created_at,"onUpdate:modelValue":u[6]||(u[6]=o=>k.value.created_at=o),placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(de,{style:{height:"84px"},direction:"vertical"}),t(C,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[t(Le,{direction:"vertical",size:18},{default:e(()=>[t(O,{type:"primary",onClick:R},{icon:e(()=>[t(Ne)]),default:e(()=>[y(" "+n(l.$t("task.form.search")),1)]),_:1}),t(O,{onClick:ge},{icon:e(()=>[t(ue)]),default:e(()=>[y(" "+n(l.$t("task.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),Q(t(de,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[G,["reseller","admin"]]]),t(M,{style:{"margin-bottom":"16px"}},{default:e(()=>[t(C,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:e(()=>[t(j,{content:l.$t("actions.refresh")},{default:e(()=>[V("div",{class:"action-icon",onClick:R},[t(ue,{size:"18"})])]),_:1},8,["content"]),t(qe,{onSelect:we},{content:e(()=>[(a(!0),_(X,null,Y(s(f),o=>(a(),d(Be,{key:o.value,value:o.value,class:et({active:o.value===L.value})},{default:e(()=>[V("span",null,n(o.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[t(j,{content:l.$t("actions.density")},{default:e(()=>[V("div",aa,[t(Ue,{size:"18"})])]),_:1},8,["content"])]),_:1}),t(j,{content:l.$t("actions.column_setting")},{default:e(()=>[t(Te,{trigger:"click",position:"bl",onPopupVisibleChange:Ce},{content:e(()=>[V("div",oa,[(a(!0),_(X,null,Y(N.value,(o,P)=>(a(),_("div",{key:o.dataIndex,class:"setting"},[V("div",sa,[t(Ee)]),V("div",null,[t(Pe,{modelValue:o.checked,"onUpdate:modelValue":J=>o.checked=J,onChange:J=>$e(J,o,P)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),V("div",na,n(o.title==="#"?"\u5E8F\u5217\u53F7":o.title),1)]))),128))])]),default:e(()=>[V("div",la,[t(Ae,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),t(Re,{ref_key:"tableRef",ref:b,"row-key":"id",loading:s(i),pagination:I,columns:w.value,data:A.value,bordered:!1,size:L.value,"row-selection":v,onPageChange:ye,onPageSizeChange:he},{video_id:e(({record:o})=>[V("span",{class:"copy-btn",onClick:P=>se(o.video_id)},n(o.video_id||"-"),9,ia)]),width_height:e(({record:o})=>[y(n(`${o.width} \xD7 ${o.height}`),1)]),video_url:e(({record:o})=>[V("span",{class:"copy-btn",onClick:P=>se(ne(o.video_url))},n(ne(o.video_url)||"-"),9,da)]),status:e(({record:o})=>[o.status==="completed"?(a(),d(q,{key:0,color:"green"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="queued"?(a(),d(q,{key:1,color:"arcoblue"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="in_progress"?(a(),d(q,{key:2,color:"orange"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="failed"?(a(),d(q,{key:3,color:"red"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):(a(),d(q,{key:4,color:"gray"},{default:e(()=>[y(n(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024))]),operations:e(({record:o})=>[t(O,{type:"text",size:"small",onClick:P=>Ve(o.id)},{default:e(()=>[y(n(l.$t("task.columns.operations.view")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),t(We,{title:l.$t("menu.task.video.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:W.value,onCancel:Ie},{default:e(()=>[t(ea,{id:le.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const qa=pe(ra,[["__scopeId","data-v-c2388f48"]]);export{qa as default};
