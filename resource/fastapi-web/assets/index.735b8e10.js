import{u as ee,N as le,_ as ae}from"./index.d8c1a639.js";/* empty css              *//* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as oe,e as i,B as p,C as y,aH as a,aG as d,aL as s,aM as n,D as A,aJ as k,aI as $,aD as w,bu as te,bv as de,u as re,aZ as se,aK as ne,aF as ue,bL as me,bH as ie,bI as pe,b2 as _e,b1 as ce,aS as be,bS as ve,b4 as ge,bi as fe,bO as ye,aU as he,aT as Ve,a5 as ke,a4 as $e,bP as we,b5 as Ue,bT as Ce,bU as Me}from"./arco.3f46b4ae.js";import{u as qe}from"./loading.37fd256d.js";import{f as Le}from"./vue.dbcf9bc3.js";import{d as Ie,e as Be}from"./model_agent.e0d06c20.js";import{q as Se}from"./provider.917d0130.js";import{q as De}from"./group.5c33db47.js";import{a as Re}from"./model.40c3f501.js";import"./chart.2cea905d.js";const Te={class:"container"},Fe={class:"wrapper"},Pe={class:"submit-btn"},Ae={name:"ModelAgentCreate"},Ne=oe({...Ae,setup(Ge){const{loading:N,setLoading:U}=qe(!1),G=Le(),{t:m}=ee(),c=i([]),C=new Map;(async()=>{try{const{data:e}=await Se();c.value=e.items;for(let o=0;o<c.value.length;o+=1)C.set(c.value[o].id,c.value[o])}catch{}})();const _=i(m("key.placeholder.key")),z=async()=>{switch(C.get(l.value.provider_id).code){case"Baidu":_.value=m("key.placeholder.key.baidu");break;case"Xfyun":_.value=m("key.placeholder.key.xfyun");break;case"DeepSeek-Baidu":_.value=m("key.placeholder.key.deepseek.baidu");break;case"VolcEngine":_.value=m("key.placeholder.key.volcengine");break;default:_.value=m("key.placeholder.key")}},M=i([]);(async()=>{try{const{data:e}=await De();M.value=e.items}catch{}})();const q=i([]);(async()=>{try{const{data:e}=await Re();q.value=e.items}catch{}})();const L=i(),l=i({provider_id:"",name:"",base_url:"",path:"",weight:i(20),remark:"",billing_methods:[1,2],groups:[],models:[],is_enable_model_replace:!1,replace_models:[],target_models:[],is_never_disable:!1,lb_strategy:"1",key:"",is_agents_only:!0,is_never_disable_key:!1}),E=async()=>{var o;if(!await((o=L.value)==null?void 0:o.validate())){U(!0);try{await Ie(l.value).then(()=>{se.success(m("success.create")),G.push({name:"ModelAgentList"})})}catch{}finally{U(!1)}}},H=()=>{l.value.is_enable_model_replace?I():(l.value.replace_models=[],l.value.target_models=[])},I=()=>{l.value.replace_models.push(""),l.value.target_models.push("")},K=e=>{l.value.replace_models.length>1&&(l.value.replace_models.splice(e,1),l.value.target_models.splice(e,1))},O=async()=>{const{data:e}=await Be({base_url:l.value.base_url,key:l.value.key});e.models&&(l.value.models=[...new Set([...l.value.models,...e.models])])};return(e,o)=>{const B=le,h=ne,J=ue,S=me,D=ie,R=pe,r=_e,b=ce,Q=be,T=ve,F=ge,V=fe,X=ye,v=he,g=Ve,Z=ke,j=$e,P=we,W=Ue,Y=Ce,x=Me;return p(),y("div",Te,[a(J,{class:"container-breadcrumb"},{default:d(()=>[a(h,null,{default:d(()=>[a(B)]),_:1}),a(h,null,{default:d(()=>[s(n(e.$t("model.agent.menu")),1)]),_:1}),a(h,null,{default:d(()=>[s(n(e.$t("model.agent.menu.create")),1)]),_:1})]),_:1}),a(x,{loading:re(N),style:{width:"100%"}},{default:d(()=>[a(Y,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:d(()=>[A("div",Fe,[a(W,{ref_key:"formRef",ref:L,model:l.value,class:"form","label-col-props":{span:4},"wrapper-col-props":{span:18}},{default:d(()=>[a(S,{orientation:"left"},{default:d(()=>[s(n(e.$t("common.title.base_info")),1)]),_:1}),a(r,{field:"provider_id",label:e.$t("common.provider"),rules:[{required:!0,message:e.$t("placeholder.provider")}]},{default:d(()=>[a(R,{modelValue:l.value.provider_id,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value.provider_id=t),placeholder:e.$t("placeholder.provider"),scrollbar:!1,"allow-search":"",onChange:z},{default:d(()=>[(p(!0),y(k,null,$(c.value,t=>(p(),w(D,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(r,{field:"name",label:e.$t("model.agent.label.name"),rules:[{required:!0,message:e.$t("model.agent.placeholder.name")},{match:/^.{1,100}$/,message:e.$t("model.agent.error.pattern.name")}]},{default:d(()=>[a(b,{modelValue:l.value.name,"onUpdate:modelValue":o[1]||(o[1]=t=>l.value.name=t),placeholder:e.$t("model.agent.placeholder.name")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(r,{field:"base_url",label:e.$t("model.agent.label.base_url"),rules:[{required:!0,message:e.$t("model.agent.error.required.base_url")}]},{default:d(()=>[a(b,{modelValue:l.value.base_url,"onUpdate:modelValue":o[2]||(o[2]=t=>l.value.base_url=t),placeholder:e.$t("model.agent.placeholder.base_url")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(r,{field:"path",label:e.$t("model.agent.label.path")},{default:d(()=>[a(b,{modelValue:l.value.path,"onUpdate:modelValue":o[3]||(o[3]=t=>l.value.path=t),placeholder:e.$t("model.agent.placeholder.path")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(r,{field:"weight",label:e.$t("common.weight")},{default:d(()=>[a(Q,{modelValue:l.value.weight,"onUpdate:modelValue":o[4]||(o[4]=t=>l.value.weight=t),placeholder:e.$t("placeholder.weight"),precision:0,min:1,max:100},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(r,{field:"remark",label:e.$t("common.remark")},{default:d(()=>[a(T,{modelValue:l.value.remark,"onUpdate:modelValue":o[5]||(o[5]=t=>l.value.remark=t),placeholder:e.$t("placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(S,{orientation:"left"},{default:d(()=>[s(n(e.$t("common.title.advanced")),1)]),_:1}),a(r,{field:"billing_methods",label:e.$t("common.billing_methods"),rules:[{required:!0,message:e.$t("placeholder.billing_methods")}]},{default:d(()=>[a(V,{size:"large"},{default:d(()=>[a(F,{modelValue:l.value.billing_methods,"onUpdate:modelValue":o[6]||(o[6]=t=>l.value.billing_methods=t),value:1},{default:d(()=>[s(n(e.$t("dict.billing_methods.1")),1)]),_:1},8,["modelValue"]),a(F,{modelValue:l.value.billing_methods,"onUpdate:modelValue":o[7]||(o[7]=t=>l.value.billing_methods=t),value:2},{default:d(()=>[s(n(e.$t("dict.billing_methods.2")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"]),a(r,{field:"groups",label:e.$t("common.bind_group")},{default:d(()=>[a(R,{modelValue:l.value.groups,"onUpdate:modelValue":o[8]||(o[8]=t=>l.value.groups=t),placeholder:e.$t("model.agent.placeholder.groups"),"max-tag-count":5,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:d(()=>[(p(!0),y(k,null,$(M.value,t=>(p(),w(D,{key:t.id,value:t.id,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(r,{field:"models",label:e.$t("common.bind_models")},{default:d(()=>[a(X,{modelValue:l.value.models,"onUpdate:modelValue":o[9]||(o[9]=t=>l.value.models=t),placeholder:e.$t("model.agent.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:q.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"]),a(v,{onClick:O},{default:d(()=>[s(n(e.$t("model.agent.button.quick_fill")),1)]),_:1})]),_:1},8,["label"]),a(r,{field:"is_enable_model_replace",label:e.$t("model.agent.label.replace_models")},{default:d(()=>[a(g,{modelValue:l.value.is_enable_model_replace,"onUpdate:modelValue":o[10]||(o[10]=t=>l.value.is_enable_model_replace=t),onChange:H},null,8,["modelValue"])]),_:1},8,["label"]),(p(!0),y(k,null,$(l.value.replace_models,(t,u)=>te((p(),w(r,{key:u,field:`replace_models[${u}]`&&`target_models[${u}]`,label:`${u+1}. `+e.$t("model.agent.label.replace_models"),rules:[{required:!0,message:e.$t("model.agent.error.required.replace_models")}]},{default:d(()=>[a(b,{modelValue:l.value.replace_models[u],"onUpdate:modelValue":f=>l.value.replace_models[u]=f,placeholder:e.$t("model.agent.placeholder.replace_models"),style:{width:"43%","margin-right":"5px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),a(b,{modelValue:l.value.target_models[u],"onUpdate:modelValue":f=>l.value.target_models[u]=f,placeholder:e.$t("model.agent.placeholder.target_models"),style:{width:"43%","margin-right":"4px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),a(v,{type:"primary",shape:"circle",style:{margin:"0 10px 0 10px"},onClick:I},{default:d(()=>[a(Z)]),_:1}),a(v,{type:"secondary",shape:"circle",onClick:f=>K(u)},{default:d(()=>[a(j)]),_:2},1032,["onClick"])]),_:2},1032,["field","label","rules"])),[[de,l.value.is_enable_model_replace]])),128)),a(r,{field:"is_never_disable",label:e.$t("model.agent.label.is_never_disable")},{default:d(()=>[a(g,{modelValue:l.value.is_never_disable,"onUpdate:modelValue":o[11]||(o[11]=t=>l.value.is_never_disable=t)},null,8,["modelValue"])]),_:1},8,["label"]),a(r,{field:"lb_strategy",label:e.$t("model.agent.label.lb_strategy")},{default:d(()=>[a(V,{size:"large"},{default:d(()=>[a(P,{modelValue:l.value.lb_strategy,"onUpdate:modelValue":o[12]||(o[12]=t=>l.value.lb_strategy=t),value:"1","default-checked":!0},{default:d(()=>[s(n(e.$t("dict.lb_strategy.1")),1)]),_:1},8,["modelValue"]),a(P,{modelValue:l.value.lb_strategy,"onUpdate:modelValue":o[13]||(o[13]=t=>l.value.lb_strategy=t),value:"2"},{default:d(()=>[s(n(e.$t("dict.lb_strategy.2")),1)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"]),a(r,{field:"key",label:e.$t("common.key")},{default:d(()=>[a(T,{modelValue:l.value.key,"onUpdate:modelValue":o[14]||(o[14]=t=>l.value.key=t),placeholder:_.value,"auto-size":{minRows:5,maxRows:10}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(r,{field:"is_agents_only",label:e.$t("model.agent.label.is_agents_only")},{default:d(()=>[a(g,{modelValue:l.value.is_agents_only,"onUpdate:modelValue":o[15]||(o[15]=t=>l.value.is_agents_only=t)},null,8,["modelValue"])]),_:1},8,["label"]),a(r,{field:"is_never_disable_key",label:e.$t("model.agent.label.is_never_disable_key")},{default:d(()=>[a(g,{modelValue:l.value.is_never_disable_key,"onUpdate:modelValue":o[16]||(o[16]=t=>l.value.is_never_disable_key=t)},null,8,["modelValue"])]),_:1},8,["label"]),a(V,null,{default:d(()=>[A("div",Pe,[a(v,{type:"secondary",onClick:o[17]||(o[17]=t=>e.$router.push({name:"ModelAgentList"}))},{default:d(()=>[s(n(e.$t("button.cancel")),1)]),_:1}),a(v,{type:"primary",onClick:E},{default:d(()=>[s(n(e.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const ul=ae(Ne,[["__scopeId","data-v-4fe4dc8a"]]);export{ul as default};
