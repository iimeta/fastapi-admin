import{u as X,C as j,_ as Q}from"./index.b1b911cb.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                */import{d as W,e as n,B as c,C as v,aH as t,aG as r,aL as i,aM as m,D as B,aJ as I,aI as M,aD as D,u as Y,aK as Z,aF as x,bL as ee,bH as ae,bI as le,b2 as te,b1 as oe,aS as re,bT as se,bP as ne,aT as de,aU as ue,bi as ie,b5 as me,bU as pe,bV as ce,g as _e}from"./arco.088e2a49.js";import{u as ye}from"./loading.6f488126.js";import{f as ve,h as fe}from"./vue.bd25b247.js";import{e as be,q as ge}from"./key.36caf57d.js";import{q as ke}from"./provider.9780d5d9.js";import{a as he}from"./model.c9e453b5.js";import{q as we}from"./model_agent.345c3718.js";import"./chart.0bfa65d3.js";const Ve={class:"container"},$e={class:"wrapper"},qe={class:"submit-btn"},Le={name:"KeyUpdate"},Ue=W({...Le,setup(Be){const{loading:C,setLoading:_}=ye(!1),{proxy:K}=_e(),S=ve(),T=fe(),{t:d}=X(),p=n([]),f=new Map,A=async()=>{try{const{data:a}=await ke();p.value=a.items;for(let e=0;e<p.value.length;e+=1)f.set(p.value[e].id,p.value[e])}catch{}},u=n(d("key.placeholder.update.key")),b=async()=>{switch(f.get(l.value.provider_id).code){case"Baidu":u.value=d("key.placeholder.update.key.baidu");break;case"Xfyun":u.value=d("key.placeholder.update.key.xfyun");break;case"DeepSeek-Baidu":u.value=d("key.placeholder.update.key.deepseek.baidu");break;case"VolcEngine":u.value=d("key.placeholder.update.key.volcengine");break;default:u.value=d("key.placeholder.update.key")}},g=n([]);(async()=>{try{const{data:a}=await he();g.value=a.items}catch{}})();const k=n([]);(async()=>{try{const{data:a}=await we();k.value=a.items}catch{}})();const h=n(),l=n({id:"",provider_id:"",key:"",weight:n(20),remark:"",status:1,models:[],model_agents:[],is_agents_only:!1,is_never_disable:!1}),F=async()=>{var e;if(!await((e=h.value)==null?void 0:e.validate())){_(!0);try{await be(l.value).then(()=>{K.$message.success("\u66F4\u65B0\u6210\u529F"),S.push({name:"ModelKeyList"})})}catch{}finally{_(!1)}}};return(async(a={id:T.query.id})=>{_(!0);try{A();const{data:e}=await ge(a);l.value.id=e.id,l.value.provider_id=e.provider_id,l.value.key=e.key,l.value.weight=e.weight,l.value.remark=e.remark,l.value.status=e.status,l.value.models=e.models,l.value.model_agents=e.model_agents,l.value.is_agents_only=e.is_agents_only,l.value.is_never_disable=e.is_never_disable,b()}catch{}finally{_(!1)}})(),(a,e)=>{const w=j,y=Z,R=x,V=ee,$=ae,q=le,s=te,P=oe,N=re,E=se,H=ne,L=de,U=ue,O=ie,z=me,G=pe,J=ce;return c(),v("div",Ve,[t(R,{class:"container-breadcrumb"},{default:r(()=>[t(y,null,{default:r(()=>[t(w)]),_:1}),t(y,null,{default:r(()=>[i(m(a.$t("menu.key")),1)]),_:1}),t(y,null,{default:r(()=>[i(m(a.$t("menu.key.update")),1)]),_:1})]),_:1}),t(J,{loading:Y(C),style:{width:"100%"}},{default:r(()=>[t(G,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:r(()=>[B("div",$e,[t(z,{ref_key:"formRef",ref:h,model:l.value,class:"form","label-col-props":{span:4},"wrapper-col-props":{span:18}},{default:r(()=>[t(V,{orientation:"left"},{default:r(()=>[i(m(a.$t("common.title.baseInfo")),1)]),_:1}),t(s,{field:"provider_id",label:a.$t("key.label.provider"),rules:[{required:!0,message:a.$t("key.error.provider.required")}]},{default:r(()=>[t(q,{modelValue:l.value.provider_id,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.provider_id=o),placeholder:a.$t("key.placeholder.provider"),scrollbar:!1,"allow-search":"",onChange:b},{default:r(()=>[(c(!0),v(I,null,M(p.value,o=>(c(),D($,{key:o.id,value:o.id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),t(s,{field:"key",label:a.$t("key.label.key"),rules:[{required:!0,message:a.$t("key.error.key.required")}]},{default:r(()=>[t(P,{modelValue:l.value.key,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.key=o),placeholder:u.value,"auto-size":{minRows:5,maxRows:10},"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),t(s,{field:"weight",label:a.$t("model.agent.label.weight")},{default:r(()=>[t(N,{modelValue:l.value.weight,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.weight=o),placeholder:a.$t("model.agent.placeholder.weight"),precision:0,min:0,max:999},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(s,{field:"remark",label:a.$t("key.label.remark")},{default:r(()=>[t(E,{modelValue:l.value.remark,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.remark=o),placeholder:a.$t("key.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(V,{orientation:"left"},{default:r(()=>[i(m(a.$t("common.title.advanced")),1)]),_:1}),t(s,{field:"models",label:a.$t("key.label.models")},{default:r(()=>[t(H,{modelValue:l.value.models,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.models=o),placeholder:a.$t("key.placeholder.models"),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:g.value,"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","placeholder","data"])]),_:1},8,["label"]),t(s,{field:"model_agents",label:a.$t("key.label.modelAgents")},{default:r(()=>[t(q,{modelValue:l.value.model_agents,"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.model_agents=o),placeholder:a.$t("key.placeholder.modelAgents"),"max-tag-count":3,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:r(()=>[(c(!0),v(I,null,M(k.value,o=>(c(),D($,{key:o.id,value:o.id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(s,{field:"is_agents_only",label:a.$t("key.label.isAgentsOnly")},{default:r(()=>[t(L,{modelValue:l.value.is_agents_only,"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.is_agents_only=o)},null,8,["modelValue"])]),_:1},8,["label"]),t(s,{field:"is_never_disable",label:a.$t("key.label.is_never_disable")},{default:r(()=>[t(L,{modelValue:l.value.is_never_disable,"onUpdate:modelValue":e[7]||(e[7]=o=>l.value.is_never_disable=o)},null,8,["modelValue"])]),_:1},8,["label"]),t(O,null,{default:r(()=>[B("div",qe,[t(U,{type:"secondary",onClick:e[8]||(e[8]=o=>a.$router.push({name:"ModelKeyList"}))},{default:r(()=>[i(m(a.$t("button.cancel")),1)]),_:1}),t(U,{type:"primary",onClick:F},{default:r(()=>[i(m(a.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const Ye=Q(Ue,[["__scopeId","data-v-4e29f69f"]]);export{Ye as default};
