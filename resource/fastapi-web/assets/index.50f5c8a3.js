import{b as te,J as de,_ as se}from"./index.75dba14e.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css                */import{d as ne,e as m,B as d,C as V,aH as l,aG as r,aL as n,aM as w,D as T,aD as i,aE as p,aJ as q,aI as U,u as _,bu as ie,bv as fe,aK as _e,aF as me,bJ as pe,b1 as ge,b2 as ce,aS as ve,bP as be,aT as we,bO as ye,bQ as Ve,bi as he,bF as $e,bG as ke,bU as qe,b4 as Ue,a5 as Ce,aU as De,a4 as Be,bV as Fe,b5 as Le,bN as Se,bR as Ie,g as Me}from"./arco.241c8905.js";import{u as Ae}from"./loading.09e1934c.js";import{p as N,d as Ee,a as y}from"./common.af12dbbc.js";import{f as Ge}from"./vue.02ada051.js";import{g as He}from"./group.1c7ed74b.js";import{q as Qe,b as Re}from"./model.8c087d7a.js";import{f as Te}from"./agent.255a9cc2.js";import{Q as f}from"./quota.b26100c6.js";import"./chart.31a39ec4.js";const Ne={class:"container"},Pe={class:"wrapper"},Je={class:"submit-btn"},Ke={name:"GroupCreate"},ze=ne({...Ke,setup(Oe){const{loading:P,setLoading:c}=Ae(!1),{proxy:J}=Me(),K=Ge(),L=te(),C=m([]);(async()=>{c(!0);try{const{data:a}=await Qe();C.value=a.items}catch{}finally{c(!1)}})();const S=m([]);(async()=>{c(!0);try{const{data:a}=await Re();S.value=a.items}catch{}finally{c(!1)}})();const I=m([]);(async()=>{c(!0);try{const{data:a}=await Te();I.value=a.items}catch{}finally{c(!1)}})();const M=m(),e=m({name:"",discount:m(),models:[],is_default:!1,is_public:!0,weight:m(),expires_at:"",remark:"",is_enable_model_agent:!1,lb_strategy:"1",model_agents:[],is_limit_quota:!1,quota:m(),is_enable_forward:!1,forward_config:{forward_rule:"1",match_rule:["2"],target_model:"",decision_model:"",keywords:[],target_models:[],content_length:m(),used_quota:m()}}),z=async()=>{var u;if(!await((u=M.value)==null?void 0:u.validate())){c(!0);try{await He(e.value).then(()=>{J.$message.success("\u65B0\u5EFA\u6210\u529F"),K.push({name:"GroupList"})})}catch{}finally{c(!1)}}},O=a=>{e.value.quota=a},j=a=>{e.value.forward_config.used_quota=a},A=()=>{e.value.is_enable_forward?e.value.forward_config.forward_rule==="2"?(e.value.forward_config.keywords=[""],e.value.forward_config.target_models=[""],e.value.forward_config.target_model="",e.value.forward_config.content_length=m()):(e.value.forward_config.forward_rule==="1"||e.value.forward_config.forward_rule==="3"||e.value.forward_config.forward_rule==="4")&&(e.value.forward_config.keywords=[],e.value.forward_config.target_models=[]):(e.value.forward_config.target_model="",e.value.forward_config.keywords=[],e.value.forward_config.target_models=[],e.value.forward_config.content_length=m())},W=()=>{e.value.forward_config.keywords.push(""),e.value.forward_config.target_models.push("")},X=a=>{e.value.forward_config.keywords.length>1&&(e.value.forward_config.keywords.splice(a,1),e.value.forward_config.target_models.splice(a,1))};return(a,u)=>{const E=de,B=_e,Y=me,G=pe,H=ge,t=ce,h=ve,Z=be,$=we,x=ye,s=Ve,F=he,v=$e,k=ke,Q=qe,R=Ue,ee=Ce,D=De,le=Be,ae=Fe,re=Le,oe=Se,ue=Ie;return d(),V("div",Ne,[l(Y,{class:"container-breadcrumb"},{default:r(()=>[l(B,null,{default:r(()=>[l(E)]),_:1}),l(B,null,{default:r(()=>[n(w(a.$t("menu.group")),1)]),_:1}),l(B,null,{default:r(()=>[n(w(a.$t("menu.group.create")),1)]),_:1})]),_:1}),l(ue,{loading:_(P),style:{width:"100%"}},{default:r(()=>[l(oe,{class:"general-card","body-style":{padding:"0 20px 20px 20px"},bordered:!1},{default:r(()=>[T("div",Pe,[l(re,{ref_key:"formRef",ref:M,model:e.value,class:"form","label-col-props":{span:3},"wrapper-col-props":{span:21}},{default:r(()=>[l(G,{orientation:"left"},{default:r(()=>[n(w(a.$t("common.title.baseInfo")),1)]),_:1}),l(t,{field:"name",label:a.$t("group.label.name"),rules:[{required:!0,message:a.$t("group.error.name.required")}]},{default:r(()=>[l(H,{modelValue:e.value.name,"onUpdate:modelValue":u[0]||(u[0]=o=>e.value.name=o),placeholder:a.$t("group.placeholder.name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),l(t,{field:"discount",label:a.$t("group.label.discount"),rules:[{required:!0,message:a.$t("group.error.discount.required")}]},{default:r(()=>[l(h,{modelValue:e.value.discount,"onUpdate:modelValue":u[1]||(u[1]=o=>e.value.discount=o),placeholder:a.$t("group.placeholder.discount"),min:.01,max:9999999999999,"allow-clear":""},{append:r(()=>[n(" % ")]),_:1},8,["modelValue","placeholder","min"])]),_:1},8,["label","rules"]),e.value.is_default?p("",!0):(d(),i(t,{key:0,field:"weight",label:a.$t("group.label.weight"),rules:[{required:!0,message:a.$t("group.error.weight.required")}]},{default:r(()=>[l(h,{modelValue:e.value.weight,"onUpdate:modelValue":u[2]||(u[2]=o=>e.value.weight=o),placeholder:a.$t("group.placeholder.weight"),precision:0,min:1,max:99999,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])),l(t,{field:"models",label:a.$t("group.label.models"),rules:[{required:!0,message:a.$t("group.error.models.required")}]},{default:r(()=>[l(Z,{modelValue:e.value.models,"onUpdate:modelValue":u[3]||(u[3]=o=>e.value.models=o),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,data:S.value,placeholder:a.$t("group.placeholder.models"),"max-tag-count":3,scrollbar:!1,"tree-checked-strategy":"child"},null,8,["modelValue","data","placeholder"])]),_:1},8,["label","rules"]),l(t,{field:"is_public",label:a.$t("group.label.is_public"),rules:[{required:!0}]},{default:r(()=>[l($,{modelValue:e.value.is_public,"onUpdate:modelValue":u[4]||(u[4]=o=>e.value.is_public=o)},null,8,["modelValue"])]),_:1},8,["label"]),l(t,{field:"is_default",label:a.$t("group.label.is_default")},{default:r(()=>[l($,{modelValue:e.value.is_default,"onUpdate:modelValue":u[5]||(u[5]=o=>e.value.is_default=o)},null,8,["modelValue"])]),_:1},8,["label"]),l(t,{field:"remark",label:a.$t("group.label.remark"),rules:[{required:!1}]},{default:r(()=>[l(x,{modelValue:e.value.remark,"onUpdate:modelValue":u[6]||(u[6]=o=>e.value.remark=o),placeholder:a.$t("group.placeholder.remark")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(G,{orientation:"left"},{default:r(()=>[n(w(a.$t("common.title.advanced")),1)]),_:1}),l(t,{field:"is_enable_model_agent",label:a.$t("group.label.is_enable_model_agent")},{default:r(()=>[l($,{modelValue:e.value.is_enable_model_agent,"onUpdate:modelValue":u[7]||(u[7]=o=>e.value.is_enable_model_agent=o)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_enable_model_agent?(d(),i(t,{key:1,field:"lb_strategy",label:a.$t("model.label.lb_strategy"),rules:[{required:!0}]},{default:r(()=>[l(F,{size:"large"},{default:r(()=>[l(s,{modelValue:e.value.lb_strategy,"onUpdate:modelValue":u[8]||(u[8]=o=>e.value.lb_strategy=o),value:"1","default-checked":!0},{default:r(()=>[n(" \u8F6E\u8BE2 ")]),_:1},8,["modelValue"]),l(s,{modelValue:e.value.lb_strategy,"onUpdate:modelValue":u[9]||(u[9]=o=>e.value.lb_strategy=o),value:"2"},{default:r(()=>[n("\u6743\u91CD")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"])):p("",!0),e.value.is_enable_model_agent?(d(),i(t,{key:2,field:"model_agents",label:a.$t("group.label.model_agents"),rules:[{required:!0,message:a.$t("group.error.model_agents.required")}]},{default:r(()=>[l(k,{modelValue:e.value.model_agents,"onUpdate:modelValue":u[10]||(u[10]=o=>e.value.model_agents=o),placeholder:a.$t("group.placeholder.model_agents"),"max-tag-count":3,scrollbar:!1,multiple:"","allow-search":"","allow-clear":""},{default:r(()=>[(d(!0),V(q,null,U(I.value,o=>(d(),i(v,{key:o.id,value:o.id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):p("",!0),l(t,{field:"is_limit_quota",label:a.$t("group.label.is_limit_quota")},{default:r(()=>[l($,{modelValue:e.value.is_limit_quota,"onUpdate:modelValue":u[11]||(u[11]=o=>e.value.is_limit_quota=o)},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_limit_quota?(d(),i(t,{key:3,field:"quota",label:a.$t("group.label.quota"),rules:[{required:!0,message:a.$t("group.error.quota.required")}]},{default:r(()=>[l(h,{modelValue:e.value.quota,"onUpdate:modelValue":u[12]||(u[12]=o=>e.value.quota=o),placeholder:a.$t("group.placeholder.quota"),min:1e-6,max:9999999999999,parser:_(N),"allow-clear":""},{prefix:r(()=>[n(w(_(L).getCurrencySymbol),1)]),_:1},8,["modelValue","placeholder","min","parser"])]),_:1},8,["label","rules"])):p("",!0),e.value.is_limit_quota?(d(),i(t,{key:4},{default:r(()=>[l(Q,{type:"button",onChange:O},{default:r(()=>[l(s,{value:100},{default:r(()=>[l(f,{"model-value":100})]),_:1}),l(s,{value:500},{default:r(()=>[l(f,{"model-value":500})]),_:1}),l(s,{value:1e3},{default:r(()=>[l(f,{"model-value":1e3})]),_:1}),l(s,{value:5e3},{default:r(()=>[l(f,{"model-value":5e3})]),_:1}),l(s,{value:1e4},{default:r(()=>[l(f,{"model-value":1e4})]),_:1}),l(s,{value:5e4},{default:r(()=>[l(f,{"model-value":5e4})]),_:1}),l(s,{value:1e5},{default:r(()=>[l(f,{"model-value":1e5})]),_:1}),l(s,{value:1e6},{default:r(()=>[l(f,{"model-value":1e6})]),_:1})]),_:1})]),_:1})):p("",!0),l(t,{field:"model_forward",label:a.$t("group.label.is_enable_forward")},{default:r(()=>[l($,{modelValue:e.value.is_enable_forward,"onUpdate:modelValue":u[13]||(u[13]=o=>e.value.is_enable_forward=o),onChange:A},null,8,["modelValue"])]),_:1},8,["label"]),e.value.is_enable_forward?(d(),i(t,{key:5,field:"forward_config.forward_rule",label:a.$t("group.label.forward_rule"),rules:[{required:!0,message:a.$t("group.error.forward_rule.required")}]},{default:r(()=>[l(k,{modelValue:e.value.forward_config.forward_rule,"onUpdate:modelValue":u[14]||(u[14]=o=>e.value.forward_config.forward_rule=o),placeholder:a.$t("group.placeholder.forward_rule"),scrollbar:!1,onChange:A},{default:r(()=>[l(v,{value:"1"},{default:r(()=>[n("\u5168\u90E8\u8F6C\u53D1")]),_:1}),l(v,{value:"2"},{default:r(()=>[n("\u6309\u5173\u952E\u5B57")]),_:1}),l(v,{value:"3"},{default:r(()=>[n("\u5185\u5BB9\u957F\u5EA6")]),_:1}),l(v,{value:"4"},{default:r(()=>[n("\u5DF2\u7528\u989D\u5EA6")]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):p("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="3"?(d(),i(t,{key:6,field:"forward_config.content_length",label:a.$t("group.label.content_length"),rules:[{required:!0,message:a.$t("group.error.content_length.required")}]},{default:r(()=>[l(h,{modelValue:e.value.forward_config.content_length,"onUpdate:modelValue":u[15]||(u[15]=o=>e.value.forward_config.content_length=o),placeholder:a.$t("group.placeholder.content_length"),precision:0,min:1,max:9999999999999,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):p("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="4"?(d(),i(t,{key:7,field:"forward_config.used_quota",label:a.$t("group.label.used_quota"),rules:[{required:!0,message:a.$t("group.error.used_quota.required")}]},{default:r(()=>[l(h,{modelValue:e.value.forward_config.used_quota,"onUpdate:modelValue":u[16]||(u[16]=o=>e.value.forward_config.used_quota=o),placeholder:a.$t("group.placeholder.used_quota"),min:1e-6,max:9999999999999,parser:_(N),"allow-clear":""},{prefix:r(()=>[n(w(_(L).getCurrencySymbol),1)]),_:1},8,["modelValue","placeholder","min","parser"])]),_:1},8,["label","rules"])):p("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="4"?(d(),i(t,{key:8},{default:r(()=>[l(Q,{type:"button",onChange:j},{default:r(()=>[l(s,{value:100},{default:r(()=>[l(f,{"model-value":100})]),_:1}),l(s,{value:500},{default:r(()=>[l(f,{"model-value":500})]),_:1}),l(s,{value:1e3},{default:r(()=>[l(f,{"model-value":1e3})]),_:1}),l(s,{value:5e3},{default:r(()=>[l(f,{"model-value":5e3})]),_:1}),l(s,{value:1e4},{default:r(()=>[l(f,{"model-value":1e4})]),_:1}),l(s,{value:5e4},{default:r(()=>[l(f,{"model-value":5e4})]),_:1}),l(s,{value:1e5},{default:r(()=>[l(f,{"model-value":1e5})]),_:1}),l(s,{value:1e6},{default:r(()=>[l(f,{"model-value":1e6})]),_:1})]),_:1})]),_:1})):p("",!0),e.value.is_enable_forward&&(e.value.forward_config.forward_rule==="1"||e.value.forward_config.forward_rule==="3"||e.value.forward_config.forward_rule==="4")?(d(),i(t,{key:9,field:"forward_config.target_model",label:a.$t("group.label.target_model"),rules:[{required:!0,message:a.$t("group.error.target_model.required")}]},{default:r(()=>[l(k,{modelValue:e.value.forward_config.target_model,"onUpdate:modelValue":u[17]||(u[17]=o=>e.value.forward_config.target_model=o),placeholder:a.$t("group.placeholder.target_model"),scrollbar:!1,"allow-search":""},{default:r(()=>[(d(!0),V(q,null,U(C.value,o=>(d(),i(v,{key:o.id,value:o.id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):p("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"?(d(),i(t,{key:10,field:"forward_config.match_rule",label:a.$t("group.label.match_rule"),rules:[{required:!0,message:a.$t("group.error.match_rule.required")}]},{default:r(()=>[l(F,{size:"large"},{default:r(()=>[l(R,{modelValue:e.value.forward_config.match_rule,"onUpdate:modelValue":u[18]||(u[18]=o=>e.value.forward_config.match_rule=o),value:"1","default-checked":!0},{default:r(()=>[n("\u667A\u80FD\u5339\u914D")]),_:1},8,["modelValue"]),l(R,{modelValue:e.value.forward_config.match_rule,"onUpdate:modelValue":u[19]||(u[19]=o=>e.value.forward_config.match_rule=o),value:"2"},{default:r(()=>[n("\u6B63\u5219\u5339\u914D")]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label","rules"])):p("",!0),e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"&&e.value.forward_config.match_rule.includes("1")?(d(),i(t,{key:11,field:"forward_config.decision_model",label:a.$t("group.label.decision_model"),rules:[{required:!0,message:a.$t("group.error.decision_model.required")}]},{default:r(()=>[l(k,{modelValue:e.value.forward_config.decision_model,"onUpdate:modelValue":u[20]||(u[20]=o=>e.value.forward_config.decision_model=o),placeholder:a.$t("group.placeholder.decision_model"),scrollbar:!1,"allow-search":""},{default:r(()=>[(d(!0),V(q,null,U(C.value,o=>(d(),i(v,{key:o.id,value:o.id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):p("",!0),(d(!0),V(q,null,U(e.value.forward_config.keywords,(o,g)=>ie((d(),i(t,{key:g,field:`forward_config.keywords[${g}]`&&`forward_config.target_models[${g}]`,label:`${g+1}. `+a.$t("group.label.keywords"),rules:[{required:!0,message:a.$t("group.error.keywords_target_model.required")}]},{default:r(()=>[l(H,{modelValue:e.value.forward_config.keywords[g],"onUpdate:modelValue":b=>e.value.forward_config.keywords[g]=b,placeholder:a.$t("group.placeholder.keywords"),style:{width:"45%","margin-right":"5px"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),l(k,{modelValue:e.value.forward_config.target_models[g],"onUpdate:modelValue":b=>e.value.forward_config.target_models[g]=b,placeholder:a.$t("group.placeholder.target_model"),scrollbar:!1,style:{width:"40%"},"allow-search":""},{default:r(()=>[(d(!0),V(q,null,U(C.value,b=>(d(),i(v,{key:b.id,value:b.id,label:b.name},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),l(D,{type:"primary",shape:"circle",style:{margin:"0 10px 0 10px"},onClick:W},{default:r(()=>[l(ee)]),_:1}),l(D,{type:"secondary",shape:"circle",onClick:b=>X(g)},{default:r(()=>[l(le)]),_:2},1032,["onClick"])]),_:2},1032,["field","label","rules"])),[[fe,e.value.is_enable_forward&&e.value.forward_config.forward_rule==="2"]])),128)),l(t,{field:"expires_at",label:a.$t("group.label.expires_at")},{default:r(()=>[l(ae,{modelValue:e.value.expires_at,"onUpdate:modelValue":u[21]||(u[21]=o=>e.value.expires_at=o),placeholder:a.$t("group.placeholder.expires_at"),"time-picker-props":{defaultValue:"23:59:59"},"disabled-date":_(Ee),"allow-clear":"",style:{width:"100%"},"show-time":"",shortcuts:[{label:"1",value:()=>_(y)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(1,"day")},{label:"7",value:()=>_(y)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(7,"day")},{label:"15",value:()=>_(y)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(15,"day")},{label:"30",value:()=>_(y)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(30,"day")},{label:"90",value:()=>_(y)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(90,"day")},{label:"180",value:()=>_(y)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(180,"day")},{label:"365",value:()=>_(y)(e.value.expires_at||new Date().setHours(23,59,59,999)).add(365,"day")}]},null,8,["modelValue","placeholder","disabled-date","shortcuts"])]),_:1},8,["label"]),l(F,null,{default:r(()=>[T("div",Je,[l(D,{type:"secondary",onClick:u[22]||(u[22]=o=>a.$router.push({name:"GroupList"}))},{default:r(()=>[n(w(a.$t("button.cancel")),1)]),_:1}),l(D,{type:"primary",onClick:z},{default:r(()=>[n(w(a.$t("button.submit")),1)]),_:1})])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1},8,["loading"])])}}});const yl=se(ze,[["__scopeId","data-v-cdacab20"]]);export{yl as default};
