import{u as re,_ as ce,s as qe,A as We,k as je,B as Ge}from"./index.734acf26.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css              *//* empty css              */import{d as _e,e as h,w as ae,B as t,C as _,aH as e,aG as a,u as s,aD as d,aL as k,aM as i,aE as K,g as pe,bA as Je,bB as Ke,ad as Qe,bC as Xe,bD as me,bE as Ye,r as ue,c as Q,bF as Ze,bu as X,aJ as Y,aI as Z,D as F,E as ea,n as aa,as as ta,aK as la,aF as oa,bH as sa,bI as na,b2 as ia,bG as da,aS as ua,b1 as ra,bJ as ca,bK as _a,b5 as pa,bL as ma,ab as fa,aU as ba,bi as ka,bj as va,bk as ya,bl as ga,b4 as ha,bM as wa,bO as $a,aV as Ca,bU as Va}from"./arco.73de4031.js";import{u as fe}from"./loading.0c20cf1b.js";import{f as Ia}from"./app.ba9166f5.js";import{b as Da,f as xa,c as Fa}from"./task.0aa36374.js";import{c as ee,S as Sa}from"./sortable.esm.7de80f5d.js";import{u as be}from"./vue.e54f3d1e.js";import{f as ke}from"./common.0ef165cd.js";/* empty css                *//* empty css                */import"./chart.b5ad42b0.js";const za={style:{margin:"10px 0 30px 10px"}},Na={key:1},Ba={key:1},La={key:1},Ua={key:1},Aa={key:1},Ea={key:1},Pa={key:1},Ta={key:1},Ra={key:1},Ha={key:1},Ma={key:1},Oa={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},qa={key:1},Wa={key:1},ja={key:1},Ga={key:1},Ja={key:1},Ka={name:"TaskFileDetail"},Qa=_e({...Ka,props:{id:{type:String,default:""}},setup(te){const T=te,{t:r}=re(),{loading:v,setLoading:L}=fe(!0),n=h({}),{copy:U,copied:p}=be(),{proxy:A}=pe();(async(f={id:T.id})=>{L(!0);try{const{data:g}=await Da(f);n.value=g}catch{}finally{L(!1)}})();const w=f=>{U(f)};ae(p,()=>{p.value&&A.$message.success("\u590D\u5236\u6210\u529F")});const z=async(f,g)=>{const{data:b}=await xa({id:f,field:g});U(b.value)},N=f=>f?f.startsWith("http://")||f.startsWith("https://")?f:window.location.origin+(f.startsWith("/")?f:`/${f}`):"";return(f,g)=>{const b=Je,c=Ke,$=Qe,y=Xe,B=me,E=Ye;return t(),_("div",za,[e(E,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:a(()=>[e(y,{label:s(r)("task.file.detail.label.trace_id"),span:2},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Na,[k(i(n.value.trace_id)+" ",1),e($,{class:"copy-btn",onClick:g[0]||(g[0]=I=>w(n.value.trace_id))})]))]),_:1},8,["label"]),n.value.batch_trace_id?(t(),d(y,{key:0,label:s(r)("task.file.detail.label.batch_trace_id"),span:2},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ba,[k(i(n.value.batch_trace_id)+" ",1),e($,{class:"copy-btn",onClick:g[1]||(g[1]=I=>w(n.value.batch_trace_id))})]))]),_:1},8,["label"])):K("",!0),e(y,{label:s(r)("task.file.detail.label.creator"),span:2},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",La,[k(i(n.value.creator)+" ",1),e($,{class:"copy-btn",onClick:g[2]||(g[2]=I=>z(n.value.id,"creator"))})]))]),_:1},8,["label"]),e(y,{label:s(r)("common.app_id")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ua,i(n.value.app_id),1))]),_:1},8,["label"]),e(y,{label:s(r)("common.user_id")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Aa,i(n.value.user_id),1))]),_:1},8,["label"]),e(y,{label:s(r)("task.file.detail.label.model")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ea,i(n.value.model),1))]),_:1},8,["label"]),e(y,{label:s(r)("task.file.detail.label.purpose")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Pa,i(n.value.purpose||"-"),1))]),_:1},8,["label"]),e(y,{label:s(r)("task.file.detail.label.file_id"),span:2},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ta,[k(i(n.value.file_id)+" ",1),e($,{class:"copy-btn",onClick:g[3]||(g[3]=I=>w(n.value.file_id))})]))]),_:1},8,["label"]),e(y,{label:s(r)("task.file.detail.label.file_name")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ra,i(n.value.file_name||"-"),1))]),_:1},8,["label"]),e(y,{label:s(r)("task.file.detail.label.bytes")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ha,i(s(ke)(n.value.bytes)||"-"),1))]),_:1},8,["label"]),n.value.file_url?(t(),d(y,{key:1,label:s(r)("task.file.detail.label.file_url"),span:2},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ma,[k(i(N(n.value.file_url)||"-")+" ",1),e($,{class:"copy-btn",onClick:g[4]||(g[4]=I=>w(N(n.value.file_url)))})]))]),_:1},8,["label"])):K("",!0),e(y,{label:s(r)("task.file.detail.label.error"),span:2},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Oa,i(n.value.error||"-"),1))]),_:1},8,["label"]),n.value.file_path?(t(),d(y,{key:2,label:s(r)("task.file.detail.label.file_path"),span:2},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",qa,i(n.value.file_path),1))]),_:1},8,["label"])):K("",!0),e(y,{label:s(r)("common.status")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Wa,[n.value.status==="processed"?(t(),d(B,{key:0,color:"green"},{default:a(()=>[k(i(f.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="uploaded"?(t(),d(B,{key:1,color:"uploaded"},{default:a(()=>[k(i(f.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):n.value.status==="error"?(t(),d(B,{key:2,color:"red"},{default:a(()=>[k(i(f.$t(`task.dict.status.${n.value.status}`)),1)]),_:1})):(t(),d(B,{key:3,color:"gray"},{default:a(()=>[k(i(f.$t(`task.dict.status.${n.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),e(y,{label:s(r)("task.file.detail.label.expires_at")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",ja,i(n.value.expires_at||"-"),1))]),_:1},8,["label"]),e(y,{label:s(r)("common.created_at")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ga,i(n.value.created_at),1))]),_:1},8,["label"]),e(y,{label:s(r)("common.updated_at")},{default:a(()=>[s(v)?(t(),d(c,{key:0,animation:!0},{default:a(()=>[e(b,{rows:1})]),_:1})):(t(),_("span",Ja,i(n.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const Xa=ce(Qa,[["__scopeId","data-v-015753c2"]]),Ya={class:"container"},Za={class:"action-icon"},et={class:"action-icon"},at={id:"tableSetting"},tt={style:{"margin-right":"4px",cursor:"move"}},lt={class:"title"},ot=["onClick"],st={name:"TaskFileList"},nt=_e({...st,setup(te){const{proxy:T}=pe(),r=localStorage.getItem("userRole"),v=ue({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),L=()=>({user_id:h(),app_id:h(),trace_id:"",file_id:"",file_name:"",status:h(),created_at:[]}),{loading:n,setLoading:U}=fe(!0),{t:p}=re(),A=h([]),m=h(L()),w=h([]),z=h([]),N=h("medium"),f=h(),g=h([]);r==="user"&&(async()=>{try{const{data:l}=await Ia();g.value=l.items}catch{}})();const c={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},$=ue({...c}),y=Q(()=>[{name:p("size.mini"),value:"mini"},{name:p("size.small"),value:"small"},{name:p("size.medium"),value:"medium"},{name:p("size.large"),value:"large"}]),B=Q(()=>[{title:p(r==="reseller"||r==="admin"?"task.columns.user_id":"task.columns.app_id"),dataIndex:r==="reseller"||r==="admin"?"user_id":"app_id",slotName:r==="reseller"||r==="admin"?"user_id":"app_id",align:"center",width:75},{title:p("task.columns.model"),dataIndex:"model",slotName:"model",align:"center"},{title:p("task.columns.purpose"),dataIndex:"purpose",slotName:"purpose",align:"center"},{title:p("task.columns.file_id"),dataIndex:"file_id",slotName:"file_id",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.columns.file_name"),dataIndex:"file_name",slotName:"file_name",align:"center",ellipsis:!0,tooltip:!0},{title:p("task.columns.bytes"),dataIndex:"bytes",slotName:"bytes",align:"center"},{title:p("task.columns.status"),dataIndex:"status",slotName:"status",align:"center"},{title:p("task.columns.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:p("task.columns.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),E=Q(()=>[{label:p("task.dict.status.uploaded"),value:"uploaded"},{label:p("task.dict.status.processed"),value:"processed"},{label:p("task.dict.status.error"),value:"error"},{label:p("task.dict.status.expired"),value:"expired"}]);r==="admin"&&E.value.push({label:p("task.dict.status.deleted"),value:"deleted"});const I=async(l={...c})=>{U(!0);try{const{data:u}=await Fa(l);A.value=u.items,$.current=l.current,$.pageSize=l.pageSize,$.total=u.paging.total}catch{}finally{U(!1)}},R=()=>{I({...c,...m.value})},ve=l=>{I({...c,...m.value,current:l})},ye=l=>{c.pageSize=l,I({...c,...m.value})};I();const ge=()=>{m.value=L(),R()},he=(l,u)=>{N.value=l},we=(l,u,D)=>{l?w.value.splice(D,0,u):w.value=z.value.filter(C=>C.dataIndex!==u.dataIndex)},le=(l,u,D,C=!1)=>{const x=C?ee(l):l;return u>-1&&D>-1&&x.splice(u,1,x.splice(D,1,x[u]).pop()),x},$e=l=>{l&&aa(()=>{const u=document.getElementById("tableSetting");new Sa(u,{onEnd(D){const{oldIndex:C,newIndex:x}=D;le(w.value,C,x),le(z.value,C,x)}})})};ae(()=>B.value,l=>{w.value=ee(l),w.value.forEach((u,D)=>{u.checked=!0}),z.value=ee(w.value)},{deep:!0,immediate:!0});const H=h(!1),oe=h(),Ce=l=>{H.value=!0,oe.value=l},Ve=()=>{H.value=!1},{copy:Ie,copied:se}=be(),De=async l=>{Ie(l)};return ae(se,()=>{se.value&&T.$message.success("\u590D\u5236\u6210\u529F")}),(l,u)=>{const D=ta,C=la,x=oa,xe=sa,ne=na,S=ia,V=da,Fe=ua,M=ra,Se=ca,O=_a,ze=pa,ie=ma,Ne=fa,q=ba,de=qe,Be=ka,W=va,Le=We,Ue=ya,Ae=ga,Ee=je,Pe=Ge,Te=ha,Re=wa,P=me,He=$a,Me=Ca,Oe=Va,j=Ze("permission");return t(),_("div",Ya,[e(x,{class:"container-breadcrumb"},{default:a(()=>[e(C,null,{default:a(()=>[e(D)]),_:1}),e(C,null,{default:a(()=>[k(i(l.$t("menu.task")),1)]),_:1}),e(C,null,{default:a(()=>[k(i(l.$t("menu.task.file.list")),1)]),_:1})]),_:1}),e(Oe,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:a(()=>[e(O,null,{default:a(()=>[e(V,{flex:1},{default:a(()=>[e(ze,{model:m.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(O,{gutter:16},{default:a(()=>[X((t(),d(V,{span:8},{default:a(()=>[e(S,{field:"app_id",label:l.$t("task.form.app_id")},{default:a(()=>[e(ne,{modelValue:m.value.app_id,"onUpdate:modelValue":u[0]||(u[0]=o=>m.value.app_id=o),placeholder:l.$t("task.form.selectDefault"),"allow-search":"","allow-clear":""},{default:a(()=>[(t(!0),_(Y,null,Z(g.value,o=>(t(),d(xe,{key:o.app_id,value:o.app_id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[j,["user"]]]),X((t(),d(V,{span:8},{default:a(()=>[e(S,{field:"user_id",label:l.$t("task.form.user_id")},{default:a(()=>[e(Fe,{modelValue:m.value.user_id,"onUpdate:modelValue":u[1]||(u[1]=o=>m.value.user_id=o),placeholder:l.$t("task.form.user_id.placeholder"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[j,["reseller","admin"]]]),e(V,{span:8},{default:a(()=>[e(S,{field:"trace_id",label:l.$t("task.form.trace_id")},{default:a(()=>[e(M,{modelValue:m.value.trace_id,"onUpdate:modelValue":u[2]||(u[2]=o=>m.value.trace_id=o),placeholder:l.$t("task.form.trace_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(V,{span:8},{default:a(()=>[e(S,{field:"file_id",label:l.$t("task.form.file_id")},{default:a(()=>[e(M,{modelValue:m.value.file_id,"onUpdate:modelValue":u[3]||(u[3]=o=>m.value.file_id=o),placeholder:l.$t("task.form.file_id.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(V,{span:8},{default:a(()=>[e(S,{field:"file_name",label:l.$t("task.form.file_name")},{default:a(()=>[e(M,{modelValue:m.value.file_name,"onUpdate:modelValue":u[4]||(u[4]=o=>m.value.file_name=o),placeholder:l.$t("task.form.file_name.placeholder"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(V,{span:8},{default:a(()=>[e(S,{field:"status",label:l.$t("task.form.status")},{default:a(()=>[e(ne,{modelValue:m.value.status,"onUpdate:modelValue":u[5]||(u[5]=o=>m.value.status=o),options:s(E),placeholder:l.$t("task.form.selectDefault"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),e(V,{span:8},{default:a(()=>[e(S,{field:"created_at",label:l.$t("task.form.created_at")},{default:a(()=>[e(Se,{modelValue:m.value.created_at,"onUpdate:modelValue":u[6]||(u[6]=o=>m.value.created_at=o),placeholder:["\u5F00\u59CB\u65F6\u95F4","\u7ED3\u675F\u65F6\u95F4"],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(ie,{style:{height:"84px"},direction:"vertical"}),e(V,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(Be,{direction:"vertical",size:18},{default:a(()=>[e(q,{type:"primary",onClick:R},{icon:a(()=>[e(Ne)]),default:a(()=>[k(" "+i(l.$t("task.form.search")),1)]),_:1}),e(q,{onClick:ge},{icon:a(()=>[e(de)]),default:a(()=>[k(" "+i(l.$t("task.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),X(e(ie,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[j,["reseller","admin"]]]),e(O,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(V,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:a(()=>[e(W,{content:l.$t("actions.refresh")},{default:a(()=>[F("div",{class:"action-icon",onClick:R},[e(de,{size:"18"})])]),_:1},8,["content"]),e(Ae,{onSelect:he},{content:a(()=>[(t(!0),_(Y,null,Z(s(y),o=>(t(),d(Ue,{key:o.value,value:o.value,class:ea({active:o.value===N.value})},{default:a(()=>[F("span",null,i(o.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(W,{content:l.$t("actions.density")},{default:a(()=>[F("div",Za,[e(Le,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(W,{content:l.$t("actions.column_setting")},{default:a(()=>[e(Re,{trigger:"click",position:"bl",onPopupVisibleChange:$e},{content:a(()=>[F("div",at,[(t(!0),_(Y,null,Z(z.value,(o,G)=>(t(),_("div",{key:o.dataIndex,class:"setting"},[F("div",tt,[e(Pe)]),F("div",null,[e(Te,{modelValue:o.checked,"onUpdate:modelValue":J=>o.checked=J,onChange:J=>we(J,o,G)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),F("div",lt,i(o.title==="#"?"\u5E8F\u5217\u53F7":o.title),1)]))),128))])]),default:a(()=>[F("div",et,[e(Ee,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(He,{ref_key:"tableRef",ref:f,"row-key":"id",loading:s(n),pagination:$,columns:w.value,data:A.value,bordered:!1,size:N.value,"row-selection":v,onPageChange:ve,onPageSizeChange:ye},{file_id:a(({record:o})=>[F("span",{class:"copy-btn",onClick:G=>De(o.file_id)},i(o.file_id||"-"),9,ot)]),file_name:a(({record:o})=>[k(i(o.file_name||"-"),1)]),bytes:a(({record:o})=>[k(i(s(ke)(o.bytes)||"-"),1)]),status:a(({record:o})=>[o.status==="processed"?(t(),d(P,{key:0,color:"green"},{default:a(()=>[k(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="uploaded"?(t(),d(P,{key:1,color:"uploaded"},{default:a(()=>[k(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="error"?(t(),d(P,{key:2,color:"red"},{default:a(()=>[k(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):(t(),d(P,{key:3,color:"gray"},{default:a(()=>[k(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024))]),operations:a(({record:o})=>[e(q,{type:"text",size:"small",onClick:G=>Ce(o.id)},{default:a(()=>[k(i(l.$t("task.columns.operations.view")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),e(Me,{title:l.$t("menu.task.file.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:H.value,onCancel:Ve},{default:a(()=>[e(Xa,{id:oe.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const Bt=ce(nt,[["__scopeId","data-v-4c513d33"]]);export{Bt as default};
