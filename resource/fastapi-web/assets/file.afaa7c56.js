import{u as ue,_ as re,s as qe,A as Oe,k as We,B as je}from"./index.d4c38361.js";/* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css              */import{d as ce,e as g,w as ee,aZ as pe,B as t,C as p,aH as a,aG as e,u as _,aD as d,aL as m,aM as i,aE as J,bA as Ge,bB as Je,ad as Ke,bC as Ze,bD as _e,bE as Qe,r as de,c as K,bF as Xe,bu as Z,aJ as Q,aI as X,D as z,E as Ye,n as ea,as as aa,aK as ta,aF as la,bH as oa,bI as sa,b2 as na,bG as ia,aS as da,b1 as ua,bJ as ra,bK as ca,b5 as pa,bL as _a,ab as ma,aU as fa,bi as ba,bj as va,bk as ka,bl as ya,b4 as ga,bM as ha,bN as $a,aV as wa,bT as Ca}from"./arco.3f46b4ae.js";import{u as me}from"./loading.37fd256d.js";import{e as Va}from"./app.c1bdfe00.js";import{b as Ia,f as Sa,c as Da}from"./task.1f5dde44.js";import{c as Y,S as za}from"./sortable.esm.078712c4.js";import{u as fe}from"./vue.dbcf9bc3.js";import{f as be}from"./common.cfd92899.js";/* empty css                *//* empty css                */import"./chart.2cea905d.js";const Fa={style:{margin:"10px 0 30px 10px"}},Na={key:1},La={key:1},Ba={key:1},Ua={key:1},Aa={key:1},Ta={key:1},Pa={key:1},Ea={key:1},Ra={key:1},xa={key:1},Ha={key:1},Ma={key:1,style:{"max-height":"220px",display:"block",overflow:"auto"}},qa={key:1,style:{"max-height":"110px",display:"block",overflow:"auto"}},Oa={key:1},Wa={key:1},ja={key:1},Ga={key:1},Ja={key:1},Ka={name:"TaskFileDetail"},Za=ce({...Ka,props:{id:{type:String,default:""}},setup(ae){const $=ae,{t:E}=ue(),{loading:f,setLoading:T}=me(!0),s=g({}),{copy:c,copied:U}=fe();(async(n={id:$.id})=>{T(!0);try{const{data:y}=await Ia(n);s.value=y}catch{}finally{T(!1)}})();const h=n=>{c(n)};ee(U,()=>{U.value&&pe.success(E("success.copy"))});const L=async(n,y)=>{const{data:b}=await Sa({id:n,field:y});c(b.value)},B=n=>n?n.startsWith("http://")||n.startsWith("https://")?n:window.location.origin+(n.startsWith("/")?n:`/${n}`):"";return(n,y)=>{const b=Ge,r=Je,w=Ke,k=Ze,F=_e,P=Qe;return t(),p("div",Fa,[a(P,{column:2,bordered:"","value-style":{width:"350px",padding:"5px 8px 5px 20px"}},{default:e(()=>[a(k,{label:n.$t("common.trace_id"),span:2},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Na,[m(i(s.value.trace_id)+" ",1),a(w,{class:"copy-btn",onClick:y[0]||(y[0]=I=>h(s.value.trace_id))})]))]),_:1},8,["label"]),s.value.batch_trace_id?(t(),d(k,{key:0,label:n.$t("task.detail.batch_trace_id"),span:2},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",La,[m(i(s.value.batch_trace_id)+" ",1),a(w,{class:"copy-btn",onClick:y[1]||(y[1]=I=>h(s.value.batch_trace_id))})]))]),_:1},8,["label"])):J("",!0),a(k,{label:n.$t("task.detail.creator"),span:2},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ba,[m(i(s.value.creator)+" ",1),a(w,{class:"copy-btn",onClick:y[2]||(y[2]=I=>L(s.value.id,"creator"))})]))]),_:1},8,["label"]),a(k,{label:n.$t("common.app_id")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ua,i(s.value.app_id),1))]),_:1},8,["label"]),a(k,{label:n.$t("common.user_id")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Aa,i(s.value.user_id),1))]),_:1},8,["label"]),a(k,{label:n.$t("common.model")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ta,i(s.value.model),1))]),_:1},8,["label"]),a(k,{label:n.$t("task.detail.purpose")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Pa,i(s.value.purpose||"-"),1))]),_:1},8,["label"]),a(k,{label:n.$t("task.detail.file_id"),span:2},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ea,[m(i(s.value.file_id)+" ",1),a(w,{class:"copy-btn",onClick:y[3]||(y[3]=I=>h(s.value.file_id))})]))]),_:1},8,["label"]),a(k,{label:n.$t("task.detail.file_name")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ra,i(s.value.file_name||"-"),1))]),_:1},8,["label"]),a(k,{label:n.$t("task.detail.bytes")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",xa,i(_(be)(s.value.bytes)||"-"),1))]),_:1},8,["label"]),s.value.file_url?(t(),d(k,{key:1,label:n.$t("task.detail.file_url"),span:2},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ha,[m(i(B(s.value.file_url)||"-")+" ",1),a(w,{class:"copy-btn",onClick:y[4]||(y[4]=I=>h(B(s.value.file_url)))})]))]),_:1},8,["label"])):J("",!0),a(k,{label:n.$t("task.detail.response_data"),span:2},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ma,i(s.value.response_data||"-"),1))]),_:1},8,["label"]),a(k,{label:n.$t("task.detail.error"),span:2},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",qa,i(s.value.error||"-"),1))]),_:1},8,["label"]),s.value.file_path?(t(),d(k,{key:2,label:n.$t("task.detail.file_path"),span:2},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Oa,i(s.value.file_path),1))]),_:1},8,["label"])):J("",!0),a(k,{label:n.$t("common.status")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Wa,[s.value.status==="processed"?(t(),d(F,{key:0,color:"green"},{default:e(()=>[m(i(n.$t(`task.dict.status.${s.value.status}`)),1)]),_:1})):s.value.status==="processing"?(t(),d(F,{key:1,color:"arcoblue"},{default:e(()=>[m(i(n.$t(`task.dict.status.${s.value.status}`)),1)]),_:1})):s.value.status==="uploaded"?(t(),d(F,{key:2,color:"uploaded"},{default:e(()=>[m(i(n.$t(`task.dict.status.${s.value.status}`)),1)]),_:1})):s.value.status==="error"||!s.value.status?(t(),d(F,{key:3,color:"red"},{default:e(()=>[m(i(n.$t(`task.dict.status.${s.value.status||"failed"}`)),1)]),_:1})):(t(),d(F,{key:4,color:"gray"},{default:e(()=>[m(i(n.$t(`task.dict.status.${s.value.status}`)),1)]),_:1}))]))]),_:1},8,["label"]),a(k,{label:n.$t("task.detail.expires_at")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",ja,i(s.value.expires_at||"-"),1))]),_:1},8,["label"]),a(k,{label:n.$t("common.created_at")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ga,i(s.value.created_at),1))]),_:1},8,["label"]),a(k,{label:n.$t("common.updated_at")},{default:e(()=>[_(f)?(t(),d(r,{key:0,animation:!0},{default:e(()=>[a(b,{rows:1})]),_:1})):(t(),p("span",Ja,i(s.value.updated_at),1))]),_:1},8,["label"])]),_:1})])}}});const Qa=re(Za,[["__scopeId","data-v-1781ad26"]]),Xa={class:"container"},Ya={class:"action-icon"},et={class:"action-icon"},at={id:"tableSetting"},tt={style:{"margin-right":"4px",cursor:"move"}},lt={class:"title"},ot=["onClick"],st={name:"TaskFileList"},nt=ce({...st,setup(ae){const $=localStorage.getItem("userRole"),E=de({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),f=()=>({user_id:g(),app_id:g(),trace_id:"",file_id:"",file_name:"",status:g(),created_at:[]}),{loading:T,setLoading:s}=me(!0),{t:c}=ue(),U=g([]),v=g(f()),h=g([]),L=g([]),B=g("medium"),n=g(),y=g([]);$==="user"&&(async()=>{try{const{data:l}=await Va();y.value=l.items}catch{}})();const r={current:1,pageSize:20,showTotal:!0,showPageSize:!0,pageSizeOptions:[20,50,100,500,1e3]},w=de({...r}),k=K(()=>[{name:c("size.mini"),value:"mini"},{name:c("size.small"),value:"small"},{name:c("size.medium"),value:"medium"},{name:c("size.large"),value:"large"}]),F=K(()=>[{title:c($==="reseller"||$==="admin"?"common.user_id":"common.app_id"),dataIndex:$==="reseller"||$==="admin"?"user_id":"app_id",slotName:$==="reseller"||$==="admin"?"user_id":"app_id",align:"center",width:75},{title:c("common.model"),dataIndex:"model",slotName:"model",align:"center",ellipsis:!0,tooltip:!0},{title:c("task.detail.purpose"),dataIndex:"purpose",slotName:"purpose",align:"center"},{title:c("task.detail.file_id"),dataIndex:"file_id",slotName:"file_id",align:"center",ellipsis:!0,tooltip:!0},{title:c("task.detail.file_name"),dataIndex:"file_name",slotName:"file_name",align:"center",ellipsis:!0,tooltip:!0},{title:c("task.detail.bytes"),dataIndex:"bytes",slotName:"bytes",align:"center"},{title:c("common.status"),dataIndex:"status",slotName:"status",align:"center"},{title:c("common.created_at"),dataIndex:"created_at",slotName:"created_at",align:"center",width:132},{title:c("common.operations"),dataIndex:"operations",slotName:"operations",align:"center",width:75}]),P=K(()=>[{label:c("task.dict.status.uploaded"),value:"uploaded"},{label:c("task.dict.status.processing"),value:"processing"},{label:c("task.dict.status.processed"),value:"processed"},{label:c("task.dict.status.error"),value:"error"},{label:c("task.dict.status.expired"),value:"expired"}]);$==="admin"&&P.value.push({label:c("task.dict.status.deleted"),value:"deleted"});const I=async(l={...r})=>{s(!0);try{const{data:u}=await Da(l);U.value=u.items,w.current=l.current,w.pageSize=l.pageSize,w.total=u.paging.total}catch{}finally{s(!1)}},R=()=>{I({...r,...v.value})},ve=l=>{I({...r,...v.value,current:l})},ke=l=>{r.pageSize=l,I({...r,...v.value})};I();const ye=()=>{v.value=f(),R()},ge=(l,u)=>{B.value=l},he=(l,u,S)=>{l?h.value.splice(S,0,u):h.value=L.value.filter(C=>C.dataIndex!==u.dataIndex)},te=(l,u,S,C=!1)=>{const D=C?Y(l):l;return u>-1&&S>-1&&D.splice(u,1,D.splice(S,1,D[u]).pop()),D},$e=l=>{l&&ea(()=>{const u=document.getElementById("tableSetting");new za(u,{onEnd(S){const{oldIndex:C,newIndex:D}=S;te(h.value,C,D),te(L.value,C,D)}})})};ee(()=>F.value,l=>{h.value=Y(l),h.value.forEach((u,S)=>{u.checked=!0}),L.value=Y(h.value)},{deep:!0,immediate:!0});const x=g(!1),le=g(),we=l=>{x.value=!0,le.value=l},Ce=()=>{x.value=!1},{copy:Ve,copied:oe}=fe(),Ie=async l=>{Ve(l)};return ee(oe,()=>{oe.value&&pe.success(c("success.copy"))}),(l,u)=>{const S=aa,C=ta,D=la,Se=oa,se=sa,N=na,V=ia,De=da,H=ua,ze=ra,M=ca,Fe=pa,ne=_a,Ne=ma,q=fa,ie=qe,Le=ba,O=va,Be=Oe,Ue=ka,Ae=ya,Te=We,Pe=je,Ee=ga,Re=ha,A=_e,xe=$a,He=wa,Me=Ca,W=Xe("permission");return t(),p("div",Xa,[a(D,{class:"container-breadcrumb"},{default:e(()=>[a(C,null,{default:e(()=>[a(S)]),_:1}),a(C,null,{default:e(()=>[m(i(l.$t("task.menu")),1)]),_:1}),a(C,null,{default:e(()=>[m(i(l.$t("task.menu.file")),1)]),_:1})]),_:1}),a(Me,{class:"general-card",bordered:!1,"header-style":{padding:"20px"},"body-style":{padding:"25px 20px 20px 20px"}},{default:e(()=>[a(M,null,{default:e(()=>[a(V,{flex:1},{default:e(()=>[a(Fe,{model:v.value,"label-col-props":{span:5},"wrapper-col-props":{span:18},"label-align":"left"},{default:e(()=>[a(M,{gutter:16},{default:e(()=>[Z((t(),d(V,{span:8},{default:e(()=>[a(N,{field:"app_id",label:l.$t("common.app")},{default:e(()=>[a(se,{modelValue:v.value.app_id,"onUpdate:modelValue":u[0]||(u[0]=o=>v.value.app_id=o),placeholder:l.$t("common.all"),"allow-search":"","allow-clear":""},{default:e(()=>[(t(!0),p(Q,null,X(y.value,o=>(t(),d(Se,{key:o.app_id,value:o.app_id,label:o.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[W,["user"]]]),Z((t(),d(V,{span:8},{default:e(()=>[a(N,{field:"user_id",label:l.$t("task.form.user_id")},{default:e(()=>[a(De,{modelValue:v.value.user_id,"onUpdate:modelValue":u[1]||(u[1]=o=>v.value.user_id=o),placeholder:l.$t("placeholder.user_id"),min:1,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})),[[W,["reseller","admin"]]]),a(V,{span:8},{default:e(()=>[a(N,{field:"trace_id",label:l.$t("task.form.trace_id")},{default:e(()=>[a(H,{modelValue:v.value.trace_id,"onUpdate:modelValue":u[2]||(u[2]=o=>v.value.trace_id=o),placeholder:l.$t("placeholder.trace_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(V,{span:8},{default:e(()=>[a(N,{field:"file_id",label:l.$t("task.detail.file_id")},{default:e(()=>[a(H,{modelValue:v.value.file_id,"onUpdate:modelValue":u[3]||(u[3]=o=>v.value.file_id=o),placeholder:l.$t("task.form.placeholder.file_id"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(V,{span:8},{default:e(()=>[a(N,{field:"file_name",label:l.$t("task.detail.file_name")},{default:e(()=>[a(H,{modelValue:v.value.file_name,"onUpdate:modelValue":u[4]||(u[4]=o=>v.value.file_name=o),placeholder:l.$t("task.form.placeholder.file_name"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(V,{span:8},{default:e(()=>[a(N,{field:"status",label:l.$t("common.status")},{default:e(()=>[a(se,{modelValue:v.value.status,"onUpdate:modelValue":u[5]||(u[5]=o=>v.value.status=o),options:_(P),placeholder:l.$t("common.all"),scrollbar:!1,"allow-clear":""},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1}),a(V,{span:8},{default:e(()=>[a(N,{field:"created_at",label:l.$t("common.created_at")},{default:e(()=>[a(ze,{modelValue:v.value.created_at,"onUpdate:modelValue":u[6]||(u[6]=o=>v.value.created_at=o),placeholder:[l.$t("common.start_time"),l.$t("common.end_time")],"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},"show-time":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(ne,{style:{height:"84px"},direction:"vertical"}),a(V,{flex:"86px",style:{"text-align":"right"}},{default:e(()=>[a(Le,{direction:"vertical",size:18},{default:e(()=>[a(q,{type:"primary",onClick:R},{icon:e(()=>[a(Ne)]),default:e(()=>[m(" "+i(l.$t("button.search")),1)]),_:1}),a(q,{onClick:ye},{icon:e(()=>[a(ie)]),default:e(()=>[m(" "+i(l.$t("button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),Z(a(ne,{style:{"margin-top":"0","margin-bottom":"16px"}},null,512),[[W,["reseller","admin"]]]),a(M,{style:{"margin-bottom":"16px"}},{default:e(()=>[a(V,{span:24,style:{display:"flex",height:"32px","align-items":"center","justify-content":"end"}},{default:e(()=>[a(O,{content:l.$t("action.refresh")},{default:e(()=>[z("div",{class:"action-icon",onClick:R},[a(ie,{size:"18"})])]),_:1},8,["content"]),a(Ae,{onSelect:ge},{content:e(()=>[(t(!0),p(Q,null,X(_(k),o=>(t(),d(Ue,{key:o.value,value:o.value,class:Ye({active:o.value===B.value})},{default:e(()=>[z("span",null,i(o.name),1)]),_:2},1032,["value","class"]))),128))]),default:e(()=>[a(O,{content:l.$t("action.density")},{default:e(()=>[z("div",Ya,[a(Be,{size:"18"})])]),_:1},8,["content"])]),_:1}),a(O,{content:l.$t("action.column_setting")},{default:e(()=>[a(Re,{trigger:"click",position:"bl",onPopupVisibleChange:$e},{content:e(()=>[z("div",at,[(t(!0),p(Q,null,X(L.value,(o,j)=>(t(),p("div",{key:o.dataIndex,class:"setting"},[z("div",tt,[a(Pe)]),z("div",null,[a(Ee,{modelValue:o.checked,"onUpdate:modelValue":G=>o.checked=G,onChange:G=>he(G,o,j)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),z("div",lt,i(o.title),1)]))),128))])]),default:e(()=>[z("div",et,[a(Te,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),a(xe,{ref_key:"tableRef",ref:n,"row-key":"id",loading:_(T),pagination:w,columns:h.value,data:U.value,bordered:!1,size:B.value,"row-selection":E,onPageChange:ve,onPageSizeChange:ke},{file_id:e(({record:o})=>[z("span",{class:"copy-btn",onClick:j=>Ie(o.file_id)},i(o.file_id||"-"),9,ot)]),file_name:e(({record:o})=>[m(i(o.file_name||"-"),1)]),bytes:e(({record:o})=>[m(i(_(be)(o.bytes)||"-"),1)]),status:e(({record:o})=>[o.status==="processed"?(t(),d(A,{key:0,color:"green"},{default:e(()=>[m(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="processing"?(t(),d(A,{key:1,color:"arcoblue"},{default:e(()=>[m(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="uploaded"?(t(),d(A,{key:2,color:"uploaded"},{default:e(()=>[m(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024)):o.status==="error"||!o.status?(t(),d(A,{key:3,color:"red"},{default:e(()=>[m(i(l.$t(`task.dict.status.${o.status||"failed"}`)),1)]),_:2},1024)):(t(),d(A,{key:4,color:"gray"},{default:e(()=>[m(i(l.$t(`task.dict.status.${o.status}`)),1)]),_:2},1024))]),operations:e(({record:o})=>[a(q,{type:"text",size:"small",onClick:j=>we(o.id)},{default:e(()=>[m(i(l.$t("button.detail")),1)]),_:2},1032,["onClick"])]),_:1},8,["loading","pagination","columns","data","size","row-selection"]),a(He,{title:l.$t("task.menu.file.detail"),"unmount-on-close":"","render-to-body":"",width:700,footer:!1,visible:x.value,onCancel:Ce},{default:e(()=>[a(Qa,{id:le.value},null,8,["id"])]),_:1},8,["title","visible"])]),_:1})])}}});const Lt=re(nt,[["__scopeId","data-v-3e03c95d"]]);export{Lt as default};
